///<jscompress sourcefile="layaUI.max.all.js" />
///<jscompress sourcefile="EventDispatcher.js" />
/***********************************************************************
** Author:	jaron.ho
** Date:	2015-08-06
** Brief:	event dispathcer system
***********************************************************************////<jscompress sourcefile="EventDispatcherHang.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-011
 ** Brief:	event dispathcer hang
 ***********************************************************************////<jscompress sourcefile="Class.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	define type of class
 ***********************************************************************////<jscompress sourcefile="Page.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-11
 ** Brief:	page
 ***********************************************************************////<jscompress sourcefile="Probability.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-12
 ** Brief:	calculate probability by weight list
 ***********************************************************************/
// create probability object,weightList:[[1,20],[2,60]],contains two random value: 1.value,20.weight;2.value,60.weight
///<jscompress sourcefile="Action.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-12
 ** Brief:	动作集
 ***********************************************************************////<jscompress sourcefile="LayaEx.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-12
 ** Brief:	laya扩展函数
 ***********************************************************************////<jscompress sourcefile="UI.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-11
 ** Brief:	ui manager
 ***********************************************************************////<jscompress sourcefile="UIDEFINE.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-11
 ** Brief:	ui define
 ***********************************************************************/
//----------------------------------------------------------------------
// 定义界面
///<jscompress sourcefile="AudioModel.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-11
 ** Brief:	audio Model
 ***********************************************************************////<jscompress sourcefile="DataModel.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-13
 ** Brief:	数据模型
 ***********************************************************************////<jscompress sourcefile="DataTB.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-13
 ** Brief:	数据表
 ***********************************************************************////<jscompress sourcefile="EnumDef.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-12
 ** Brief:	枚举定义
 ***********************************************************************/
// 语言类型
///<jscompress sourcefile="EventDef.js" />
/***********************************************************************
** Author:	jaron.ho
** Date:	2015-08-06
** Brief:	event define
***********************************************************************////<jscompress sourcefile="Board.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	隔板
 ***********************************************************************////<jscompress sourcefile="Component.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	组件
 ***********************************************************************////<jscompress sourcefile="ComponentMap.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	地图控制器
 ***********************************************************************////<jscompress sourcefile="ComponentView.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	视图组件
 ***********************************************************************////<jscompress sourcefile="Controller.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	控制器
 ***********************************************************************////<jscompress sourcefile="ControllerClear.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	消除控制器
 ***********************************************************************////<jscompress sourcefile="ControllerDrop.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	掉落控制器
 ***********************************************************************////<jscompress sourcefile="ControllerGain.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	目标控制器
 ***********************************************************************////<jscompress sourcefile="ControllerMinimap.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	b小地图控制器
 ***********************************************************************////<jscompress sourcefile="CoreAlgorithm.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	核心算法
 ***********************************************************************////<jscompress sourcefile="CoreDef.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	核心定义
 ***********************************************************************////<jscompress sourcefile="Element.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	元素
 ***********************************************************************////<jscompress sourcefile="Grid.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	格子
 ***********************************************************************////<jscompress sourcefile="ItemClear.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	消除选项
 ***********************************************************************////<jscompress sourcefile="UIAuto.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	自动界面
 ***********************************************************************////<jscompress sourcefile="UIGame.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	游戏界面
 ***********************************************************************////<jscompress sourcefile="UIGM.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	GM界面
 ***********************************************************************////<jscompress sourcefile="UIPrompt.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-17
 ** Brief:	提示
 ***********************************************************************////<jscompress sourcefile="UIResLoading.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	资源加载界面
 ***********************************************************************////<jscompress sourcefile="UISetUp.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-14
 ** Brief:	设置界面
 ***********************************************************************////<jscompress sourcefile="ResourceConfig.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-10
 ** Brief:	resource config
 ***********************************************************************////<jscompress sourcefile="ResourceLoader.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-27
 ** Brief:	resource loader
 ***********************************************************************////<jscompress sourcefile="Global.js" />
/***********************************************************************
 ** Author: jaron.ho
 ** Date: 2014-12-04
 ** Brief: 全局变量
 ***********************************************************************////<jscompress sourcefile="Game.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-11
 ** Brief:	游戏逻辑
 ***********************************************************************////<jscompress sourcefile="UIGameDes.js" />
/***********************************************************************
 ** Author:	lihq
 ** Date:	2016-09-27
 ** Brief:	游戏玩法说明界面
 ***********************************************************************////<jscompress sourcefile="UILevelDes.js" />
/***********************************************************************
 ** Author:	Lihq
 ** Date:	2016-09-28
 ** Brief:	关卡过关界面说明
 ***********************************************************************////<jscompress sourcefile="UIOriTip.js" />
/***********************************************************************
 ** Author:	jaron.ho
 ** Date:	2015-08-17
 ** Brief:	提示
 ***********************************************************************////<jscompress sourcefile="UILevelUp.js" />
/***********************************************************************
 ** Author:	Lihq
 ** Date:	2016-10-11
 ** Brief:	关卡升星界面
 ***********************************************************************////<jscompress sourcefile="UINewGuide.js" />
/***********************************************************************
 ** Author:	Lihq
 ** Date:	2016-10-12
 ** Brief:	新手引导界面
 ***********************************************************************////<jscompress sourcefile="UIGamePlayDes.js" />
/***********************************************************************
 ** Author:	Lihq
 ** Date:	2016-10-12
 ** Brief:	游戏玩法界面说明
 ***********************************************************************/var CLASS$=Laya["class"],STATICATTR$=Laya["static"],View=laya.ui.View,Dialog=laya.ui.Dialog,AutoUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.AutoUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"View",child:[{props:{x:480,y:270,skin:"ui/image_auto.png",anchorX:.5,anchorY:.5},type:"Image"},{props:{x:245,y:179,skin:"ui/button_arrow.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_stake_left"},type:"Button"},{props:{x:706,y:179,skin:"ui/button_arrow.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_stake_right",rotation:180},type:"Button"},{props:{x:338,y:179,skin:"ui/button_bet_02.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_stake1",label:"88",labelBold:!0,labelSize:28,labelColors:"#F0B137"},type:"Button"},{props:{x:477,y:179,skin:"ui/button_bet_02.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_stake2",label:"7253",labelBold:!0,labelSize:28,labelColors:"#F0B137"},type:"Button"},{props:{x:617,y:179,skin:"ui/button_bet_02.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_stake3",label:"1000",labelBold:!0,labelSize:28,labelColors:"#F0B137"},type:"Button"},{props:{x:245,y:309,skin:"ui/button_arrow.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_times_left"},type:"Button"},{props:{x:706,y:309,skin:"ui/button_arrow.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_times_right",rotation:180},type:"Button"},{props:{x:332,y:309,skin:"ui/button_times_02.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_times1",label:"5",labelBold:!0,labelSize:28,labelColors:"#fff7c5"},type:"Button"},{props:{x:427,y:309,skin:"ui/button_times_02.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_times2",label:"10",labelBold:!0,labelSize:28,labelColors:"#fff7c5"},type:"Button"},{props:{x:523,y:309,skin:"ui/button_times_02.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_times3",label:"15",labelBold:!0,labelSize:28,labelColors:"#fff7c5"},type:"Button"},{props:{x:619,y:309,skin:"ui/button_times_02.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_times4",label:"20",labelBold:!0,labelSize:28,labelColors:"#fff7c5"},type:"Button"},{props:{x:364,y:414,skin:"ui/button_cancel.png",stateNum:"1",name:"btn_cancel",anchorX:.5,anchorY:.5},type:"Button"},{props:{x:580,y:414,skin:"ui/button_start.png",stateNum:"1",name:"btn_start",labelBold:!0,labelStrokeColor:"#c88d11",labelStroke:2,width:152,height:77,pivotX:76,pivotY:38.5,labelSize:25,labelPadding:"-2",labelColors:"#ffffff"},type:"Button"}],props:{width:960,height:540}}}]);return b}(View),GameUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.GameUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"View",child:[{props:{x:480,y:270,width:960,height:720,anchorX:.5,anchorY:.5,name:"img_cover",mouseThrough:!0,mouseEnabled:!0,visible:!0,sizeGrid:"0,0,0,0",skin:"ui/image_touming.png"},type:"Image"},{props:{x:855,y:436,skin:"ui/button_start.png",name:"btn_start",stateNum:"1",anchorX:.5,anchorY:.5,labelSize:25,labelBold:!0,labelStroke:2,labelColors:"#ffffff",labelStrokeColor:"#1f1e1a",labelPadding:"-3"},type:"Button"},{props:{x:858,y:511,skin:"ui/button_auto.png",name:"btn_auto",stateNum:"1",anchorX:.5,anchorY:.5,labelStroke:2,labelStrokeColor:"#d79814",labelPadding:"-2",labelColors:"#ffffff",labelBold:!0,labelSize:25,width:137,height:68},type:"Button"},{type:"Box",child:[{props:{skin:"ui/image_left.png",x:9,y:31},type:"Image"},{props:{text:"100,112,000",color:"#fff7c5",fontSize:20,anchorX:0,anchorY:.5,name:"label_coin",italic:!0,bold:!0,x:66,y:471,align:"center",width:120,height:20},type:"Label"},{props:{x:-6,y:15,skin:"ui/button_setup.png",name:"btn_set",stateNum:"1",anchorX:0,anchorY:.5},type:"Button"}],props:{x:4,y:30,width:228,height:511,name:"box_left",mouseThrough:!0,mouseEnabled:!0}},{props:{text:"1000",color:"#fcce13",fontSize:36,bold:!0,name:"label_award",x:138,y:424,align:"center",width:120,height:36,anchorX:.5,anchorY:.5},type:"Label"},{type:"Box",child:[{props:{x:76,y:101,skin:"ui/image_main_area.png",name:"image_main_area"},type:"Image"},{props:{skin:"ui/image_main.png",name:"image_middle_bg",mouseEnabled:!1,mouseThrough:!1},type:"Image"},{props:{skin:"ui/button_arrow.png",name:"btn_left",stateNum:"1",anchorX:.5,anchorY:.5,x:36,y:540},type:"Button"},{props:{x:536,skin:"ui/button_arrow.png",name:"btn_right",stateNum:"1",rotation:180,anchorX:.5,anchorY:.5,y:540},type:"Button"},{props:{x:134,skin:"ui/button_bet_02.png",label:"0.5",name:"btn_stake1",anchorX:.5,anchorY:.5,stateNum:"1",labelSize:28,labelBold:!0,labelColors:"#F0B137",y:540,labelPadding:"0"},type:"Button"},{props:{x:281,skin:"ui/button_bet_02.png",label:"2",name:"btn_stake2",anchorX:.5,anchorY:.5,stateNum:"1",labelBold:!0,labelSize:28,labelColors:"#F0B137",y:540,labelPadding:"0"},type:"Button"},{props:{x:431,skin:"ui/button_bet_02.png",label:"5",name:"btn_stake3",anchorX:.5,anchorY:.5,stateNum:"1",labelSize:28,labelBold:!0,labelColors:"#F0B137",y:540,labelPadding:"0"},type:"Button"}],props:{x:209,y:-33,name:"box_middle",mouseEnabled:!0,mouseThrough:!0}},{type:"Box",child:[{props:{skin:"ui/image_game_name.png"},type:"Image"},{props:{x:102,y:46,text:"Level 1",name:"label_level",color:"#fff0cd",bold:!0,fontSize:24,stroke:5,strokeColor:"#894503",italic:!0,width:81.38671875,height:24,pivotX:40.693359375,pivotY:12},type:"Label"},{props:{skin:"ui/image_small_map.png",name:"image_small_map",x:108,y:316,anchorX:.5,anchorY:.5},type:"Image"},{props:{x:179,y:369,skin:"ui/image_star_gray.png",anchorX:.5,anchorY:.5,name:"image_star1"},type:"Image"},{props:{x:179,y:337,skin:"ui/image_star_gray.png",anchorX:.5,anchorY:.5,name:"image_star2"},type:"Image"},{props:{x:179,y:305,skin:"ui/image_star_gray.png",anchorX:.5,anchorY:.5,name:"image_star3"},type:"Image"}],props:{x:747,y:3,width:212,height:539,name:"box_right",mouseEnabled:!0,mouseThrough:!0}},{props:{x:19,y:82,skin:"ui/image_touming.png",width:200,height:300,name:"left_list_cover"},type:"Image"},{props:{x:196,y:504,skin:"ui/button_chrage_01.png",name:"btn_charge",stateNum:"1",anchorX:.5,anchorY:.5},type:"Button"}],props:{width:960,height:540,x:0,y:0,mouseThrough:!0,mouseEnabled:!0}}}]);return b}(View),GameDesUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.GameDesUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"View",child:[{props:{x:480,y:270,skin:"ui/image_main_area.png",anchorX:.5,anchorY:.5,width:960,height:720,name:"img_background"},type:"Image"},{props:{x:-31,y:-24,skin:"ui/image_ui_utorial_01.png"},type:"Image"},{props:{y:51,skin:"ui/image_ui_utorial_01.png",anchorX:.5,anchorY:.5,skewX:0,skewY:0,scaleX:-1,x:887},type:"Image"},{props:{x:366,y:10,skin:"ui/image_ui_utorial_02.png"},type:"Image"},{type:"Box",child:[{props:{skin:"ui/image_ui_utorial_03.png"},type:"Image"},{props:{x:-3,y:23,skin:"ui/image_utorial_01.png",name:"img_des_1"},type:"Image"}],props:{x:56,y:118,name:"box_1"}},{type:"Box",child:[{props:{skin:"ui/image_ui_utorial_03.png"},type:"Image"},{props:{x:124,y:162,skin:"ui/image_utorial_01.png",name:"img_des_2",anchorX:.5,anchorY:.5},type:"Image"}],props:{x:367,y:117,name:"box_2"}},{type:"Box",child:[{props:{skin:"ui/image_ui_utorial_03.png"},type:"Image"},{props:{x:126,y:165,skin:"ui/image_utorial_01.png",name:"img_des_3",anchorX:.5,anchorY:.5},type:"Image"}],props:{x:665,y:119,name:"box_3"}},{props:{x:490,y:492,skin:"ui/button_utorial_01.png",stateNum:"1",name:"btn_sure",anchorX:.5,anchorY:.5},type:"Button"}],props:{width:960,height:540}}}]);return b}(View),GamePlayDesUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.GamePlayDesUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"View",child:[{props:{x:480,y:270,skin:"ui/image_descrip.png",anchorX:.5,anchorY:.5},type:"Image"},{props:{x:760,y:80,skin:"ui/button_close_04.png",stateNum:"1",anchorX:.5,anchorY:.5,name:"btn_close"},type:"Button"},{props:{x:411,y:455,skin:"ui/button_arrow.png",anchorX:.5,anchorY:.5,stateNum:"1",name:"btn_left",scaleX:.8,scaleY:.8},type:"Button"},{props:{x:569,y:455,skin:"ui/button_arrow.png",anchorX:.5,anchorY:.5,stateNum:"1",scaleX:-.8,name:"btn_right",scaleY:.8},type:"Button"},{props:{x:492,y:455,text:"1-9",color:"#fbf6f6",fontSize:25,name:"label_page",anchorX:.5,anchorY:.5},type:"Label"},{props:{x:480,y:258,skin:"ui/image_main_area.png",anchorX:.5,anchorY:.5,width:613,height:283,name:"image_content"},type:"Image"}],props:{width:960,height:540}}}]);return b}(View),GMUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.GMUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"View",child:[{props:{x:344,y:454,skin:"ui/button_return_01.png",stateNum:"1",name:"btn_close",anchorX:.5,anchorY:.5},type:"Button"},{props:{x:610,y:454,skin:"ui/button_start.png",stateNum:"1",name:"btn_start",anchorX:.5,anchorY:.5},type:"Button"},{props:{x:480,y:101,skin:"comp/textinput.png",text:"1",anchorX:.5,anchorY:.5,name:"textinput_stake",bold:!0,width:150,height:44,fontSize:30},type:"TextInput"},{props:{x:480,y:175,skin:"comp/textinput.png",text:"1",name:"textinput_count",bold:!0,width:150,height:44,pivotX:75,pivotY:22,fontSize:30},type:"TextInput"},{props:{x:243,y:87,text:"\u4e0b\u6ce8\uff1a",fontSize:30,bold:!0,color:"#f90400"},type:"Label"},{props:{x:243,y:161,text:"\u5f00\u5956\u6b21\u6570\uff1a",fontSize:30,bold:!0,color:"#f90400"},type:"Label"},{props:{x:243,y:230,text:"\u603b\u5171\u5956\u52b1\uff1a",fontSize:30,bold:!0,color:"#f90400"},type:"Label"},{props:{x:406,y:230,text:"0",fontSize:30,bold:!0,color:"#ffea00",width:300,name:"label_award_total"},type:"Label"},{props:{x:243,y:292,text:"\u5e73\u5747\u5956\u52b1\uff1a",fontSize:30,bold:!0,color:"#f90400"},type:"Label"},{props:{x:406,y:292,text:"0",fontSize:30,bold:!0,color:"#ffea00",width:300,name:"label_award_per"},type:"Label"},{props:{x:243,y:350,text:"\u603b\u8017\u65f6\uff1a",fontSize:30,bold:!0,color:"#f90400"},type:"Label"},{props:{x:406,y:350,text:"0\u65f60\u52060\u79d2",fontSize:30,bold:!0,color:"#ffffff",width:300,name:"label_cost_time"},type:"Label"}],props:{width:960,height:540}}}]);return b}(View),LevelDesUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.LevelDesUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"View",child:[{props:{x:327,y:119,skin:"ui/image_ui_level_01.png"},type:"Image"},{props:{x:473,y:455,skin:"ui/button_utorial_01.png",stateNum:"1",name:"btn_close",anchorX:.5,anchorY:.5},type:"Button"},{props:{x:471,y:166,skin:"ui/image_game_name.png",anchorX:.5,anchorY:.5,name:"img_title"},type:"Image"},{props:{x:477,y:314,skin:"ui/image_ui_utorial_03.png",anchorX:.5,anchorY:.5,name:"img_content"},type:"Image"}],props:{width:960,height:540}}}]);return b}(View),LevelUpUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.LevelUpUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"View",child:[{props:{x:337,y:129,skin:"ui/image_ui_level_01.png"},type:"Image"},{props:{x:486,y:181,skin:"ui/image_lelve_titile_01.png",anchorX:.5,anchorY:.5,name:"img_title"},type:"Image"},{props:{x:397,y:224,skin:"ui/image_lelve_desc_01.png"},type:"Image"},{props:{x:521,y:372,text:"\u606d\u559c\u60a8\u901a\u8fc7KingDom 1-1\uff01",width:300,height:24,color:"#a4614d",bold:!0,fontSize:19,anchorX:.5,anchorY:.5,strokeColor:"#a4614d",stroke:.5,name:"label_level_now"},type:"Label"},{props:{x:506,y:401,text:"\u63a5\u4e0b\u6765\u60a8\u5c06\u6311\u6218KingDom 1-1\uff01",width:300,height:24,color:"#a4614d",bold:!0,fontSize:19,anchorX:.5,anchorY:.5,strokeColor:"#a4614d",stroke:.5,name:"label_level_next"},type:"Label"}],props:{width:960,height:540}}}]);return b}(View),NewGuideUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.NewGuideUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"View",child:[{type:"Box",child:[{props:{x:481,y:302,skin:"ui/image_main_area.png",width:960,height:720,anchorX:.5,anchorY:.5,name:"game_bg"},type:"Image"},{props:{skin:"ui/image_left.png",x:25,y:61},type:"Image"},{props:{x:858,y:436,skin:"ui/button_start.png",name:"btn_start",stateNum:"1",anchorX:.5,anchorY:.5,labelSize:25,labelBold:!0,labelStroke:2,labelColors:"#ffffff",labelStrokeColor:"#1f1e1a",labelPadding:"-3"},type:"Button"},{props:{x:859,y:511,skin:"ui/button_auto.png",name:"btn_auto",stateNum:"1",anchorX:.5,anchorY:.5,labelStroke:2,labelStrokeColor:"#d79814",labelPadding:"-2",labelColors:"#ffffff",labelBold:!0,labelSize:25,width:137,height:68},type:"Button"},{props:{skin:"ui/image_main.png",name:"image_middle_bg",mouseEnabled:!1,mouseThrough:!1,x:211,y:-37},type:"Image"},{props:{skin:"ui/button_arrow.png",name:"btn_left",stateNum:"1",anchorX:.5,anchorY:.5,x:251,y:500},type:"Button"},{props:{x:726,skin:"ui/button_arrow.png",name:"btn_right",stateNum:"1",rotation:180,anchorX:.5,anchorY:.5,y:501},type:"Button"},{props:{x:352,skin:"ui/button_bet_01.png",label:"1",name:"btn_stake1",anchorX:.5,anchorY:.5,stateNum:"1",labelSize:28,labelBold:!0,labelColors:"#633b29",y:503,labelPadding:"0"},type:"Button"},{props:{x:492,skin:"ui/button_bet_02.png",label:"2",name:"btn_stake2",anchorX:.5,anchorY:.5,stateNum:"1",labelBold:!0,labelSize:28,labelColors:"#F0B137",y:504,labelPadding:"0"},type:"Button"},{props:{x:628,skin:"ui/button_bet_02.png",label:"5",name:"btn_stake3",anchorX:.5,anchorY:.5,stateNum:"1",labelSize:28,labelBold:!0,labelColors:"#F0B137",y:503,labelPadding:"0"},type:"Button"},{props:{text:"0.00",color:"#fcce13",fontSize:36,bold:!0,name:"label_award",x:144,y:425,align:"center",width:120,height:36,anchorX:.5,anchorY:.5},type:"Label"}],props:{x:480,y:270,width:960,height:540,name:"box_middle",mouseThrough:!0,mouseEnabled:!0,anchorX:.5,anchorY:.5}},{props:{x:479,y:270,skin:"ui/image_touming.png",width:960,height:540,name:"game_touch",mouseEnabled:!0,pivotX:480,pivotY:270},type:"Image"},{props:{x:360,y:406,skin:"ui/image_xs_word_1.png",name:"img_word_1"},type:"Image"},{props:{x:739,y:339,skin:"ui/image_xs_word_2.png",name:"img_word_2"},type:"Image"},{props:{x:773,y:390,skin:"ui/image_xs_word_3.png",name:"img_word_3"},type:"Image"},{props:{x:296,y:116,skin:"ui/image_xs_word_5.png",name:"img_word_5"},type:"Image"},{props:{x:690,y:81,skin:"ui/image_xs_word_6.png",name:"img_word_6"},type:"Image"},{props:{x:228,y:400,skin:"ui/image_xs_word_7.png",name:"img_word_4"},type:"Image"}],props:{width:960,height:540}}}]);return b}(View),SetUpUI=function(a){function b(){b.__super.call(this)}CLASS$(b,"ui.SetUpUI",a);b.prototype.createChildren=function(){laya.ui.Component.prototype.createChildren.call(this);this.createView(b.uiView)};STATICATTR$(b,["uiView",function(){return this.uiView={type:"Dialog",child:[{props:{skin:"ui/image_set.png",centerY:.5,y:47,centerX:.5},type:"Image"},{props:{x:473,y:411,skin:"ui/button_return_01.png",name:"btn_close",stateNum:"1",anchorX:.5,anchorY:.5},type:"Button"},{props:{x:395,y:203,skin:"ui/button_switch_01.png",stateNum:"1",name:"btn_music",anchorX:.5,anchorY:.5},type:"Button"},{props:{x:605,y:201,skin:"ui/button_switch_02.png",sizeGrid:"0,0,0,0",stateNum:"1",name:"btn_effect",width:48,height:50,pivotX:24,pivotY:25},type:"Button"},{props:{x:476,y:305,skin:"ui/button_desc_01.png",stateNum:"1",name:"btn_des",anchorX:.5,anchorY:.5},type:"Button"}],props:{width:960,height:540}}}]);return b}(Dialog);function CreateEventDispatcher(){var a={};return{subscribe:function(b,c,d,e){if("string"!=typeof b&&"number"!=typeof b)throw Error("eventId is not number or string, it's type is "+typeof b);if("function"!=typeof c)throw Error("func is not function, it's type is "+typeof c);var f=a[b];if(!(f instanceof Array))return f=[],"number"!=typeof e&&(e=f.length),f.push({func:c,target:d,priority:e}),a[b]=f,!0;for(var g=0,h=f.length;g<h;++g)if(c==f[g].func)return!1;"number"!=typeof e&&(e=f.length);a[b].push({func:c,target:d,priority:e});a[b].sort(function(a,b){return a.priority-b.priority});return!0},unsubscribe:function(b,c){if("string"!=typeof b&&"number"!=typeof b)throw Error("eventId is not number or string, it's type is "+typeof b);var d=a[b];if(d instanceof Array)if("function"!=typeof c)delete a[b];else{for(var e=0,f=d.length;e<f;++e)if(d[e]&&"object"==typeof d[e]&&c==d[e].func){d.splice(e,1);break}0==d.length&&delete a[b]}},post:function(b){if("string"!=typeof b&&"number"!=typeof b)throw Error("eventId is not number or string, it's type is "+typeof b);var c=a[b];if(!(c instanceof Array)||0==c.length)return!1;for(var d=0,e=c.length;d<e;++d)c[d]&&"object"==typeof c[d]&&"function"==typeof c[d].func&&c[d].func.apply(c[d].target,Array.prototype.slice.call(arguments,1));return!0}}}var EventCenter=function(){var a=CreateEventDispatcher();return{bind:function(b,c,d,e){return a.subscribe(b,c,d,e)},unbind:function(b,c){a.unsubscribe(b,c)},post:function(b){return a.post.apply(a,arguments)}}}();function EventDispatcherHang(a){if(!a||"object"!=typeof a&&"function"!=typeof a)throw Error("not support for obj type '"+typeof a+"'");a.bind=function(b,c,d){a._eventHandlerMap="object"==typeof a._eventHandlerMap?a._eventHandlerMap:{};if(a._eventHandlerMap[b])throw Error("can't subscribe two same event "+b);a._eventHandlerMap[b]=c;EventCenter.bind(b,a._eventHandlerMap[b],a,d)};a.unbind=function(b){a._eventHandlerMap="object"==typeof a._eventHandlerMap?a._eventHandlerMap:{};if(b)a._eventHandlerMap[b]&&(EventCenter.unbind(b,a._eventHandlerMap[b]),delete a._eventHandlerMap[b]);else{for(var c in a._eventHandlerMap)a._eventHandlerMap.hasOwnProperty(c)&&EventCenter.unbind(c,a._eventHandlerMap[c]);a._eventHandlerMap={}}}}function setobjectclone(a){function b(a){if(void 0==a||null==a||"object"!=typeof a||a instanceof HTMLElement)return a;var d=a.constructor?new a.constructor:{},e;for(e in a)a.hasOwnProperty(e),d[e]=b(a[e]);return d}return b(a)}function definegettersetter(a,b,c,d,e,f){if(a.__defineGetter__)c&&a.__defineGetter__(b,c),d&&a.__defineSetter__(b,d);else if(Object.defineProperty){var g={enumerable:!1,configurable:!0};c&&(g.get=c);d&&(g.set=d);Object.defineProperty(a,b,g)}else throw Error("browser does not support getters");if(!e&&!f)for(var g=null!=c,h=void 0!=d,k=Object.getOwnPropertyNames(a),l=0;l<k.length;l++){var m=k[l];if((a.__lookupGetter__?!a.__lookupGetter__(m):!Object.getOwnPropertyDescriptor(a,m))&&"function"==typeof a[m]){var n=a[m];if(g&&n==c&&(e=m,!h||f))break;if(h&&n==d&&(f=m,!g||e))break}}a=a.constructor;e&&(a.__getters__||(a.__getters__={}),a.__getters__[e]=b);f&&(a.__setters__||(a.__setters__={}),a.__setters__[f]=b)}var mClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),getNewID:function(){return this.id++},getNewInstanceId:function(){return this.instanceId++}};Class=function(){var a=/\b_super\b/,b=function(){};b.extend=function(b){function d(){this.__instanceId=mClassManager.getNewInstanceId();"function"==typeof this.ctor&&this.ctor.apply(this,arguments)}var e=this.prototype,f=Object.create(e),g=mClassManager.getNewID();mClassManager[g]=e;var h={writable:!0,enumerable:!1,configurable:!0};f.__instanceId=null;d.id=g;h.value=g;Object.defineProperty(f,"__pid",h);d.prototype=f;h.value=d;Object.defineProperty(d.prototype,"constructor",h);this.__getters__&&(d.__getters__=setobjectclone(this.__getters__));this.__setters__&&(d.__setters__=setobjectclone(this.__setters__));for(var g=0,k=arguments.length;g<k;++g){var l=arguments[g],m;for(m in l){var n="function"==typeof l[m],p="function"==typeof e[m],r=a.test(l[m]);n&&p&&r?(h.value=function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);this._super=c;return d}}(m,l[m]),Object.defineProperty(f,m,h)):n?(h.value=l[m],Object.defineProperty(f,m,h)):f[m]=l[m];if(n){var q,v;if(this.__getters__&&this.__getters__[m]){var n=this.__getters__[m],w;for(w in this.__setters__)if(this.__setters__[w]==n){v=w;break}definegettersetter(f,n,l[m],l[v]?l[v]:f[v],m,v)}if(this.__setters__&&this.__setters__[m]){var n=this.__setters__[m],x;for(x in this.__getters__)if(this.__getters__[x]==n){q=x;break}definegettersetter(f,n,l[q]?l[q]:f[q],l[m],q,m)}}}}d.extend=Class.extend;d.implement=function(a){for(var b in a)f[b]=a[b]};return d};return b}();Page={getData:function(a,b,c){if(!(a instanceof Array))throw Error("not support for arr type "+typeof a);if(isNaN(b)||0>=b)throw Error("not support for numPerPage");if(isNaN(c)||0>c)throw Error("not support for beginIndex");var d=[],e=a.length;if(0==e||0>c||c>=e)return d;e<b&&(c=0);b=c+b;for(b>e&&(b=e);c<b;++c)d.push(a[c]);return d},getCountA:function(a,b){if(isNaN(a)||0>a)throw Error("not support for totalCount");if(isNaN(b)||0>=b)throw Error("not support for numPerPage");if(0==a)return 0;var c=Math.floor(a/b);return 0==a%b?c:c+1},getDataA:function(a,b,c){if(!(a instanceof Array))throw Error("not support for arr type "+typeof a);if(isNaN(b)||0>=b)throw Error("not support for numPerPage");if(isNaN(c)||0>c)throw Error("not support for currPage");var d=[],e=a.length,f=this.getCountA(e,b);if(0==f||c>=f)return d;c*=b;e<b&&(c=0);b=c+b;b>e&&(b=e);for(e=c;e<b;++e)d.push(a[e]);return d},getCountB:function(a,b){if(isNaN(a)||0>a)throw Error("not support for totalCount");if(isNaN(b)||0>=b)throw Error("not support for numPerPage");if(0==a)return 0;var c=Math.floor(a/(b-1));return 1>=a%(b-1)?c:c+1},getDataB:function(a,b,c){if(!(a instanceof Array))throw Error("not support for arr type "+typeof a);if(isNaN(b)||0>=b)throw Error("not support for numPerPage");if(isNaN(c)||0>c)throw Error("not support for currPage");var d=[],e=a.length,f=this.getCountB(e,b);if(0==f||c>=f)return d;c*=b-1;e<b&&(c=0);b=c+b;b>e&&(b=e);for(e=c;e<b;++e)d.push(a[e]);return d},create:function(a,b,c){function d(a){var b=f.length;if(0==b)return[];if(b<g)return h=0,l.getData(f,g,h);if(h>b-g)return h=b-g,l.getData(f,g,h);e.MT_ONE_PREV==a?0<h&&--h:e.MT_ONE_NEXT==a?h+g<b&&++h:e.MT_PAGE_PREV==a?h=0<h-g?h-(g-1):0:e.MT_PAGE_NEXT==a?h=h+2*g<b?h+(g-1):b-g:e.MT_PAGE_FIRST==a?h=0:e.MT_PAGE_LAST==a&&(h=b-g);return l.getData(f,g,h)}var e={MT_NONE:0,MT_ONE_PREV:1,MT_ONE_NEXT:2,MT_PAGE_PREV:3,MT_PAGE_NEXT:4,MT_PAGE_FIRST:5,MT_PAGE_LAST:6},f=[],g=1,h=0,k={},l=this;k.reset=function(a,b,c){if(!(a instanceof Array))throw Error("not support for dataList type "+typeof a);b=isNaN(b)||0>=b?1:b;c=isNaN(c)||0>c?0:c;f=a;g=b;h=c};k.isCanMovePrev=function(){return!(0==f.length||0==h)};k.isCanMoveNext=function(){return!(0==f.length||g==f.length||h>=f.length-g)};k.getBeginIndex=function(){return h};k.getNumPerPage=function(){return g};k.getCurrPage=function(){return d(e.MT_NONE)};k.moveOnePrev=function(){return d(e.MT_ONE_PREV)};k.moveOneNext=function(){return d(e.MT_ONE_NEXT)};k.movePagePrev=function(){return d(e.MT_PAGE_PREV)};k.movePageNext=function(){return d(e.MT_PAGE_NEXT)};k.movePageFirst=function(){return d(e.MT_PAGE_FIRST)};k.movePageLast=function(){return d(e.MT_PAGE_LAST)};k.moveToIndex=function(a){h=g*Math.floor(a/g);return d()};k.reset(a,b,c);return k}};function CreateProbability(a){function b(){for(var b=0,c=a.length;b<c;++b){var d=Math.floor(Math.random()*(b-0)+.5);if(d!=b){var e=a[d];a[d]=a[b];a[b]=e}}g=1;h=[];b=0;for(c=a.length;b<c;++b){e=a[b];if(!(e instanceof Array)||isNaN(e[1]))throw Error("weightList format is error");d=e[0];e=e[1];0<e&&(h.push({value:d,begin:g,end:g+e-1}),g+=e)}}if(!(a instanceof Array))throw Error("weightList is not table, it's type is "+typeof a);for(var c=[],d=0,e=a.length;d<e;++d){var f=a[d];if(!(f instanceof Array))throw Error("weight list at index ["+d+"] is not table, it't type is "+typeof f);if(void 0==f[0]||null==f[0])throw Error("weight list at index ["+d+"] format is error, not support value type "+typeof f[0]);if(isNaN(f[1]))throw Error("weight list at index ["+d+"] format is error, not support weight type "+typeof f[1]);if(0>f[1])throw Error("weight list at index ["+d+"] is error, not support weight value "+f[1]+" \x3c 0");c[d]=[f[0],f[1]]}var g=1,h=[];b();return{getValue:function(){if(1!=g)for(var a=Math.floor(Math.random()*(g-1-1)+1.5),b=0,c=h.length;b<c;++b){var d=h[b];if(a>=d.begin&&a<=d.end)return d.value}},getWeight:function(b){for(var c=0,d=a.length;c<d;++c){var e=a[c];if(b==e[0])return e[1]}return 0},getTotalWeight:function(){for(var b=0,c=0,d=a.length;c<d;++c)b+=a[c][1];return b},setWeight:function(c,d){if(void 0==c||null==c)throw Error("not support value type "+typeof c);if(isNaN(d))throw Error("not support weight type "+typeof c);if(0>d)throw Error("not support weight value "+d+" \x3c 0");for(var e=!1,f=0,g=a.length;f<g;++f)if(c==a[f][0]){a[f][1]=d;e=!0;break}e||a.push([c,d]);b()},reset:function(){a=[];for(var d=0,e=c.length;d<e;++d){var f=c[d];a[d]=[f[0],f[1]]}b()}}}Action={mImageList:[],clearImageList:function(){for(var a=0,b=this.mImageList.length;a<b;++a)this.mImageList[a].removeSelf(),this.mImageList[a].destroy();this.mImageList=[]},playOldElementDrop:function(a,b,c,d,e,f,g){f="function"==typeof f?f:function(){};if(b&&b.getNode()){var h=b.getNode(),k=d[d.length-1];k?h.timerOnce(e*G.DROP_TIME,null,function(){laya.moveTo(h,{x:k.x,y:k.y},G.DROP_TIME*d.length,null,function(){CoreDef.ObjectType.normal==b.getType()&&AudioModel.playSound(3003);f.apply(g,[])},g)}):f.apply(g,[])}else f.apply(g,[])},playNewElementDrop:function(a,b,c,d,e,f,g){f="function"==typeof f?f:function(){};if(b&&b.getNode()){var h=function(){(k=b.getNode())&&k.y>=r-G.GRID_HEIGHT&&(k.visible=!0,k.clearTimer(null,h))},k=b.getNode(),l=d[d.length-1],m=0,n=0,p=k.x,r=k.y,q=laya.utils.Ease.strongIn;k.pos(p,r-(e+1)*G.GRID_HEIGHT);k.frameLoop(.01,null,h);l?(0==a?(m=G.DROP_FIRST_TIME*(d.length+1+e),n=(c.col-1)*G.DROP_FIRST_GAP):m=G.DROP_TIME*(d.length+1+e),laya.moveTo(k,{x:l.x,y:l.y},m+n,q,function(){CoreDef.ObjectType.normal==b.getType()&&AudioModel.playSound(3003);laya.moveTo(k,{x:l.x,y:l.y-2},.1,q,function(){laya.moveTo(k,{x:l.x,y:l.y},.1,q,function(){f.apply(g,[])},g)},g)},g)):(0==a?(m=G.DROP_FIRST_TIME*(e+1),n=(c.col-1)*G.DROP_FIRST_GAP):m=G.DROP_TIME*(e+1),laya.moveTo(k,{x:p,y:r},m+n,q,function(){CoreDef.ObjectType.normal==b.getType()&&AudioModel.playSound(3003);laya.moveTo(k,{x:p,y:r-2},.1,q,function(){laya.moveTo(k,{x:p,y:r},.1,q,function(){f.apply(g,[])},g)},g)},g))}else f.apply(g,[])},playSurfaceClear:function(a,b,c,d){c="function"==typeof c?c:function(){};AudioModel.playSound(3002);if(a&&(b=a.getNode())){var e=new laya.ui.Image(ResURL("image_map_surface_glass_02.png"));e.anchorX=.5;e.anchorY=.5;e.zOrder=b.zOrder;e.pos(b.x,b.y);b.parent.addChild(e);a.dtor();this.mImageList.push(e)}c.apply(d,[])},playClearEffect:function(a,b,c,d){c="function"==typeof c?c:function(){};if(a&&1==b){var e=a.getNode();if(e){var f={20101:["image_map_object_normal_red_01.png","image_map_object_normal_red_02.png"],20102:["image_map_object_normal_yellow_01.png","image_map_object_normal_yellow_02.png"],20103:["image_map_object_normal_green_01.png","image_map_object_normal_green_02.png"],20104:["image_map_object_normal_blue_01.png","image_map_object_normal_blue_02.png"],20105:["image_map_object_normal_purple_01.png","image_map_object_normal_purple_02.png"],20106:["image_map_object_normal_pink_01.png","image_map_object_normal_pink_02.png"],20107:["image_map_object_normal_plum_01.png","image_map_object_normal_plum_02.png"],20108:["image_map_object_normal_wail_01.png","image_map_object_normal_wail_02.png"]}[a.getId()];e.skin=ResURL(f[1]);e.timerOnce(150,this,function(){e.skin=ResURL(f[0]);e.timerOnce(150,this,function(){e.skin=ResURL(f[1]);e.timerOnce(150,this,function(){e.skin=ResURL(f[0]);e.timerOnce(150,this,function(){c.apply(d,[])})})})});return}}c.apply(d,[])},playObjectClear:function(a,b,c,d,e){d="function"==typeof d?d:function(){};if(a)if(a.getNode()){a.dtor();AudioModel.playSound(3002);var f=laya.createArmature(ResURL("yuansuxiaochu.png"),ResURL("yuansuxiaochu.sk"),!1,null,null,function(){f.removeSelf();f.destroy();d.apply(e,[])},this);1==c?f.play("ue_clear_1"):f.play("ue_clear_2");f.pos(b.x,b.y);Controller.getView().getSceneLayer().addChild(f)}else d.apply(e,[]);else d.apply(e,[])},playAttachClear:function(a,b,c,d,e){d="function"==typeof d?d:function(){};if(a)if(a.getNode())if(CoreDef.AttachType.cross==a.getType()){var f=function(a,b){if(0==a)0>=--g&&d.apply(e,[]);else{var f=new laya.ui.Image(ResURL("image_shizixiaolashen.png"));f.anchorX=0;f.anchorY=.5;"up"==b?(f.rotation=270,f.pos(c.x,c.y+G.GRID_HEIGHT/2)):"down"==b?(f.rotation=90,f.pos(c.x,c.y-G.GRID_HEIGHT/2)):"left"==b?(f.rotation=180,f.pos(c.x+G.GRID_WIDTH/2,c.y)):"right"==b&&(f.rotation=0,f.pos(c.x-G.GRID_WIDTH/2,c.y));f.zOrder=100;Controller.getView().getSceneLayer().addChild(f);laya.scaleFromTo(f,1,1,a+1,.4,function(){laya.fadeOut(f,.3,function(){f.removeSelf();f.destroy();0>=--g&&d.apply(e,[])},this)},this)}};AudioModel.playSound(3010);a.dtor();var g=4;f(b.row-1,"up");f(G.MAP_ROW-b.row,"down");f(b.col-1,"left");f(G.MAP_COL-b.col,"right")}else if(CoreDef.AttachType.oblique==a.getType()){AudioModel.playSound(3008);var h=laya.createArmature(ResURL("xzixiao.png"),ResURL("xzixiao.sk"),!1,null,null,function(){h.removeSelf();h.destroy();a.dtor();d.apply(e,[])},this);h.play("skill_x_blast");h.pos(c.x,c.y-10);Controller.getView().getSceneLayer().addChild(h)}else a.dtor(),d.apply(e,[]);else a.dtor(),d.apply(e,[]);else d.apply(e,[])},playElementScreenOut:function(a,b,c,d,e){d="function"==typeof d?d:function(){};if(a){var f=a.getNode();if(f){var g={x:c.x,y:c.y+G.GRID_HEIGHT*(G.MAP_ROW-b.row+1)},h=G.DROP_LAST_TIME*(G.MAP_ROW-b.row+1);laya.delayWith(f,(b.col-1)*G.DROP_LAST_GAP,function(){laya.moveTo(f,g,h,laya.utils.Ease.strongOut,function(){a.dtor();d.apply(e,[])})})}else d.apply(e,[])}else d.apply(e,[])},playRandomReplaceAction:function(a,b,c,d,e){d="function"==typeof d?d:function(){};AudioModel.playSound(3001);var f=a.getNode(),g=b.getNode();if(f&&g){var h=laya.createArmature(ResURL("suijitihuan.png"),ResURL("suijitihuan.sk"),!1,null,null,function(){h.removeSelf();h.destroy();a.dtor();g.visible=!0;d.apply(e,[])},this);h.play("bonus_01_01_cast");h.pos(c.x,c.y);Controller.getView().getSceneLayer().addChild(h)}else d.apply(e,[])},playDiscolorRayAction1:function(a,b,c,d,e,f){e="function"==typeof e?e:function(){};AudioModel.playSound(3001);var g=a.getNode(),h=b.getNode();g&&h?laya.delayWith(h,.1*(d+1),function(){var b=laya.createArmature(ResURL("suijitihuan.png"),ResURL("suijitihuan.sk"),!1,null,null,function(){b.removeSelf();b.destroy();a.dtor();h.visible=!0;e.apply(f,[])},this);b.play("bonus_01_01_cast");b.pos(c.x,c.y);Controller.getView().getSceneLayer().addChild(b)},this):e.apply(f,[])},playDiscolorRayAction2:function(a,b,c,d,e){d="function"==typeof d?d:function(){};AudioModel.playSound(3001);if(0<c&&Controller.isShowDisplay()){var f=new laya.ui.Image(ResURL("image_shizixiaolashen.png"));f.anchorX=1;f.anchorY=.5;var g=0,h=0;"up"==b?(f.rotation=270,f.pos(a.x,a.y-G.GRID_HEIGHT/2),h=-G.GRID_HEIGHT*c):"down"==b?(f.rotation=90,f.pos(a.x,a.y+G.GRID_HEIGHT/2),h=G.GRID_HEIGHT*c):"left"==b?(f.rotation=180,f.pos(a.x-G.GRID_WIDTH/2,a.y),g=-G.GRID_WIDTH*c):"right"==b&&(f.rotation=0,f.pos(a.x+G.GRID_WIDTH/2,a.y),g=G.GRID_WIDTH*c);f.zOrder=100;Controller.getView().getSceneLayer().addChild(f);laya.scaleFromTo(f,2,1,1.4,.5,null,null);laya.moveBy(f,{x:g,y:h},.5,null,function(){laya.scaleFromTo(f,1,1,0,.5,function(){f.removeSelf();f.destroy();d.apply(e,[])},this)},this)}else d.apply(e,[])},playDiagonalDiscolorAction1:function(a,b,c,d){c="function"==typeof c?c:function(){};AudioModel.playSound(3001);if(Controller.isShowDisplay()){var e=laya.createArmature(ResURL("duijiaobianse.png"),ResURL("duijiaobianse.sk"),!1,null,null,function(){e.removeSelf();e.destroy();c.apply(d,[])},this);e.play("bonus_01_03_cast");1==a.row&&1==a.col?e.pos(b.x+165,b.y+190):1==a.row&&6==a.col?(e.rotation=90,e.pos(b.x-190,b.y+165)):6==a.row&&1==a.col?(e.rotation=270,e.pos(b.x+190,b.y-165)):6==a.row&&6==a.col&&(e.rotation=180,e.pos(b.x-165,b.y-190));Controller.getView().getSceneLayer().addChild(e)}else c.apply(d,[])},playRandomAllMatchAction:function(a,b,c,d,e){d="function"==typeof d?d:function(){};AudioModel.playSound(3007);c=a.getNode();var f=b.getNode();c&&f?(a.dtor(),a=laya.createArmature(ResURL("baida.png"),ResURL("baida.sk"),!1,null,null,function(){d.apply(e,[])},this),a.play("bonus_03_01_cast"),b.setNode(a),laya.setPositionOffset(a,{x:-5,y:2})):d.apply(e,[])},playFixedAllMatchAction:function(a,b,c,d,e,f){e="function"==typeof e?e:function(){};AudioModel.playSound(3007);d=a.getNode();b=b.getNode();var g=c.getNode();d&&b&&g?(a.dtor(),b.visible=!0,a=laya.createArmature(ResURL("baida.png"),ResURL("baida.sk"),!1,null,null,function(){e.apply(f,[])},this),a.play("bonus_03_02_cast"),c.setNode(a),laya.setPositionOffset(a,{x:-5,y:2})):e.apply(f,[])},playPositionSwapAction1:function(a,b,c,d){c="function"==typeof c?c:function(){};if(0<a.length)for(var e=a.length,f=0,g=a.length;f<g;++f){var h=a[f];h&&h.getNode()?laya.moveTo(h.getNode(),b,.8,laya.utils.Ease.strongOut,function(){0>=--e&&laya.callAfter(.8,c,d)},this):0>=--e&&c.apply(d,[])}else c.apply(d,[])},playElementFixedAction:function(a,b,c,d){c="function"==typeof c?c:function(){};AudioModel.playSound(3004);a.getNode()?(b=laya.createArmature(ResURL("baida.png"),ResURL("baida.sk"),!1,null,null,function(){c.apply(d,[])},this),b.play("bonus_03_02_cast"),a.setNode(b),laya.setPositionOffset(b,{x:-5,y:2})):c.apply(d,[])},playRandomRambleAction1:function(a,b,c){b="function"==typeof b?b:function(){};AudioModel.playSound(3009);if(Controller.isShowDisplay()){var d=laya.createArmature(ResURL("suijimanbu.png"),ResURL("suijimanbu.sk"),!1,null,null,function(){d.removeSelf();d.destroy();b.apply(c,[])},this);d.play("bonus_03_05_cast_1");d.pos(a.x-10,a.y+20);Controller.getView().getSceneLayer().addChild(d)}else b.apply(c,[])},playRandomRambleAction2:function(a,b,c,d,e){d="function"==typeof d?d:function(){};Controller.isShowDisplay()&&c?laya.callAfter(.2,function(){var f=laya.createArmature(ResURL("suijimanbu.png"),ResURL("suijimanbu.sk"),!1,null,null,function(){f.removeSelf();f.destroy();d.apply(e,[])},this);f.play("bonus_03_05_cast_2");b.row<c.row?f.pos(a.down.x-3,a.down.y-10):b.row>c.row?(f.rotation=180,f.pos(a.up.x+3,a.up.y+10)):b.col<c.col?(f.rotation=270,f.pos(a.right.x-10,a.right.y+3)):b.col>c.col&&(f.rotation=90,f.pos(a.left.x+10,a.left.y-3));Controller.getView().getSceneLayer().addChild(f)},this):d.apply(e,[])},playRainbowClearAction:function(a,b,c){b="function"==typeof b?b:function(){};AudioModel.playSound(3009);if(Controller.isShowDisplay()){var d=laya.createArmature(ResURL("caihongxiao.png"),ResURL("caihongxiao.sk"),!1,null,null,function(){d.removeSelf();d.destroy();b.apply(c,[])},this);d.play("bonus_03_06_cast");d.pos(a.x,a.y-15);Controller.getView().getSceneLayer().addChild(d)}else b.apply(c,[])},playScreenClearCastAction:function(a,b,c){b="function"==typeof b?b:function(){};AudioModel.playSound(3009);if(Controller.isShowDisplay()){var d=laya.createArmature(ResURL("quanpingsuijixiaochu.png"),ResURL("quanpingsuijixiaochu.sk"),!1,null,null,function(){d.removeSelf();d.destroy();b.apply(c,[])},this);d.play("bonus_03_07_cast");d.pos(Controller.getCenterPos().x,Controller.getCenterPos().y);Controller.getView().getSceneLayer().addChild(d)}else b.apply(c,[])},playScreenClearFlyAction:function(a,b,c,d){c="function"==typeof c?c:function(){};AudioModel.playSound(3009);Controller.isShowDisplay()?laya.delayWith(Controller.getView().getSceneLayer(),1,function(){var b=laya.createArmature(ResURL("quanpingsuijixiaochu.png"),ResURL("quanpingsuijixiaochu.sk"),!1,null,null,function(){},this);b.play("bonus_03_07_cast_fly");b.pos(Controller.getCenterPos().x,Controller.getCenterPos().y);laya.moveTo(b,{x:a.x,y:a.y-15},.9,null,function(){b.removeSelf();b.destroy();c.apply(d,[])},d);Controller.getView().getSceneLayer().addChild(b,-5)}):c.apply(d,[])},playBonus1HintAction:function(a,b){a="function"==typeof a?a:function(){};if(Controller.isShowDisplay()){var c=laya.createArmature(ResURL("bounstishi.png"),ResURL("bounstishi.sk"),!1,null,null,function(){c.removeSelf();c.destroy();a.apply(b,[])},this);c.play("bouns_01_hint");c.pos(Controller.getCenterPos().x,Controller.getCenterPos().y);Controller.getView().getSceneLayer().addChild(c)}else a.apply(b,[])},playBonus2HintAction:function(a,b){a="function"==typeof a?a:function(){};if(Controller.isShowDisplay()){var c=laya.createArmature(ResURL("bounstishi.png"),ResURL("bounstishi.sk"),!1,null,null,function(){c.removeSelf();c.destroy();a.apply(b,[])},this);c.play("bouns_02_hint");c.pos(Controller.getCenterPos().x,Controller.getCenterPos().y);Controller.getView().getSceneLayer().addChild(c)}else a.apply(b,[])},playBonus3HintAction:function(a,b){a="function"==typeof a?a:function(){};if(Controller.isShowDisplay()){var c=laya.createArmature(ResURL("bounstishi.png"),ResURL("bounstishi.sk"),!1,null,null,function(){c.removeSelf();c.destroy();a.apply(b,[])},this);c.play("bouns_03_hint");c.pos(Controller.getCenterPos().x,Controller.getCenterPos().y);Controller.getView().getSceneLayer().addChild(c)}else a.apply(b,[])}};laya=laya||{};laya.callAfter=function(a,b,c){b="function"==typeof b?b:function(){};if(isNaN(a)||0>=a)Laya.timer.callLater(c,b,Array.prototype.slice.call(arguments,3));else Laya.timer.once(1E3*a,c,b,Array.prototype.slice.call(arguments,3))};laya.changeParent=function(a,b,c){if(!a||a.destroyed)throw Error("sprite is null");if(!b||b.destroyed)throw Error("parent is null");a.removeSelf();a.zOrder="number"==typeof c?c:a.zOrder;b.addChild(a)};laya.getWorldPosition=function(a){if(!a||a.destroyed)throw Error("sprite is null");a.anchorX=isNaN(a.anchorX)?0:a.anchorX;a.anchorY=isNaN(a.anchorY)?0:a.anchorY;return a.localToGlobal({x:a.anchorX*a.width,y:a.anchorY*a.height},!1)};laya.getLocalPosition=function(a,b){if(!a||a.destroyed)throw Error("sprite is null");return a.globalToLocal(b,!1)};laya.setPositionOffset=function(a,b){if(!a||a.destroyed)throw Error("sprite is null");a.pos(a.x+b.x,a.y+b.y)};laya.createArmature=function(a,b,c,d,e,f,g){a=laya.net.Loader.getRes(a);b=laya.net.Loader.getRes(b);var h=new laya.ani.bone.Templet,k=null;h.on(laya.events.Event.COMPLETE,this,function(){k=h.buildArmature(c?1:0);k.on(laya.events.Event.PLAYED,this,function(){"function"==typeof d&&k.timer.callLater(g,d,Array.prototype.slice.call(arguments,7))});k.on(laya.events.Event.PAUSED,this,function(){"function"==typeof e&&k.timer.callLater(g,e,Array.prototype.slice.call(arguments,7))});k.on(laya.events.Event.STOPPED,this,function(){"function"==typeof f&&k.timer.callLater(g,f,Array.prototype.slice.call(arguments,7))})});h.parseData(a,b,60);return k};laya.createParticle=function(a,b,c){"/"!=a[a.length-1]&&"\\"!=a[a.length-1]&&(a+="/");var d=Laya.URL.basePath;Laya.URL.basePath+=a;-1==b.lastIndexOf(".part")&&(b+=".part");var e=new Laya.Particle2D;Laya.loader.load(b,Handler.create(this,function(a){e.setParticleSetting(a);Laya.URL.basePath=d;c&&e.timerOnce(1E3*a.duration,this,function(){e.stop();e.removeSelf();e.destroy();e=void 0})}),null,Loader.JSON);return e};laya.createProgress=function(a,b,c,d){d=isNaN(d)||0>=d?1:d;var e=new laya.display.Sprite;e.loadImage(a);e.cacheAs="bitmap";var f=new laya.display.Sprite;f.loadImage(b);f.pos((e.width-f.width)/2,(f.height-e.height)/2);e.addChild(f);var g=new laya.display.Sprite;g.loadImage(c);g.scaleX=1;f.mask=g;var h=g.scaleX,k=1/(60*d);g.frameLoop(1,this,function(){if(g.scaleX<h)g.scaleX+=k,g.scaleX=g.scaleX>h?h:g.scaleX;else if(g.scaleX>h)g.scaleX-=k,g.scaleX=g.scaleX<h?h:g.scaleX;else return;f.repaint()});e.getValue=function(){return h};e.setValue=function(a,b){h=a=isNaN(a)||0>a?0:1<a?1:a;b||(g.scaleX=h,f.repaint())};e.setValue(0);return e};laya.delayWith=function(a,b,c,d){if(!a||a.destroyed)throw Error("sprite is null");c="function"==typeof c?c:function(){};0>=b?c.apply(d,Array.prototype.slice.call(arguments,4)):a.timerOnce(1E3*b,d,c,Array.prototype.slice.call(arguments,4))};laya.runAction=function(a,b,c,d){function e(){if(0==b.length)c.apply(d,f);else{var g=b[0];if(a&&!a.destroyed){if(!g.props||g.props instanceof Array||"object"!=typeof g.props)g.props={};laya.utils.Tween.to(a,g.props,1E3*g.duration,g.ease,laya.utils.Handler.create(this,function(){b.splice(0,1);e()},null,!1))}else c.apply(d,f)}}if(!a||a.destroyed)throw Error("sprite is null");c="function"==typeof c?c:function(){};var f=Array.prototype.slice.call(arguments,4);e()};laya.moveTo=function(a,b,c,d,e,f){if(!a||a.destroyed)throw Error("sprite is null");e="function"==typeof e?e:function(){};laya.utils.Tween.to(a,{x:b.x,y:b.y},1E3*c,d,laya.utils.Handler.create(this,function(){a&&!a.destroyed&&a.pos(b.x,b.y);e.apply(f,Array.prototype.slice.call(arguments,5))},null,!1))};laya.moveToWithPath=function(a,b,c,d,e){if(!a||a.destroyed)throw Error("sprite is null");d="function"==typeof d?d:function(){};if(0==b.length)d.apply(e,Array.prototype.slice.call(arguments,5));else{for(var f=new Laya.TimeLine,g=0,h=b.length;g<h;++g)f.to(a,{x:b[g].x,y:b[g].y},1E3*c);f.on(laya.events.Event.COMPLETE,this,function(){var c=b[b.length-1];a&&!a.destroyed&&a.pos(c.x,c.y);d.apply(e,Array.prototype.slice.call(arguments,5))});f.play(0,!1)}};laya.moveBy=function(a,b,c,d,e,f){if(!a||a.destroyed)throw Error("sprite is null");e="function"==typeof e?e:function(){};var g=a.x,h=a.y;laya.utils.Tween.to(a,{x:g+b.x,y:h+b.y},1E3*c,d,laya.utils.Handler.create(this,function(){a&&!a.destroyed&&a.pos(g+b.x,h+b.y);e.apply(f,Array.prototype.slice.call(arguments,5))},null,!1))};laya.fadeIn=function(a,b,c,d){if(!a||a.destroyed)throw Error("sprite is null");c="function"==typeof c?c:function(){};a.alpha=0;laya.utils.Tween.to(a,{alpha:1},1E3*b,null,laya.utils.Handler.create(this,function(){a&&!a.destroyed&&(a.alpha=1);c.apply(d,Array.prototype.slice.call(arguments,5))},null,!1))};laya.fadeOut=function(a,b,c,d){if(!a||a.destroyed)throw Error("sprite is null");c="function"==typeof c?c:function(){};a.alpha=1;laya.utils.Tween.to(a,{alpha:0},1E3*b,null,laya.utils.Handler.create(this,function(){a&&!a.destroyed&&(a.alpha=0);c.apply(d,Array.prototype.slice.call(arguments,5))},null,!1))};laya.scaleFromTo=function(a,b,c,d,e,f,g){if(!a||a.destroyed)throw Error("sprite is null");f="function"==typeof f?f:function(){};b=1==b?1:2==b?2:0;if(0==b||1==b)a.scaleX=c;if(0==b||2==b)a.scaleY=c;laya.utils.Tween.to(a,{scaleX:2==b?a.scaleX:d,scaleY:1==b?a.scaleY:d},1E3*e,null,laya.utils.Handler.create(this,function(){if(a&&!a.destroyed){if(0==b||1==b)a.scaleX=d;if(0==b||2==b)a.scaleY=d}f.apply(g,Array.prototype.slice.call(arguments,6))},null,!1))};function UIManager(){var a={};return{createUI:function(b,c,d,e,f){function g(a){"function"==typeof d&&a&&d.apply(e,[a])}if(a[b])throw Error("exist ui ["+b+"] aleady");c=c||new laya.ui.View;c.size(c.width||Laya.stage.width,c.height||Laya.stage.height);c.anchorX=.5;c.anchorY=.5;c.pos(Laya.stage.width/2,Laya.stage.height/2);c.mouseEnabled=!0;c.mouseThrough=!0;c.zOrder=2;var h=new laya.ui.View;h.size(Laya.stage.width,Laya.stage.height);h.anchorX=.5;h.anchorY=.5;h.pos(Laya.stage.width/2,Laya.stage.height/2);h.mouseEnabled=!0;h.mouseThrough="boolean"==typeof f?f?!1:!0:!0;h.on(laya.events.Event.ADDED,this,g);h.on(laya.events.Event.CLICK,this,g);h.on(laya.events.Event.DISPLAY,this,g);h.on(laya.events.Event.DRAG_END,this,g);h.on(laya.events.Event.DRAG_MOVE,this,g);h.on(laya.events.Event.DRAG_START,this,g);h.on(laya.events.Event.MOUSE_DOWN,this,g);h.on(laya.events.Event.MOUSE_MOVE,this,g);h.on(laya.events.Event.MOUSE_OUT,this,g);h.on(laya.events.Event.MOUSE_OVER,this,g);h.on(laya.events.Event.MOUSE_UP,this,g);h.on(laya.events.Event.REMOVED,this,g);h.on(laya.events.Event.UNDISPLAY,this,g);h.addChild(c);c={name:b,root:h,node:c};return a[b]=c},destroyUI:function(b){var c=a[b];c&&(c.root.removeSelf(),c.root.destroy(),delete a[b])},destroyAllUI:function(){for(var b in a)a.hasOwnProperty(b)&&(a[b].root.removeSelf(),a[b].root.destroy());a={}},getUI:function(b){return a[b]}}}UI="undefined"==typeof UI?UIManager():UI;UI.mLayerTable="undefined"==typeof UI.mLayerTable?[]:UI.mLayerTable;UI.open=function(a,b,c,d,e,f){var g=this.getUI(b);if(g)return g;g=this.createUI(b,c,function(b){"function"==typeof e&&e(b);if("function"==typeof a.onTouch)a.onTouch(b)},this,d);f&&f.addChild(g.root);EventDispatcherHang(a);a.root=g.root;a.node=g.node;"function"==typeof a.onStart&&a.onStart.apply(a,Array.prototype.slice.call(arguments,6));this.mLayerTable.push(a);return g};UI.close=function(a,b){if(!this.getUI(b))return!1;for(var c=0,d=this.mLayerTable.length;c<d;++c)if(a==this.mLayerTable[c]){this.mLayerTable.splice(c,1);break}"function"==typeof a.unbind&&a.unbind();if("function"==typeof a.onDestroy)a.onDestroy();delete a.root;delete a.node;this.destroyUI(b);return!0};UI.closeAll=function(){for(var a=0,b=this.mLayerTable.length;a<b;++a){"function"==typeof this.mLayerTable[a].unbind&&this.mLayerTable[a].unbind();if("function"==typeof this.mLayerTable[a].onDestroy)this.mLayerTable[a].onDestroy();delete this.mLayerTable[a].root;delete this.mLayerTable[a].node}this.destroyAllUI();this.mLayerTable=[]};UI.update=function(a){for(var b=0,c=this.mLayerTable.length;b<c;++b)if("function"==typeof this.mLayerTable[b].onUpdate)this.mLayerTable[b].onUpdate(a)};UI.getLatest=function(){if(0!=this.mLayerTable.length)return this.mLayerTable.indexOf(this.mLayerTable.length-1)};UI.isOpened=function(a){if(!a)return!1;for(var b=0,c=this.mLayerTable.length;b<c;++b)if(a==this.mLayerTable[b])return!0;return!1};UI.getChild=function(a,b,c){function d(a){if(!a)return null;for(var f=0;f<a.numChildren;++f){var g=a.getChildAt(f);b[g.name]=g;if(c==g.name||(g=d(g)))return g}}if(void 0==a||null==a)throw Error("not support root for null");if(!b||b instanceof Array||"object"!=typeof b)throw Error("not support children for "+typeof b);return void 0!=b[c]&&null!=b[c]?b[c]:d(a)};function UIDEFINE(a,b){function c(a){f||(f=Laya.stage,g=!0);a&&(f!=a&&e.close(),f=a,g=!1)}function d(){if("function"==typeof b)return new b}var e={};e._className=a;var f=null,g=!1;e.openBack=function(){try{if(c(Game.NODE_UI_BACK),!UI.isOpened(e)){console.log("open back ui \x3e\x3e\x3e className: "+e._className);e._children={};for(var a=[e,e._className,d(),!1,null,f],b=0,l=arguments.length;b<l;++b)a.push(arguments[b]);var m=UI.open.apply(UI,a);g&&(m.root.zOrder=1)}}catch(n){alert(n.stack)}};e.openMiddle=function(){try{if(c(Game.NODE_UI_MIDDLE),!UI.isOpened(e)){console.log("open middle ui \x3e\x3e\x3e className: "+e._className);e._children={};for(var a=[e,e._className,d(),!1,null,f],b=0,l=arguments.length;b<l;++b)a.push(arguments[b]);var m=UI.open.apply(UI,a);g&&(m.root.zOrder=2)}}catch(n){alert(n.stack)}};e.openFront=function(a,b,l){try{if(c(Game.NODE_UI_FRONT),!UI.isOpened(e)){console.log("open front ui \x3e\x3e\x3e className: "+e._className);e._children={};for(var m=[e,e._className,d(),!0,function(b){laya.events.Event.CLICK!=b.type||a||e.close()},f],n=3,p=arguments.length;n<p;++n)m.push(arguments[n]);var r=UI.open.apply(UI,m);g&&(r.root.zOrder=3);if("boolean"!=typeof b||b){var q=new laya.ui.Image(ResURL("image_bg_gray.png"));q.scaleX=G.DESIGN_WIDTH/q.width;q.scaleY=G.DESIGN_HEIGHT/q.height;q.anchorX=.5;q.anchorY=.5;q.pos(Laya.stage.width/2,Laya.stage.height/2);q.zOrder=1;r.root.addChild(q);UI.mFrontGrayTable="undefined"==typeof UI.mFrontGrayTable?[]:UI.mFrontGrayTable;for(var m=-1/0,n=null,p=0,v=UI.mFrontGrayTable.length;p<v;++p){var w=UI.mFrontGrayTable[p].root.zOrder;w>=m&&(m=w,n=UI.mFrontGrayTable[p].image)}r.root.zOrder>=m?(n&&(n.visible=!1),q.visible=!0):(n&&(n.visible=!0),q.visible=!1);UI.mFrontGrayTable.push({name:e._className,root:r.root,image:q})}if("boolean"!=typeof l||l){var x=r.node.scaleX,B=r.node.scaleY;laya.utils.Tween.to(r.node,{scaleX:1.1*x,scaleY:1.1*B},120,null,laya.utils.Handler.create(null,function(){laya.utils.Tween.to(r.node,{scaleX:x,scaleY:B},120)},null,!1))}}}catch(C){console.log(C),alert(C.stack)}};e.openTop=function(){try{if(c(Game.NODE_UI_TOP),!UI.isOpened(e)){console.log("open top ui \x3e\x3e\x3e className: "+e._className);e._children={};for(var a=[e,e._className,d(),!1,null,f],b=0,l=arguments.length;b<l;++b)a.push(arguments[b]);var m=UI.open.apply(UI,a);g&&(m.root.zOrder=4)}}catch(n){alert(n.stack)}};e.close=function(){try{if(UI.isOpened(e)){console.log("close ui \x3c\x3c\x3c className: "+e._className);UI.close(e,e._className);for(var a in e)e.hasOwnProperty(a)&&"function"!=typeof e[a]&&"_className"!=a&&delete e[a];e._children={};UI.mFrontGrayTable="undefined"==typeof UI.mFrontGrayTable?[]:UI.mFrontGrayTable;a=0;for(var b=UI.mFrontGrayTable.length;a<b;++a)if(UI.mFrontGrayTable[a].name==e._className){UI.mFrontGrayTable.splice(a,1);break}b=-1/0;a=null;for(var c=0,d=UI.mFrontGrayTable.length;c<d;++c){var f=UI.mFrontGrayTable[c].root.zOrder;f>=b&&(b=f,a=UI.mFrontGrayTable[c].image)}a&&(a.visible=!0)}}catch(g){alert(g.stack)}};e.getChild=function(a){return UI.getChild(e.root,e._children,a)};e.getClassName=function(){return e._className};e.onClick=function(a,b,c,d,e){function f(b){d&&(a.scaleX=g*("number"==typeof b?b:1),a.scaleY=q*("number"==typeof b?b:1))}if(!a)throw Error("sprite is null");"function"!=typeof b&&(b=function(){});var g=a.scaleX,q=a.scaleY,v=!1;a.on(laya.events.Event.MOUSE_DOWN,null,function(){v=!0;f(.9);"boolean"==typeof e&&e?AudioModel.playSound(2001):"number"==typeof e&&0<e&&AudioModel.playSound(e)});a.on(laya.events.Event.MOUSE_OVER,null,function(){v&&f(.9)});a.on(laya.events.Event.MOUSE_UP,null,function(){v=!1;f(1)});a.on(laya.events.Event.MOUSE_OUT,null,function(){v=!1;f(1)});if(laya.ui.Button==a.constructor||laya.ui.CheckBox==a.constructor||laya.ui.Radio==a.constructor)a.clickHandler=laya.utils.Handler.create(this,function(){v=!1;b.apply(c,[a])},[],!1);else a.on(laya.events.Event.CLICK,null,function(d){v=!1;b.apply(c,[a])})};return e}function UIUPDATE(a){"object"==typeof UI&&"function"==typeof UI.update&&UI.update(a)}function UICLEAR(){UI.closeAll();UI.mClsTable="undefined"==typeof UI.mClsTable?{}:UI.mClsTable;for(var a in UI.mClsTable)if(UI.mClsTable.hasOwnProperty(a))for(var b in UI.mClsTable[a])UI.mClsTable[a].hasOwnProperty(b)&&"function"!=typeof UI.mClsTable[a][b]&&"_className"!=b&&delete UI.mClsTable[a][b];UI.mDelayLayerTable=[];UI.mCurrDelayLayer=null;UI.mFrontGrayTable=[]}function UIDELAYPUSH(a,b,c,d){UI.mDelayLayerTable="undefined"==typeof UI.mDelayLayerTable?[]:UI.mDelayLayerTable;var e={};e.layer=a;e.focus="boolean"!=typeof b?!0:b;e.show_gray="boolean"!=typeof c?!0:c;e.show_bounce="boolean"!=typeof d?!0:d;e.params=Array.prototype.slice.call(arguments,4);UI.mDelayLayerTable.push(e)}function UIDELAYPOP(a){if(UI.isOpened(a)||UI.isOpened(UI.mCurrDelayLayer))return!1;UI.mDelayLayerTable="undefined"==typeof UI.mDelayLayerTable?[]:UI.mDelayLayerTable;for(var b=0,c=UI.mDelayLayerTable.length;b<c;++b)if(!a||a===UI.mDelayLayerTable[b].layer){a=UI.mDelayLayerTable[b];UI.mCurrDelayLayer=a.layer;for(var c=[a.focus,a.show_gray,a.show_bounce],d=0,e=a.params.length;d<e;++d)c.push(a.params[d]);openFront.apply(a.layer,c);UI.mDelayLayerTable.splice(b,1);return!0}UI.mCurrDelayLayer=null;return!1}audio_tplt={1001:{type:1,file:"background.mp3"},1002:{type:1,file:"background.mp3"},1003:{type:1,file:"background.mp3"},1004:{type:1,file:"background.mp3"},1999:{type:1,file:"background.mp3"},2001:{type:2,file:"se_ui_click.mp3"},2002:{type:2,file:"se_ui_coin.mp3"},2003:{type:2,file:"se_ui_level_clear.mp3"},2004:{type:2,file:"se_ui_level_up.mp3"},2005:{type:2,file:"se_ui_bonus_1.mp3"},2006:{type:2,file:"se_ui_bonus_2_1.mp3"},2007:{type:2,file:"se_ui_bonus_2_2.mp3"},2008:{type:2,file:"se_ui_bonus_2_3.mp3"},2009:{type:2,file:"se_ui_bonus_2_4.mp3"},3001:{type:2,file:"se_element_change.mp3"},3002:{type:2,file:"se_element_clear.mp3"},3003:{type:2,file:"se_element_drop.mp3"},3004:{type:2,file:"se_element_fix.mp3"},3005:{type:2,file:"se_element_match.mp3"},3007:{type:2,file:"se_wild.mp3"},3008:{type:2,file:"se_skill_cast.mp3"},3009:{type:2,file:"se_skill_rainbow.mp3"},3010:{type:2,file:"se_skill_ray.mp3"},3011:{type:2,file:"se_skill_swop.mp3"},3012:{type:2,file:"se_skill_walk.mp3"},4001:{type:2,file:"Connect_1.mp3"},4002:{type:2,file:"Connect_2.mp3"},4003:{type:2,file:"Connect_3.mp3"},4004:{type:2,file:"Connect_4.mp3"},4005:{type:2,file:"Connect_5.mp3"},4006:{type:2,file:"Connect_6.mp3"},4007:{type:2,file:"Connect_6.mp3"},4008:{type:2,file:"Connect_6.mp3"},4009:{type:2,file:"Connect_6.mp3"},4010:{type:2,file:"Connect_6.mp3"},4011:{type:2,file:"Connect_6.mp3"},4012:{type:2,file:"Connect_6.mp3"},4013:{type:2,file:"Connect_6.mp3"},4014:{type:2,file:"Connect_6.mp3"},4015:{type:2,file:"Connect_6.mp3"}};core_data_tplt_list={map_grid_tplt:{1001:{id:1001,name:"\u666e\u901a\u683c",type:1,file:""},2001:{id:2001,name:"\u51fa\u751f\u70b9",type:2,file:""},3001:{id:3001,name:"\u4f20\u9001\u70b9(\u5165\u53e3)",type:3,file:""},4001:{id:4001,name:"\u4f20\u9001\u70b9(\u51fa\u53e3)",type:4,file:""},5001:{id:5001,name:"\u56de\u6536\u70b9",type:5,file:""}},map_board_tplt:{1001:{id:1001,name:"\u6a2a\u677f",direct:1,file:""},2001:{id:2001,name:"\u7ad6\u7248",direct:2,file:""}},map_boundary_tplt:{1001:{id:1001,name:"\u6a2a\u6846",direct:1,file:""},2001:{id:2001,name:"\u7ad6\u6846",direct:2,file:""}},map_element_tplt:{10100:{id:10100,name:"\u5730\u8868",tag:1,type:1,sub_type:0,file:"image_map_surface_glass_01.png",can_drop:0},20101:{id:20101,name:"\u7269\u4ef6(\u7ea2\u8272)",tag:2,type:1,sub_type:1,file:"image_map_object_normal_red_01.png",can_drop:1},20102:{id:20102,name:"\u7269\u4ef6(\u9ec4\u8272)",tag:2,type:1,sub_type:2,file:"image_map_object_normal_yellow_01.png",can_drop:1},20103:{id:20103,name:"\u7269\u4ef6(\u7eff\u8272)",tag:2,type:1,sub_type:3,file:"image_map_object_normal_green_01.png",can_drop:1},20104:{id:20104,name:"\u7269\u4ef6(\u84dd\u8272)",tag:2,type:1,sub_type:4,file:"image_map_object_normal_blue_01.png",can_drop:1},20105:{id:20105,name:"\u7269\u4ef6(\u7d2b\u8272)",tag:2,type:1,sub_type:5,file:"image_map_object_normal_purple_01.png",can_drop:1},20106:{id:20106,name:"\u7269\u4ef6(\u7c89\u7ea2)",tag:2,type:1,sub_type:6,file:"image_map_object_normal_pink_01.png",can_drop:1},20107:{id:20107,name:"\u7269\u4ef6(\u674e\u5b50)",tag:2,type:1,sub_type:7,file:"image_map_object_normal_plum_01.png",can_drop:1},20108:{id:20108,name:"\u7269\u4ef6(\u767e\u642d)",tag:2,type:1,sub_type:8,file:"image_map_object_normal_wail_01.png",can_drop:1},30100:{id:3E4,name:"\u9644\u4ef6(\u5341\u5b57\u6d88)",tag:3,type:1,sub_type:0,file:"image_map_attach_corss.png",can_drop:1},30200:{id:3E4,name:"\u9644\u4ef6(X\u6d88,\u4e00\u683c)",tag:3,type:2,sub_type:0,file:"image_map_attach_oblique.png",can_drop:1},40100:{id:4E4,name:"\u8986\u76d6(\u56fa\u5b9a)",tag:4,type:1,sub_type:0,file:"image_map_overlay_fixed.png",can_drop:0}}};core_map_config={background:"",grid:{1:{1:[2001,0,0,0,0],2:[2001,0,0,0,0],3:[2001,0,0,0,0],4:[2001,0,0,0,0],5:[2001,0,0,0,0],6:[2001,0,0,0,0]},2:{1:[1001,0,0,0,0],2:[1001,0,0,0,0],3:[1001,0,0,0,0],4:[1001,0,0,0,0],5:[1001,0,0,0,0],6:[1001,0,0,0,0]},3:{1:[1001,0,0,0,0],2:[1001,0,0,0,0],3:[1001,0,0,0,0],4:[1001,0,0,0,0],5:[1001,0,0,0,0],6:[1001,0,0,0,0]},4:{1:[1001,0,0,0,0],2:[1001,0,0,0,0],3:[1001,0,0,0,0],4:[1001,0,0,0,0],5:[1001,0,0,0,0],6:[1001,0,0,0,0]},5:{1:[1001,0,0,0,0],2:[1001,0,0,0,0],3:[1001,0,0,0,0],4:[1001,0,0,0,0],5:[1001,0,0,0,0],6:[1001,0,0,0,0]},6:{1:[1001,0,0,0,0],2:[1001,0,0,0,0],3:[1001,0,0,0,0],4:[1001,0,0,0,0],5:[1001,0,0,0,0],6:[1001,0,0,0,0]}},board:{1:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0]},2:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0]},3:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0]},4:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0]},5:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0]},6:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0]}},boundary:{1:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]},2:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]},3:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]},4:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]},5:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]},6:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]},7:{1:[0,0],2:[0,0],3:[0,0],4:[0,0],5:[0,0],6:[0,0],7:[0,0]}},effect:{1:{1:0,2:0,3:0,4:0,5:0,6:0},2:{1:0,2:0,3:0,4:0,5:0,6:0},3:{1:0,2:0,3:0,4:0,5:0,6:0},4:{1:0,2:0,3:0,4:0,5:0,6:0},5:{1:0,2:0,3:0,4:0,5:0,6:0},6:{1:0,2:0,3:0,4:0,5:0,6:0}},line:{}};drop_tplt=[[20106,20107,20107,20107,20107,20101],[20103,20105,20107,20107,20101,20107],[20107,20107,20106,20101,20103,20107],[20106,20107,20106,20107,20106,20107],[20105,20106,20106,20101,20107,20102],[20106,20107,20104,20103,20107,20107],[20105,20103,20107,20104,20103,20106],[20106,20106,20104,20104,20101,20105],[20106,20106,20104,20105,20107,20107],[20107,20104,20107,20105,20104,20106],[20106,20103,20105,20106,20106,20107],[20106,20102,20101,20106,20106,20103],[20104,20107,20107,20102,20102,20106],[20105,20104,20103,20106,20103,20104],[20107,20103,20106,20106,20103,20104],[20101,20107,20101,20106,20107,20102],[20105,20104,20101,20105,20106,20106],[20103,20105,20105,20104,20103,20105],[20105,20106,20105,20104,20102,20107],[20107,20107,20107,20107,20107,20101],[20107,20107,20107,20106,20106,20107],[20101,20107,20103,20106,20106,20107],[20102,20103,20107,20107,20103,20104],[20104,20107,20107,20105,20101,20104],[20104,20107,20101,20104,20106,20106],[20104,20101,20107,20107,20106,20104],[20103,20101,20103,20105,20107,20101],[20107,20104,20107,20107,20107,20106],[20105,20107,20106,20103,20106,20101],[20106,20103,20105,20106,20105,20107],[20104,20106,20106,20105,20107,20107],[20103,20105,20106,20107,20107,20106],[20104,20104,20104,20106,20104,20104],[20107,20106,20105,20103,20106,20104],[20102,20107,20107,20104,20105,20104],[20102,20103,20104,20104,20106,20102],[20106,20102,20104,20107,20101,20107],[20106,20102,20107,20104,20103,20102],[20107,20107,20105,20102,20107,20105],[20107,20101,20103,20106,20103,20104],[20107,20103,20106,20107,20107,20105],[20104,20105,20102,20104,20107,20104],[20104,20105,20102,20107,20105,20101],[20107,20107,20107,20107,20107,20106],[20107,20103,20103,20106,20106,20107],[20101,20106,20104,20106,20105,20105],[20107,20101,20106,20105,20101,20105],[20104,20104,20107,20105,20106,20107],[20107,20106,20102,20102,20106,20107],[20104,20106,20107,20106,20104,20104],[20101,20107,20107,20107,20104,20107],[20106,20107,20106,20104,20105,20104],[20107,20106,20106,20104,20101,20106],[20101,20102,20102,20103,20106,20106],[20107,20104,20105,20103,20105,20105],[20103,20104,20101,20107,20102,20106],[20106,20107,20103,20106,20107,20107],[20107,20106,20104,20103,20104,20107],[20104,20107,20103,20106,20105,20104],[20105,20106,20106,20105,20107,20102],[20107,20105,20107,20107,20106,20101],[20107,20107,20102,20107,20105,20107],[20104,20107,20107,20101,20104,20103],[20103,20105,20103,20106,20105,20107],[20107,20107,20106,20102,20104,20106],[20107,20107,20106,20102,20104,20101],[20104,20106,20102,20107,20103,20107],[20105,20104,20106,20105,20105,20107],[20107,20106,20105,20105,20103,20101],[20106,20107,20105,20102,20107,20105],[20106,20104,20107,20102,20106,20103],[20105,20105,20101,20107,20104,20107],[20105,20107,20104,20107,20103,20105],[20105,20101,20103,20102,20105,20107],[20103,20106,20106,20101,20105,20103],[20107,20107,20104,20103,20102,20106],[20103,20106,20104,20107,20104,20105],[20104,20105,20103,20105,20102,20105],[20102,20107,20104,20106,20102,20103],[20107,20106,20106,20104,20103,20105],[20105,20106,20105,20107,20102,20105],[20102,20102,20105,20104,20104,20105],[20106,20104,20106,20103,20106,20106],[20103,20105,20105,20104,20106,20107],[20103,20102,20107,20105,20104,20105],[20104,20105,20107,20106,20104,20107],[20102,20102,20101,20107,20103,20103],[20103,20106,20105,20106,20107,20107],[20102,20102,20106,20101,20104,20104],[20107,20104,20103,20105,20105,20104],[20103,20102,20105,20102,20107,20106],[20102,20104,20106,20103,20105,20103],[20105,20106,20104,20107,20103,20107],[20107,20102,20106,20106,20106,20103],[20106,20104,20106,20106,20103,20107],[20106,20107,20104,20107,20103,20106],[20106,20102,20107,20107,20104,20106],[20105,20102,20102,20103,20105,20106],[20106,20106,20105,20101,20107,20102],[20105,20104,20102,20104,20102,20107]];effect_tplt={1001:{type:11,value:[]},1002:{type:12,value:[]},1003:{type:13,value:[]},3001:{type:31,value:[[1,600],[2,400]]},3002:{type:32,value:[[1,600],[2,400]]},3003:{type:33,value:[]},3004:{type:34,value:[]},3005:{type:35,value:[]},3006:{type:36,value:[]},3007:{type:37,value:[[3,500],[5,300],[7,200]]}};level_tplt={1001:{name:"Kingdom 1",file:"image_map_bg_001.png",music:1001,maps:[101,102,103],rate_normal:[1,1],rate_bonus1:[1,1],rate_bonus2:[1,1],rate_bonus3:[1,1],bonus1:[[1001,300],[1002,300],[1003,400]],bonus3:[[3001,0]],next_id:1002},1002:{name:"Kingdom 2",file:"image_map_bg_002.png",music:1001,maps:[201,202,203],rate_normal:[1,1],rate_bonus1:[1,1],rate_bonus2:[1,1],rate_bonus3:[1,1],bonus1:[[1001,300],[1002,300],[1003,400]],bonus3:[[3001,200]],next_id:1003},1003:{name:"Kingdom 3",file:"image_map_bg_003.png",music:1001,maps:[301,302,303],rate_normal:[1,1],rate_bonus1:[1,1],rate_bonus2:[1,1],rate_bonus3:[1,1],bonus1:[[1001,300],[1002,300],[1003,400]],bonus3:[[3003,200]],next_id:1004},1004:{name:"Kingdom 4",file:"image_map_bg_004.png",music:1001,maps:[401,402,403],rate_normal:[1,1],rate_bonus1:[1,1],rate_bonus2:[1,1],rate_bonus3:[1,1],bonus1:[[1001,300],[1002,300],[1003,400]],bonus3:[[3004,200]],next_id:1005},1005:{name:"Kingdom 5",file:"image_map_bg_005.png",music:1001,maps:[501,502,503],rate_normal:[1,1],rate_bonus1:[1,1],rate_bonus2:[1,1],rate_bonus3:[1,1],bonus1:[[1001,300],[1002,300],[1003,400]],bonus3:[[3005,200]],next_id:1006},1006:{name:"Kingdom 6",file:"image_map_bg_006.png",music:1001,maps:[601,602,603],rate_normal:[1,1],rate_bonus1:[1,1],rate_bonus2:[1,1],rate_bonus3:[1,1],bonus1:[[1001,300],[1002,300],[1003,400]],bonus3:[[3006,200]],next_id:1007},1007:{name:"Kingdom 7",file:"image_map_bg_007.png",music:1001,maps:[701,702,703],rate_normal:[1,1],rate_bonus1:[1,1],rate_bonus2:[1,1],rate_bonus3:[1,1],bonus1:[[1001,300],[1002,300],[1003,400]],bonus3:[[3007,200]],next_id:1008},1008:{name:"Kingdom 8",file:"image_map_bg_004.png",music:1001,maps:[801,802,803],rate_normal:[1,1],rate_bonus1:[1,1],rate_bonus2:[1,1],rate_bonus3:[1,1],bonus1:[[1001,300],[1002,300],[1003,400]],bonus3:[[3001,33],[3002,0],[3003,33],[3004,33],[3005,33],[3006,33],[3007,33]],next_id:1001}};map_tplt={101:[[0,0,10100,10100,0,0],[0,10100,10100,10100,0,0],[0,0,10100,10100,0,0],[0,0,10100,10100,0,0],[0,0,10100,10100,0,0],[0,10100,10100,10100,10100,0]],102:[[0,0,10100,10100,0,0],[0,10100,0,0,10100,0],[0,0,0,10100,0,0],[0,0,10100,0,0,0],[0,10100,0,0,0,0],[0,0,10100,10100,10100,0]],103:[[0,0,10100,10100,0,0],[0,10100,0,0,10100,0],[10100,0,0,0,0,10100],[10100,0,0,0,0,10100],[0,10100,0,0,10100,0],[0,0,10100,10100,0,0]],201:[[0,10100,10100,10100,10100,0],[0,10100,0,0,0,10100],[0,10100,0,0,10100,0],[0,10100,10100,10100,0,0],[0,10100,0,0,10100,0],[0,10100,0,0,0,10100]],202:[[0,10100,0,0,10100,0],[0,10100,0,10100,0,0],[0,10100,10100,0,0,0],[0,10100,10100,0,0,0],[0,10100,0,10100,0,0],[0,10100,0,0,10100,0]],203:[[0,10100,10100,10100,10100,0],[0,10100,0,0,0,0],[0,10100,0,0,0,0],[0,10100,10100,10100,10100,0],[0,10100,0,0,0,0],[0,10100,0,0,0,0]],301:[[10100,0,10100,10100,0,10100],[10100,10100,10100,10100,10100,10100],[10100,0,10100,10100,0,10100],[10100,0,10100,10100,0,10100],[10100,10100,10100,10100,10100,10100],[10100,0,10100,10100,0,10100]],302:[[10100,0,10100,10100,0,10100],[0,10100,10100,10100,10100,0],[10100,10100,0,0,10100,10100],[0,10100,10100,10100,10100,0],[0,0,10100,10100,0,0],[10100,10100,0,0,10100,10100]],303:[[10100,0,0,0,0,10100],[10100,10100,10100,10100,10100,10100],[10100,10100,0,0,10100,10100],[10100,10100,0,0,10100,10100],[10100,10100,10100,10100,10100,10100],[10100,0,0,0,0,10100]],401:[[0,10100,0,0,10100,0],[10100,0,10100,10100,0,10100],[10100,0,0,0,0,10100],[0,10100,0,0,10100,0],[0,0,10100,10100,0,0],[10100,10100,0,0,10100,10100]],402:[[10100,0,10100,0,10100,0],[0,10100,0,10100,0,10100],[10100,0,10100,0,10100,0],[0,10100,0,10100,0,10100],[10100,0,10100,0,10100,0],[0,10100,0,10100,0,10100]],403:[[10100,10100,10100,10100,10100,10100],[10100,10100,10100,10100,10100,0],[10100,10100,10100,10100,0,0],[10100,10100,10100,0,0,10100],[10100,10100,0,0,10100,10100],[10100,0,0,10100,10100,10100]],501:[[0,0,10100,10100,0,0],[10100,10100,10100,10100,10100,10100],[10100,0,10100,10100,0,10100],[10100,10100,10100,10100,10100,10100],[0,0,10100,10100,0,0],[0,0,10100,10100,0,0]],502:[[10100,10100,10100,10100,10100,10100],[0,0,10100,10100,0,0],[10100,10100,10100,10100,10100,10100],[10100,0,10100,10100,0,10100],[10100,0,0,0,0,10100],[10100,10100,10100,10100,10100,10100]],503:[[10100,0,0,10100,10100,10100],[10100,0,0,10100,0,0],[10100,10100,10100,10100,0,0],[0,0,10100,10100,10100,10100],[0,0,10100,0,0,10100],[10100,10100,10100,0,0,10100]],601:[[10100,0,10100,10100,0,10100],[0,10100,0,0,10100,0],[10100,0,10100,10100,0,10100],[10100,0,10100,10100,0,10100],[0,10100,0,0,10100,0],[10100,0,10100,10100,0,10100]],602:[[10100,0,0,0,0,10100],[10100,10100,0,0,10100,10100],[10100,10100,10100,10100,10100,10100],[10100,10100,10100,10100,10100,10100],[10100,10100,0,0,10100,10100],[10100,0,0,0,0,10100]],603:[[0,0,10100,10100,0,0],[0,10100,10100,10100,10100,0],[0,0,10100,10100,0,0],[10100,10100,10100,10100,10100,10100],[0,0,10100,10100,0,0],[0,10100,10100,10100,10100,0]],701:[[0,0,10100,10100,0,0],[0,10100,10100,10100,10100,0],[10100,0,10100,10100,0,10100],[0,0,10100,10100,0,0],[0,0,10100,10100,0,0],[0,0,10100,10100,0,0]],702:[[10100,10100,10100,10100,10100,10100],[10100,0,0,0,0,10100],[10100,0,10100,10100,0,10100],[10100,0,10100,10100,0,10100],[10100,0,0,0,0,10100],[10100,10100,10100,10100,10100,10100]],703:[[0,0,10100,10100,0,0],[0,0,10100,10100,0,0],[10100,10100,10100,10100,10100,10100],[10100,10100,10100,10100,10100,10100],[0,0,10100,10100,0,0],[0,0,10100,10100,0,0]],801:[[10100,0,0,0,0,10100],[10100,0,10100,10100,0,10100],[10100,0,0,0,0,10100],[10100,0,10100,10100,0,10100],[10100,0,0,0,0,10100],[10100,0,10100,10100,0,10100]],802:[[10100,10100,10100,10100,10100,10100],[10100,0,10100,10100,0,10100],[10100,0,10100,10100,0,10100],[10100,0,10100,10100,0,10100],[10100,0,10100,10100,0,10100],[10100,10100,10100,10100,10100,10100]],803:[[10100,0,10100,10100,0,10100],[0,10100,10100,10100,10100,0],[10100,10100,10100,10100,10100,10100],[10100,10100,10100,10100,10100,10100],[0,10100,10100,10100,10100,0],[10100,0,10100,10100,0,10100]]};AudioModel={mIsMusicEnabled:!0,mIsSoundEnabled:!0,mCurrMusicURL:"",init:function(){var a=laya.net.LocalStorage.getItem("MusicOn"),a="string"==typeof a&&0<a.length?parseInt(a)?!0:!1:!0;this.setMusicEnabled(a);a=laya.net.LocalStorage.getItem("SoundOn");a="string"==typeof a&&0<a.length?parseInt(a)?!0:!1:!0;this.setSoundEnabled(a)},pause:function(){laya.media.SoundManager.stopMusic();laya.media.SoundManager.stopAll()},resume:function(){this.mIsMusicEnabled&&0<this.mCurrMusicURL.length&&laya.media.SoundManager.playMusic(this.mCurrMusicURL)},setMusicVolume:function(a){laya.media.SoundManager.setMusicVolume(a)},setSoundVolume:function(a){laya.media.SoundManager.setSoundVolume(a)},getMusicVolume:function(){return laya.media.SoundManager.musicVolume},getSoundVolume:function(){return laya.media.SoundManager.soundVolume},setMusicEnabled:function(a){a?0<this.mCurrMusicURL.length&&laya.media.SoundManager.playMusic(this.mCurrMusicURL):laya.media.SoundManager.stopMusic();this.mIsMusicEnabled=a?!0:!1;laya.net.LocalStorage.setItem("MusicOn",this.mIsMusicEnabled?"1":"0")},setSoundEnabled:function(a){a||laya.media.SoundManager.stopSound();this.mIsSoundEnabled=a?!0:!1;laya.net.LocalStorage.setItem("SoundOn",this.mIsSoundEnabled?"1":"0")},isMusicEnabled:function(){return this.mIsMusicEnabled},isSoundEnabled:function(){return this.mIsSoundEnabled},playMusic:function(a){this.stopMusic();this.mIsMusicEnabled&&(a=DataTB.get("audio_tplt",a,!1))&&(this.mCurrMusicURL=ResURL(a.file),laya.media.SoundManager.playMusic(this.mCurrMusicURL))},stopMusic:function(){laya.media.SoundManager.stopMusic()},playSound:function(a){this.mIsSoundEnabled&&(a=DataTB.get("audio_tplt",a,!1))&&laya.media.SoundManager.playSound(ResURL(a.file))}};DataModel={getDropData:function(){return drop_tplt},getBonus1Effect:function(a){if("number"==typeof a&&0<a)a=DataTB.get("level_tplt",a,!0);else if(!a||"object"!=typeof a||a instanceof Array)return;var b=CreateProbability(a.bonus1);if(1E3!=b.getTotalWeight())throw Error("\u5173\u5361["+a.name+"]\u4e2d\u7684bonus1\u914d\u7f6e\u51fa\u9519,\u6982\u7387\u76f8\u52a0\u4e0d\u7b49\u4e8e\u767e\u5206\u767e");a=b.getValue();if(0!=a){var b=DataTB.get("effect_tplt",a,!0),c=CreateProbability(b.value),d=c.getTotalWeight();if(0<d&&1E3!=d)throw Error("\u7279\u6548\u8868["+a+"]\u4e2d\u7684\u6982\u7387\u76f8\u52a0\u4e0d\u7b49\u4e8e\u767e\u5206\u767e");return{type:b.type,value:c.getValue()}}},getBonus3Effect:function(a){if("number"==typeof a&&0<a)a=DataTB.get("level_tplt",a,!0);else if(!a||"object"!=typeof a||a instanceof Array)return;var b=CreateProbability(a.bonus3),c=b.getTotalWeight();if(0>c||1E3<c)throw Error("\u5173\u5361["+a.name+"]\u4e2d\u7684bonus3\u914d\u7f6e\u51fa\u9519,\u6982\u7387\u76f8\u52a0\u51fa\u9519");b.setWeight(0,1E3-c);a=b.getValue();if(0!=a){var b=DataTB.get("effect_tplt",a,!0),c=CreateProbability(b.value),d=c.getTotalWeight();if(0<d&&1E3!=d)throw Error("\u7279\u6548\u8868["+a+"]\u4e2d\u7684\u6982\u7387\u76f8\u52a0\u4e0d\u7b49\u4e8e\u767e\u5206\u767e");return{type:b.type,value:c.getValue()}}},calcAwardData:function(a,b,c,d,e){a=DataTB.get("level_tplt",a,!0);b=game_section.normal==b?a.rate_normal:game_section.bonus1==b?a.rate_bonus1:game_section.bonus2==b?a.rate_bonus2:game_section.bonus3==b?a.rate_bonus3:a.rate_normal;c=c>=b.length?b.length-1:c;c=b[c];b=DataTB.get("map_element_tplt",d,!0);return{count:e,image:b.file,value:G.ELEMENT_PRICE[d]*e*c}}};DataTB={mTpltList:{},copydata:function(a){function b(a){if(void 0==a||null==a||"object"!=typeof a||a instanceof HTMLElement)return a;var d=a.constructor?new a.constructor:{},e;for(e in a)a.hasOwnProperty(e),d[e]=b(a[e]);return d}return b(a)},init:function(a){if(!a||a instanceof Array||"object"!=typeof a)throw Error("can't support tpltList type "+typeof a);this.mTpltList={};for(var b in a)a.hasOwnProperty(b)&&(this.mTpltList[b]=this.copydata(a[b]))},reload:function(a,b){if("string"!=typeof a)throw Error("can't support for fileName type "+typeof a);if("_tplt"!=a.substring(a.length-5))throw Error("data table '"+a+"' name format is error");this.mTpltList[a]=this.copydata(b)},get:function(a,b,c,d){if("string"!=typeof a)throw Error("can't support for fileName type "+typeof a);if("_tplt"!=a.substring(a.length-5))throw Error("data table '"+a+"' name format is error");var e=this.mTpltList[a];if(void 0==e||null==e)throw Error("dosen't exist data table '"+a+"'");if("string"!=typeof b&&"number"!=typeof b)throw Error("can't not support for key type "+typeof b);e=e[b];if(void 0==e||null==e){if(c)throw Error("can't find key '"+b+"' in data table '"+a+"'");}else return d?e:this.copydata(e)},filter:function(a,b,c,d){if("string"!=typeof a)throw Error("can't support for fileName type "+typeof a);if("_tplt"!=a.substring(a.length-5))throw Error("data table '"+a+"' name format is error");var e=this.mTpltList[a];if(void 0==e||null==e)throw Error("dosen't exist data table '"+a+"'");a=[];if("function"==typeof b)for(var f in e)if(e.hasOwnProperty(f)&&b(e[f]))if(c)a.push(e[f]);else return d?e[f]:this.copydata(e[f]);return c?d?a:this.copydata(a):null},getAll:function(a,b){if("string"!=typeof a)throw Error("can't support for fileName type "+typeof a);if("_tplt"!=a.substring(a.length-5))throw Error("data table '"+a+"' name format is error");var c=this.mTpltList[a];if(void 0==c||null==c)throw Error("dosen't exist data table '"+a+"'");var d=[],e;for(e in c)c.hasOwnProperty(e)&&d.push(c[e]);return b?d:this.copydata(d)}};language_type={chinese_simple:1,chinese_traditional:2,english:3};audio_type={music:1,sound:2};game_section={normal:1,bonus1:2,bonus2:3,bonus3:4};bonus_type={random_replace:11,discolor_ray:12,diagonal_discolor:13,random_all_match:31,fixed_all_match:32,position_swap:33,element_fixed:34,random_ramble:35,rainbow_clear:36,screen_clear:37};function EventDef_enum(a){for(var b={},c=0,d=a.length;c<d;++c){if(b.hasOwnProperty(a[c]))throw Error("duplicate event: "+a[c]+" in EventDef");b[a[c]]=c}return b}var EventDef="ED_RES_LOADING ED_CORE_CLEAR_SURFACE ED_CORE_CLEAR_OBJECT ED_ADD_TO_LIST ED_PROGRESS_BONUS1 ED_PROGRESS_BONUS2 ED_ON_BONUS ED_LEVEL_INFO ED_LEVEL_CLEAR ED_LEVEL_COIN ED_LEVEL_AUTO_TIMES".split(" "),EventDef=EventDef_enum(EventDef);Board=Class.extend({ctor:function(a){this.mDirect=this.mId=this.mCol=this.mRow=0;a&&(this.mNode=new laya.ui.Image,this.mNode.anchorX=.5,this.mNode.anchorY=.5)},dtor:function(){this.mNode&&!this.mNode.destroyed&&(this.mNode.removeSelf(),this.mNode.destroy(),delete this.mNode)},getCoord:function(){return{row:this.mRow,col:this.mCol}},setCoord:function(a,b){this.mRow=a;this.mCol=b},getId:function(){return this.mId},setId:function(a){this.mId=a},getDirect:function(){return this.mDirect},setDirect:function(a){this.mDirect=a},getNode:function(){return this.mNode&&!this.mNode.destroyed?this.mNode:null}});Component=Class.extend({ctor:function(a){if("string"!=typeof a)throw Error("not support for name type "+typeof a);this.is_component_type=!0;this.mName=a;this.mMaster=null;this.mChildrenInfoList=[];this.mSiblingMap={};this.mEventHandlerMap={};this.mTouchEnabled=!0;this.mTouchSwallow=!1},dtor:function(){this.mMaster=null;for(var a=0,b=this.mChildrenInfoList.length;a<b;++a)this.mChildrenInfoList[a].com.dtor();this.mChildrenInfoList=[];this.mSiblingMap={};for(var c in this.mEventHandlerMap)this.mEventHandlerMap.hasOwnProperty(c)&&EventCenter.unbind(c,this.mEventHandlerMap[c]);this.mEventHandlerMap={};this.mTouchEnabled=!0;this.mTouchSwallow=!1},getName:function(){return this.mName},getMaster:function(){return this.mMaster},addComponent:function(a,b){if(!a.is_component_type)throw Error("com must be componet type");if(a==this)throw Error("can't add self to be child");if(a.mMaster)throw Error("com has been added");if(a==this.mMaster)throw Error("can't add master to be child");for(var c=0,d=this.mChildrenInfoList.length;c<d;++c){if(a==this.mChildrenInfoList[c].com)throw Error("com has been added");this.mChildrenInfoList[c].com.addSibling(a)}a.mMaster=this;c={name:a.getName(),com:a,priority:b?b:this.mChildrenInfoList.length};this.mChildrenInfoList.push(c);this.mChildrenInfoList.sort(function(a,b){return a.priority-b.priority});return a},removeComponent:function(a){for(var b=0;b<this.mChildrenInfoList.length;++b)a==this.mChildrenInfoList[b].name&&(this.mChildrenInfoList[b].com.mMaster=null,this.mChildrenInfoList.splice(b,1)),this.mChildrenInfoList[b].com.removeSibling(a)},getComponent:function(a){for(var b=0,c=this.mChildrenInfoList.length;b<c;++b)if(a==this.mChildrenInfoList[b].name)return this.mChildrenInfoList[b].com},addSibling:function(a){if(!a.is_component_type)throw Error("com must be componet type");var b=a.getName();this.mSiblingMap[b]||(this.mSiblingMap[b]=a,a.addSibling(this))},removeSibling:function(a){var b=this.mSiblingMap[a];b&&(delete this.mSiblingMap[a],b.removeSibling(this.mName))},getSibling:function(a){var b=this.mSiblingMap[a];return b?b:this.mMaster?this.mMaster.getComponent(a):null},bind:function(a,b,c){if(this.mEventHandlerMap[a])throw Error("can't register same event "+a);this.mEventHandlerMap[a]=b;EventCenter.bind(a,this.mEventHandlerMap[a],this,c)},setTouchEnabled:function(a){this.mTouchEnabled=a},isTouchEnabled:function(){return this.mTouchEnabled},setTouchSwallow:function(a){this.mTouchSwallow=a},isTouchSwallow:function(){return this.mTouchSwallow},onTouchBegan:function(a,b){if(this.mTouchEnabled)for(var c=0,d=this.mChildrenInfoList.length;c<d&&(this.mChildrenInfoList[c].com.onTouchBegan.apply(this.mChildrenInfoList[c].com,arguments),!this.mChildrenInfoList[c].com.isTouchSwallow());++c);},onTouchMoved:function(a,b){if(this.mTouchEnabled)for(var c=0,d=this.mChildrenInfoList.length;c<d&&(this.mChildrenInfoList[c].com.onTouchMoved.apply(this.mChildrenInfoList[c].com,arguments),!this.mChildrenInfoList[c].com.isTouchSwallow());++c);},onTouchEnded:function(a,b){if(this.mTouchEnabled)for(var c=0,d=this.mChildrenInfoList.length;c<d&&(this.mChildrenInfoList[c].com.onTouchEnded.apply(this.mChildrenInfoList[c].com,arguments),!this.mChildrenInfoList[c].com.isTouchSwallow());++c);},onTouchCancelled:function(a,b){if(this.mTouchEnabled)for(var c=0,d=this.mChildrenInfoList.length;c<d&&(this.mChildrenInfoList[c].com.onTouchCancelled.apply(this.mChildrenInfoList[c].com,arguments),!this.mChildrenInfoList[c].com.isTouchSwallow());++c);},onUpdate:function(a){for(var b=0,c=this.mChildrenInfoList.length;b<c;++b)this.mChildrenInfoList[b].com.onUpdate(a)}});ComponentMap=Component.extend({ctor:function(){this._super("ComponentMap");this.mMapBackground=null;this.mMapGrid={};this.mMapBoard={};this.mMapBoundary={};this.mMapElement={};this.mIfShowDisplay=!0},init:function(a,b){for(var c=this.getMaster().getRowCol(),d=1;d<=c.row;++d){this.mMapGrid[d]={};this.mMapBoard[d]={};this.mMapElement[d]={};for(var e=1;e<=c.col;++e)this.mMapGrid[d][e]=this.createGrid(d,e),this.mMapBoard[d][e]={},this.mMapElement[d][e]={}}for(var f=1;f<=c.row+1;++f){this.mMapBoundary[d]={};for(var g=1;g<=c.col+1;++g)this.mMapBoundary[d][e]={}}!a||"object"!=typeof a||a instanceof Array||(this.setMapBackground(a.background),this.parseMapGrid(a.grid,a.line),this.parseMapBoard(a.board),this.parseMapBoundary(a.boundary));this.mIfShowDisplay=b},getRowPos:function(a){var b=this.getMaster().getRowCol(),c=this.getMaster().getPos(a,1);a=this.getMaster().getPos(a,b.col);return{x:c.x+(a.x-c.x)/2,y:c.y}},getColPos:function(a){var b=this.getMaster().getRowCol(),c=this.getMaster().getPos(1,a);a=this.getMaster().getPos(b.row,a);return{x:c.x,y:a.y+(c.y-a.y)/2}},setMapBackground:function(a){if(this.mIfShowDisplay)if("string"==typeof a&&0<a.length){if(!this.mMapBackground||this.mMapBackground.destroyed)this.mMapBackground=new laya.ui.Image,this.mMapBackground.anchorX=.5,this.mMapBackground.anchorY=.5,this.mMapBackground.pos(Laya.stage.width/2,Laya.stage.height/2),this.mMapBackground.zOrder=0,this.getMaster().getBackgroundLayer().addChild(this.mMapBackground);this.mMapBackground.skin=ResURL(a);this.mMapBackground.file=a}else this.mMapBackground&&!this.mMapBackground.destroyed&&(this.mMapBackground.removeSelf(),this.mMapBackground.destroy(),delete this.mMapBackground)},getMapBackground:function(){return this.mMapBackground},parseMapGrid:function(a,b){if(a&&"object"==typeof a&&!(a instanceof Array))for(var c in a)if(a.hasOwnProperty(c))for(var d in a[c])if(a[c].hasOwnProperty(d))for(var e=[a[c][d][1],a[c][d][2],a[c][d][3],a[c][d][4]],f=this.setGridProperty(c,d,b,a[c][d][0]),g=0,h=e.length;g<h;++g){var k=this.createElement(e[g]);k&&(k.setPosition(f.getPosition()),this.addElement(c,d,k))}},parseMapBoard:function(a){if(a&&"object"==typeof a&&!(a instanceof Array))for(var b in a)if(a.hasOwnProperty(b))for(var c in a[b])if(a[b].hasOwnProperty(c)){var d=a[b][c][1];this.addBoard(b,c,a[b][c][0]);this.addBoard(b,c,d)}},parseMapBoundary:function(a){if(a&&"object"==typeof a&&!(a instanceof Array))for(var b in a)if(a.hasOwnProperty(b))for(var c in a[b])if(a[b].hasOwnProperty(c)){var d=a[b][c][1];this.addBoundary(b,c,a[b][c][0]);this.addBoundary(b,c,d)}},createGrid:function(a,b){var c=this.getMaster().getPos(a,b),d=new Grid(this.mIfShowDisplay);d.setCoord(a,b);d.getNode()&&(d.getNode().pos(c.x,c.y),d.getNode().zOrder=2,this.getMaster().getBackgroundLayer().addChild(d.getNode()));return d},setGridProperty:function(a,b,c,d){var e,f=this.getGrid(a,b);if(isNaN(d)||0>=d)return f;e=DataTB.get("map_grid_tplt",d,!0,!0);f.setId(d);f.setName(e.name);f.setType(e.type);0<e.file.length&&f.getNode()&&(f.getNode().skin=ResURL(e.file));if(CoreDef.GridType.door_in==e.type&&c instanceof Array&&0<c.length){for(var g=null,h=0,k=c.length;h<k;++h){var l=c[h],m=l[0][0],n=l[0][1];d=l[1][0];e=l[1][1];if(a==m&&b==n){0!=d&&0!=e||console.log("door in ("+a+", "+b+") doesn't point to door out");g=l;break}}g?(d=g[1][0],e=g[1][1],f.setCoordTo(d,e)):console.log("door in ("+a+", "+b+") doesn't point to door out")}return f},delGrid:function(a,b){var c=this.mMapGrid[a][b];delete this.mMapGrid[a][b];return c},getGrid:function(a,b){if(this.mMapGrid[a])return this.mMapGrid[a][b]},addBoard:function(a,b,c){if(!(isNaN(c)||0>=c)){var d=DataTB.get("map_board_tplt",c,!0,!0);if(this.mMapBoard[a][b][d.direct])throw Error("coord ("+a+", "+b+") ["+d.direct+"] exist board");if(!(0>=d.file.length)){var e=new Board(this.mIfShowDisplay);e.setCoord(a,b);e.setId(c);e.setDirect(d.direct);if(e.getNode()){e.getNode().skin=ResURL(d.file);var f=this.getMaster().getPos(a,b);if(CoreDef.DirectType.hor==d.direct)e.getNode().pos(f.down.x,f.down.y);else if(CoreDef.DirectType.ver==d.direct)e.getNode().pos(f.right.x,f.right.y);else throw Error("can't handle board ["+c+"] direct: "+d.direct);e.getNode().zOrder=10;this.getMaster().getMapLayer().addChild(e.getNode())}return this.mMapBoard[a][b][d.direct]=e}}},delBoard:function(a,b,c){var d=this.mMapBoard[a][b][c];delete this.mMapBoard[a][b][c];return d},getBoard:function(a,b,c){return this.mMapBoard[a][b][c]},getAroundBoard:function(a,b){var c={down:this.mMapBoard[a][b][CoreDef.DirectType.hor],right:this.mMapBoard[a][b][CoreDef.DirectType.hor]};this.mMapBoard[a-1]&&(c.up=this.mMapBoard[a-1][b][CoreDef.DirectType.hor]);this.mMapBoard[a][b-1]&&(c.left=this.mMapBoard[a][b-1][CoreDef.DirectType.ver]);return c},addBoundary:function(a,b,c){if(!(isNaN(c)||0>=c)&&this.mIfShowDisplay){var d=DataTB.get("map_boundary_tplt",c,!0,!0);if(this.mMapBoundary[a][b][d.direct])throw Error("coord ("+a+", "+b+") ["+d.direct+"] exist boundary");var e,f=0,g=0,h=this.getGrid(a,b);if(CoreDef.DirectType.hor==d.direct)if(c=.5,e=0,h&&CoreDef.GridType.none!=h.getType())f=h.getNode().x,g=h.getNode().y+h.getNode().height/2;else{if(h=this.getGrid(a-1,b))c=.5,e=1,f=h.getNode().x,g=h.getNode().y-h.getNode().height/2}else if(CoreDef.DirectType.ver==d.direct)if(c=1,e=.5,h&&CoreDef.GridType.none!=h.getType())f=h.getNode().x-h.getNode().width/2,g=h.getNode().y;else{if(h=this.getGrid(a,b-1))c=0,e=.5,f=h.getNode().x+h.getNode().width/2,g=h.getNode().y}else throw Error("can't handle boundary ["+c+"] direct: "+d.direct);if(!(0>=d.file.length))return h=new laya.ui.Image(ResURL(d.file)),h.anchorX=c,h.anchorY=e,h.pos(f,g),h.zOrder=20,this.getMaster().getMapLayer().addChild(h),this.mMapBoundary[a][b][d.direct]=h}},delBoundary:function(a,b,c){var d=this.mMapBoundary[a][b][c];delete this.mMapBoundary[a][b][c];return d},getBoundary:function(a,b,c){return this.mMapBoundary[a][b][c]},createElement:function(a){var b;if("number"==typeof a&&0<a)b=a,a=DataTB.get("map_element_tplt",a,!0,!0);else{if(!a||"object"!=typeof a||a instanceof Array)return;b=a.id}var c=new Element(this.mIfShowDisplay);c.setId(b);c.setTag(a.tag);c.setType(a.type);c.setSubType(a.sub_type);0<a.file.length&&c.getNode()&&(c.getNode().skin=ResURL(a.file));c.setCanDrop(a.can_drop);c.getNode()&&(b=CoreDef.ElementTag.surface==a.tag?30:33,c.getNode().zOrder=b+a.tag,this.getMaster().getMapLayer().addChild(c.getNode()));return c},addElement:function(a,b,c){if(c){var d=c.getTag();if(this.mMapElement[a][b][d])throw Error("coord ("+a+", "+b+") exist tag: "+d);this.mMapElement[a][b][d]=c}},delElement:function(a,b,c){var d=this.mMapElement[a][b][c];delete this.mMapElement[a][b][c];return d},getElement:function(a,b,c){return this.mMapElement[a][b][c]},clearElementTb:function(a,b){var c={},d;for(d in this.mMapElement[a][b])this.mMapElement[a][b].hasOwnProperty(d)&&(c[d]=this.mMapElement[a][b][d]);this.mMapElement[a][b]={};return c},getElementTb:function(a,b){var c={},d;for(d in this.mMapElement[a][b])this.mMapElement[a][b].hasOwnProperty(d)&&(c[d]=this.mMapElement[a][b][d]);return c},isCanContact:function(a,b,c,d){if(!this.getMaster().isCoordValid(a,b)||!this.getMaster().isCoordValid(c,d)||1<Math.abs(a-c)||1<Math.abs(b-d))return!1;var e=this.getAroundBoard(a,b),f=this.getAroundBoard(c,d);return a==c&&b>d?e.left?!1:!0:a==c&&b<d?e.right?!1:!0:a>c&&b==d?e.up?!1:!0:a<c&&b==d?e.down?!1:!0:a>c&&b>d?!(e.up&&e.left||f.right&&f.down||e.up&&f.down||f.right&&e.left||e.up&&CoreDef.GridType.none==this.getGrid(a,d).getType()||f.right&&CoreDef.GridType.none==this.getGrid(a,d).getType()||e.left&&CoreDef.GridType.none==this.getGrid(c,b).getType()||f.down&&CoreDef.GridType.none==this.getGrid(c,b).getType()):a>c&&b<d?!(e.up&&e.right||f.left&&f.down||e.up&&f.down||f.left&&e.right||e.up&&CoreDef.GridType.none==this.getGrid(a,d).getType()||f.left&&CoreDef.GridType.none==this.getGrid(a,d).getType()||e.right&&CoreDef.GridType.none==this.getGrid(c,b).getType()||f.down&&CoreDef.GridType.none==this.getGrid(c,b).getType()):a<c&&b>d?!(e.left&&e.down||f.up&&f.right||e.left&&f.right||f.up&&e.down||e.down&&CoreDef.GridType.none==this.getGrid(a,d).getType()||f.right&&CoreDef.GridType.none==this.getGrid(a,d).getType()||e.left&&CoreDef.GridType.none==this.getGrid(c,b).getType()||f.up&&CoreDef.GridType.none==this.getGrid(c,b).getType()):a<c&&b<d?!(e.right&&e.down||f.up&&f.left||e.right&&f.left||f.up&&e.down||e.down&&CoreDef.GridType.none==this.getGrid(a,d).getType()||f.left&&CoreDef.GridType.none==this.getGrid(a,d).getType()||e.right&&CoreDef.GridType.none==this.getGrid(c,b).getType()||f.up&&CoreDef.GridType.none==this.getGrid(c,b).getType()):!1},showTips:function(a,b,c){for(var d in this.mMapGrid)if(this.mMapGrid.hasOwnProperty(d))for(var e in this.mMapGrid[d])if(this.mMapGrid[d].hasOwnProperty(e)){var f=this.mMapGrid[d][e];f.showBackground(a);f.showNumber(b);f.showName(c)}}});ComponentView=Component.extend({ctor:function(){this._super("ComponentView");this.mGridTouchGap=this.mGridGap=this.mGridHeight=this.mGridWidth=this.mColCount=this.mRowCount=0;this.mTouchArea={x:0,y:0,width:0,height:0};this.mPosMap={};this.mTouchFlag=0;this.mTouchAreaTips=this.mSceneLayer=this.mMapLayer=this.mBackgroundLayer=this.mTouchLayer=null;this.mLineTipsList=[]},calcMapSize:function(a,b,c,d,e){if(isNaN(a))throw Error("row count is not number");if(isNaN(b))throw Error("col count is not number");if(isNaN(c))throw Error("grid width is not number");if(isNaN(d))throw Error("grid height is not number");if(isNaN(e))throw Error("grid gap is not number");return{width:b*(c+e)+e,height:a*(d+e)+e}},init:function(a,b,c,d,e,f,g,h){if(isNaN(a))throw Error("row count is not number");if(isNaN(b))throw Error("col count is not number");if(isNaN(c))throw Error("grid width is not number");if(isNaN(d))throw Error("grid height is not number");if(isNaN(e))throw Error("grid gap is not number");if(isNaN(f))throw Error("grid touch gap is not number");if(isNaN(g))throw Error("offset x is not number");if(isNaN(h))throw Error("offset y is not number");this.mRowCount=a;this.mColCount=b;this.mGridWidth=c;this.mGridHeight=d;this.mGridGap=e;this.mGridTouchGap=f;this.mTouchArea=this.calcMapSize(a,b,c,d,e);this.mTouchArea.x=g;this.mTouchArea.y=h;this.mPosMap=this.createPosMap(a,b,c,d,e,g,h);this.mTouchLayer=this.createTouchLayer(function(a){this.onEvent(a);return!0},this);this.mBackgroundLayer=new laya.ui.View;this.mBackgroundLayer.cacheAs="bitmap";this.mBackgroundLayer.size(Laya.stage.width,Laya.stage.height);this.mBackgroundLayer.anchorX=.5;this.mBackgroundLayer.anchorY=.5;this.mBackgroundLayer.pos(Laya.stage.width/2,Laya.stage.height/2);this.mBackgroundLayer.mouseEnabled=!0;this.mBackgroundLayer.mouseThrough=!0;this.mBackgroundLayer.zOrder=1;this.mTouchLayer.addChild(this.mBackgroundLayer);this.mMapLayer=new laya.ui.View;this.mMapLayer.size(Laya.stage.width,Laya.stage.height);this.mMapLayer.anchorX=.5;this.mMapLayer.anchorY=.5;this.mMapLayer.pos(Laya.stage.width/2,Laya.stage.height/2);this.mMapLayer.mouseEnabled=!0;this.mMapLayer.mouseThrough=!0;this.mMapLayer.zOrder=2;this.mTouchLayer.addChild(this.mMapLayer);this.mSceneLayer=new laya.ui.View;this.mSceneLayer.size(Laya.stage.width,Laya.stage.height);this.mSceneLayer.anchorX=.5;this.mSceneLayer.anchorY=.5;this.mSceneLayer.pos(Laya.stage.width/2,Laya.stage.height/2);this.mSceneLayer.mouseEnabled=!0;this.mSceneLayer.mouseThrough=!0;this.mSceneLayer.zOrder=3;this.mTouchLayer.addChild(this.mSceneLayer,3)},createPosMap:function(a,b,c,d,e,f,g){for(var h={},k=1;k<=a;++k){h[k]={};for(var l=1;l<=b;++l){var m=l*e+(l-1)*c+c/2+f,n=k*e+(k-1)*d+d/2+g;h[k][l]={x:m,y:n,up:{x:m,y:n-d/2-e/2},right:{x:m+c/2+e/2,y:n},down:{x:m,y:n+d/2+e/2},left:{x:m-c/2-e/2,y:n}}}}return h},calcGridCoord:function(a,b,c,d,e,f,g,h){if(0>g||g>b*(c+e)+e||0>h||h>a*(d+e)+e)return{row:0,col:0};var k=Math.ceil(h/(d+e));0==k?k=1:k>a&&(k=a);if(h<k*e+(k-1)*d+f||h>k*e+k*d-f)k=0;a=Math.ceil(g/(c+e));0==a?a=1:a>b&&(a=b);if(g<a*e+(a-1)*c+f||g>a*e+a*c-f)a=0;return{row:k,col:a}},getCoordPos:function(a,b,c,d,e,f,g,h,k,l){if(k<g.x||k>g.x+g.width||l<g.y||l>g.y+g.height)return null;k-=g.x;l-=g.y;a=this.calcGridCoord(a,b,c,d,e,f,k,l);if(0==a.row||0==a.col)return null;b=this.mPosMap[a.row][a.col];return{row:a.row,col:a.col,pos:{x:b.x,y:b.y,up:{x:b.up.x,y:b.up.y},right:{x:b.right.x,y:b.right.y},down:{x:b.down.x,y:b.down.y},left:{x:b.left.x,y:b.left.y}}}},createTouchLayer:function(a,b){function c(c){"function"==typeof a&&c&&a.apply(b,[c])}var d=new laya.ui.View;d.size(Laya.stage.width,Laya.stage.height);d.anchorX=.5;d.anchorY=.5;d.pos(Laya.stage.width/2,Laya.stage.height/2);d.mouseEnabled=!0;d.mouseThrough=!1;d.on(laya.events.Event.ADDED,this,c);d.on(laya.events.Event.CLICK,this,c);d.on(laya.events.Event.DISPLAY,this,c);d.on(laya.events.Event.DRAG_END,this,c);d.on(laya.events.Event.DRAG_MOVE,this,c);d.on(laya.events.Event.DRAG_START,this,c);d.on(laya.events.Event.MOUSE_DOWN,this,c);d.on(laya.events.Event.MOUSE_MOVE,this,c);d.on(laya.events.Event.MOUSE_OUT,this,c);d.on(laya.events.Event.MOUSE_OVER,this,c);d.on(laya.events.Event.MOUSE_UP,this,c);d.on(laya.events.Event.REMOVED,this,c);d.on(laya.events.Event.UNDISPLAY,this,c);return d},onEvent:function(a){if(this.isTouchEnabled()){var b=this.getCoordPos(this.mRowCount,this.mColCount,this.mGridWidth,this.mGridHeight,this.mGridGap,this.mGridTouchGap,this.mTouchArea,this.mPosMap,a.target.mouseX,a.target.mouseY);if(laya.events.Event.MOUSE_DOWN==a.type)0>=this.mTouchFlag&&(this.mTouchFlag=1,this.onTouchBegan(a,b));else if(laya.events.Event.MOUSE_MOVE==a.type){if(0<this.mTouchFlag)this.onTouchMoved(a,b)}else if(laya.events.Event.MOUSE_UP==a.type||laya.events.Event.MOUSE_OUT==a.type)if(this.mTouchFlag--,0==this.mTouchFlag)this.onTouchEnded(a,b)}},isCoordValid:function(a,b){return 1<=a&&a<=this.mRowCount&&1<=b&&b<=this.mColCount},getRowCol:function(){return{row:this.mRowCount,col:this.mColCount}},getGridSize:function(){return{width:this.mGridWidth,height:this.mGridHeight}},getGridGap:function(){return this.mGridGap},getTouchArea:function(){return{x:this.mTouchArea.x,y:this.mTouchArea.y,width:this.mTouchArea.width,height:this.mTouchArea.height}},getPos:function(a,b){if(this.mPosMap[a]&&this.mPosMap[a][b]){var c=this.mPosMap[a][b];return{x:c.x,y:c.y,up:{x:c.up.x,y:c.up.y},right:{x:c.right.x,y:c.right.y},down:{x:c.down.x,y:c.down.y},left:{x:c.left.x,y:c.left.y}}}},getCoord:function(a,b){var c=this.getCoordPos(this.mRowCount,this.mColCount,this.mGridWidth,this.mGridHeight,this.mGridGap,this.mGridTouchGap,this.mTouchArea,this.mPosMap,a,b);if(c)return{row:c.row,col:c.col}},getTouchFlag:function(){return this.mTouchFlag},getRoot:function(){return this.mTouchLayer&&!this.mTouchLayer.destroyed?this.mTouchLayer:null},getBackgroundLayer:function(){return this.mBackgroundLayer&&!this.mBackgroundLayer.destroyed?this.mBackgroundLayer:null},getMapLayer:function(){return this.mMapLayer&&!this.mMapLayer.destroyed?this.mMapLayer:null},getSceneLayer:function(){return this.mSceneLayer&&!this.mSceneLayer.destroyed?this.mSceneLayer:null},showTips:function(a,b){a?this.mTouchAreaTips||(this.mTouchAreaTips=new laya.display.Sprite,this.mTouchAreaTips.graphics.drawRect(this.mTouchArea.x,this.mTouchArea.y,this.mTouchArea.width,this.mTouchArea.height,"#808080"),this.mTouchAreaTips.alpha=200/255,this.mTouchAreaTips.zOrder=1,this.mBackgroundLayer.addChild(this.mTouchAreaTips)):this.mTouchAreaTips&&!this.mTouchAreaTips.destroyed&&(this.mTouchAreaTips.removeSelf(),this.mTouchAreaTips.destroy(),delete this.mTouchAreaTips);this.createLineFunc=function(a,b,c){var d=new laya.display.Sprite;1==a?d.graphics.drawLine(b-this.mTouchArea.width/2,c,b+this.mTouchArea.width/2,c,"#000000",1):d.graphics.drawLine(b,c-this.mTouchArea.height/2,b,c+this.mTouchArea.height/2,"#000000",1);d.zOrder=3;this.mBackgroundLayer.addChild(d);return d};if(b){if(!(this.mLineTipsList instanceof Array)||0==this.mLineTipsList.length){this.mLineTipsList=[];for(var c=1;c<=this.mRowCount+1;++c){var d=this.mTouchArea.x+this.mTouchArea.width/2;c==this.mRowCount+1?this.mLineTipsList.push(this.createLineFunc(1,d,this.getPos(c-1,1).up.y)):this.mLineTipsList.push(this.createLineFunc(1,d,this.getPos(c,1).down.y))}for(c=1;c<=this.mColCount+1;++c)d=this.mTouchArea.y+this.mTouchArea.height/2,c==this.mColCount+1?this.mLineTipsList.push(this.createLineFunc(2,this.getPos(1,c-1).right.x,d)):this.mLineTipsList.push(this.createLineFunc(2,this.getPos(1,c).left.x,d))}}else if(this.mLineTipsList instanceof Array){c=0;for(d=this.mLineTipsList.length;c<d;++c){var e=this.mLineTipsList[c];e&&!e.destroyed&&(this.mLineTipsList[c].removeSelf(),this.mLineTipsList[c].destroy())}this.mLineTipsList=[]}}});Controller={createView:function(a,b){var c=new ComponentView,d=c.calcMapSize(G.MAP_ROW,G.MAP_COL,G.GRID_WIDTH,G.GRID_HEIGHT,a);c.init(G.MAP_ROW,G.MAP_COL,G.GRID_WIDTH,G.GRID_HEIGHT,a,b,(G.DESIGN_WIDTH-d.width)/2+G.VIEW_OFFSET_X,Laya.stage.height/2+G.VIEW_OFFSET_Y);Game.NODE_SCENE.addChild(c.getRoot());return c},create:function(a){this.destroy();this.mView=this.createView(G.GRID_GAP,G.GRID_TOUCH_GAP);this.mView.setTouchEnabled(!0);this.mView.showTips(!1,!1);var b=this.mView.addComponent(new ComponentMap);b.init(core_map_config,a);b.showTips(!1,!1,!1);this.mView.addComponent(new ControllerDrop).init();this.mView.addComponent(new ControllerClear).init();this.mView.addComponent(new ControllerMinimap).init();this.mView.addComponent(new ControllerGain).init(a);this.mShowDisplay=a;this.mLevelId=G.FIRST_LEVEL_ID;this.mStar=1},destroy:function(){this.mView&&(this.mView.dtor(),this.mView.getRoot().removeSelf(),this.mView.getRoot().destroy(),delete this.mView)},getView:function(){return this.mView},getComp:function(a){if(this.mView)return this.mView.getComponent(a)},clearSurface:function(){Action.clearImageList();for(var a=this.getComp("ComponentMap"),b=this.mView.getRowCol(),c=1;c<=b.row;++c)for(var d=1;d<=b.col;++d){var e=a.delElement(c,d,CoreDef.ElementTag.surface);e&&e.dtor()}},clearObject:function(a,b){a="function"==typeof a?a:function(){};for(var c=this.getComp("ComponentMap"),d=this.mView.getRowCol(),e=d.row*d.col,f=1;f<=d.row;++f)for(var g=1;g<=d.col;++g){var h=this.mView.getPos(f,g),k=c.delElement(f,g,CoreDef.ElementTag.object),l=c.delElement(f,g,CoreDef.ElementTag.attach),m=c.delElement(f,g,CoreDef.ElementTag.overlay);m&&m.dtor();Action.playElementScreenOut(l,{row:f,col:g},h,null,this);Action.playElementScreenOut(k,{row:f,col:g},h,function(){0>=--e&&"function"==typeof a&&a.apply(b,[])},this)}},checkMapAndLevel:function(){if(this.getComp("ControllerClear").isExistSurface())return 0;this.mLevelId=isNaN(this.mLevelId)?G.FIRST_LEVEL_ID:this.mLevelId;this.mStar=isNaN(this.mStar)?1:this.mStar;this.mStar+=1;if(this.mStar<=G.MAX_STAR)return 1;var a=DataTB.get("level_tplt",this.mLevelId,!0);this.mLevelId=isNaN(a.next_id)||0>=a.next_id?G.FIRST_LEVEL_ID:a.next_id;this.mStar=1;this.mLevelChange=!0;return 2},onLevel:function(a,b,c,d){c="function"==typeof c?c:function(){};this.mLevelId=isNaN(this.mLevelId)?G.FIRST_LEVEL_ID:this.mLevelId;this.mStar=isNaN(this.mStar)?1:this.mStar;var e=DataTB.get("level_tplt",this.mLevelId,!0);EventCenter.post(EventDef.ED_LEVEL_INFO,e.name,this.mStar,this.mLevelId);var f=DataTB.get("map_tplt",e.maps[this.mStar-1],!0);this.getComp("ControllerDrop").setDropData(DataModel.getDropData(),1);this.getComp("ControllerGain").resetGain();this.getComp("ControllerClear").resetShowSkills();if(a){a=this.getComp("ComponentMap");if(this.mLevelChange=isNaN(this.mLevelChange)?!0:this.mLevelChange)this.mLevelChange=!1,a.setMapBackground(e.file),AudioModel.playMusic(e.music);this.clearSurface();for(e=0;e<G.MAP_ROW;++e)for(var g=0;g<G.MAP_COL;++g){var h=a.createElement(f[e][g]);if(h){var k=this.mView.getPos(e+1,g+1);h.getNode()&&h.getNode().pos(k.x,k.y);a.addElement(e+1,g+1,h)}}this.getComp("ControllerMinimap").resetByMapData(f)}b?this.clearObject(c,d):c.apply(d,[])},onDrop:function(a,b,c,d,e){a=isNaN(a)?0:a;b=isNaN(b)?0:b;c="function"==typeof c?c:function(){};d="function"==typeof d?d:function(){};this.getComp("ControllerDrop").startDrop(b,function(f){f?laya.callAfter(this.mShowDisplay?.3:0,function(){this.getComp("ControllerClear").startClear(function(f){a+=f;if(0<f)if(b+=1,c.apply(e,[b]),this.getComp("ControllerGain").updateGain(b),b>=G.MAX_TIMES)this.mShowDisplay&&UIPrompt.show("\u592a\u591a\u6b21\u5237\u5c4f,\u8bf7\u68c0\u67e5\u6389\u843d\u6570\u636e\u8868"),d.apply(e,[a,b]);else this.onDrop(a,b,c,d,e);else d.apply(e,[a,b])},this)},this):d.apply(e,[a,b])},this)},onGain:function(a,b,c,d,e,f){this.mShowDisplay&&console.log("\u6d88\u9664\u4e2a\u6570: "+a+", \u5237\u5c4f\u6b21\u6570: "+b);a=isNaN(a)?0:a;b=isNaN(b)?0:b;e="function"==typeof e?e:function(){};this.getComp("ControllerGain").triggerBonus(a,b,c,d,function(g,h){b=a=0;h?e.apply(f,[]):game_section.bonus2==g?(this.getComp("ControllerDrop").setDropData(DataModel.getDropData(),1),this.onDrop(a,b,null,function(){this.onGain(a,b,c,d,e,f)},this)):laya.callAfter(this.mShowDisplay?.5:0,function(){this.getComp("ControllerClear").startClear(function(g){a+=g;if(0<g)b+=1,this.getComp("ControllerGain").updateGain(b),this.onDrop(a,b,null,function(){this.onGain(a,b,c,d,e,f)},this);else this.onGain(a,b,c,d,e,f)},this)},this)},this)},onStart:function(a,b,c,d,e,f){a=isNaN(a)?1:a;b="function"==typeof b?b:function(a){a()};c="function"==typeof c?c:function(a){a()};d="function"==typeof d?d:function(){};e="function"==typeof e?e:function(){};this.mStartCount=a-1;EventCenter.post(EventDef.ED_LEVEL_AUTO_TIMES,this.mStartCount);EventCenter.post(EventDef.ED_LEVEL_COIN,1);if(0>this.mStartCount)e.apply(f,[]);else{EventCenter.post(EventDef.ED_LEVEL_COIN,2);EventCenter.post(EventDef.ED_LEVEL_CLEAR);this.mLevelId=isNaN(this.mLevelId)?G.FIRST_LEVEL_ID:this.mLevelId;var g=DataModel.getBonus1Effect(this.mLevelId),h=DataModel.getBonus3Effect(this.mLevelId);this.mShowDisplay&&console.log("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d \u5f00\u59cb");this.onLevel(!1,!0,function(){this.onDrop(0,0,function(a){EventCenter.post(EventDef.ED_PROGRESS_BONUS2,a)},function(a,l){this.onGain(a,l,g,h,function(){var a=this.checkMapAndLevel();this.mShowDisplay&&console.log("\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d\x3d \u7ed3\u675f"+(0==a?"":1==a?": \u5730\u56fe\u5347\u7ea7":": \u8fc7\u5173"));d.apply(f,[]);if(1==a){if(this.mShowDisplay){AudioModel.playSound(2004);b.apply(f,[function(){this.onLevel(!0,!1);this.onStart(this.mStartCount,b,c,d,e,f)}.bind(this)]);return}this.onLevel(!0,!1)}else if(2==a){if(this.mShowDisplay){AudioModel.playSound(2003);c.apply(f,[function(){this.onLevel(!0,!1);if(1<this.mLevelId%1E3)UILevelDes.openFront(!0,!0,!0,[this.mLevelId%1E3,this.mStartCount]);else this.onStart(this.mStartCount,b,c,d,e,f)}.bind(this)]);return}this.onLevel(!0,!1)}this.onStart(this.mStartCount,b,c,d,e,f)},this)},this)},this)}},onStop:function(){this.mStartCount=0},isShowDisplay:function(){return this.mShowDisplay},getLevelId:function(){return this.mLevelId=isNaN(this.mLevelId)?G.FIRST_LEVEL_ID:this.mLevelId},getStar:function(){return this.mStar=isNaN(this.mStar)?1:this.mStar},onInitDrop:function(a,b){a="function"==typeof a?a:function(){};this.getComp("ControllerDrop").setDropData([[20101,20102,20103,20104,20105,20106],[20101,20102,20103,20104,20105,20106],[20102,20103,20104,20105,20106,20107],[20102,20103,20104,20105,20106,20107],[20103,20104,20105,20106,20107,20101],[20103,20104,20105,20106,20107,20101]],4);this.getComp("ControllerDrop").startDrop(0,function(c){a.apply(b,[])},this)},getCenterPos:function(){var a=this.mView.getPos(3,3);return{x:a.x+30,y:a.y+30}}};ControllerClear=Component.extend({ctor:function(){this._super("ControllerClear");this.mClearBoundary=[];this.mShowSkills=[]},init:function(){this.mMap=this.getSibling("ComponentMap")},resetShowSkills:function(){this.mShowSkills=[]},generateSkill:function(a,b,c,d){var e=this.getMaster().getPos(c,d);a=this.mMap.createElement(a);a.getNode()&&a.getNode().pos(e.x,e.y);a.is_old=!0;this.mMap.addElement(c,d,a);a=this.mMap.createElement(b);if(a.getNode()){var f=null;30100==b?(f=laya.createArmature(ResURL("shizixiaozhuangtai.png"),ResURL("shizixiaozhuangtai.sk"),!1,null,null,null,null),f.play("skill_cross_state",!0)):30200==b&&(f=laya.createArmature(ResURL("xzixiao.png"),ResURL("xzixiao.sk"),!1,null,null,null,null),f.play("skill_x_state",!0));f&&a.setNode(f);a.getNode().pos(e.x,e.y)}a.is_old=!0;this.mMap.addElement(c,d,a)},checkSkillGenerate:function(a){var b;if(G.SKILL_OBLIQUE_COUNT==a.length)b=30200;else if(a.length>=G.SKILL_CROSS_COUNT)b=30100;else return;if(game_section.bonus2!=this.getSibling("ControllerGain").getGameSection()){for(var c=0;c<this.mShowSkills.length;++c)if(b==this.mShowSkills[c])return;for(var d=[],c=0,e=a.length;c<e;++c){var f=a[c],g=this.mMap.getElement(f.row,f.col,CoreDef.ElementTag.object),h=this.mMap.getElement(f.row,f.col,CoreDef.ElementTag.attach),k=this.mMap.getElement(f.row,f.col,CoreDef.ElementTag.overlay);CoreDef.ObjectType.normal!=g.getType()||CoreDef.BaseType.wail==g.getSubType()||h||k||d.push(f)}if(a=d[Math.floor(Math.random()*(d.length-1)+.5)])return{skill_id:b,row:a.row,col:a.col}}},checkSkillClear:function(a,b,c){function d(a){if(this.getMaster().isCoordValid(a.row,a.col)&&!(0<=CA.getCoordIndex(b,a))){CA.addCoord(b,a);var d=this.mMap.getElement(a.row,a.col,CoreDef.ElementTag.object);d&&(CoreDef.BaseType.wail==d.getSubType()?c.push({coord:a,object_ids:[],clear_type:2}):c.push({coord:a,object_ids:[d.getId()],clear_type:2}),this.checkSkillClear(a,b,c))}}var e=this.mMap.getElement(a.row,a.col,CoreDef.ElementTag.attach);if(e)if(CoreDef.AttachType.cross==e.getType()){a=CA.getCrossRange(a.row,a.col,G.MAP_ROW);for(var e=0,f=a.length;e<f;++e)d.apply(this,[a[e]])}else if(CoreDef.AttachType.oblique==e.getType())for(a=CA.getObliqueRange(a.row,a.col,1),e=0,f=a.length;e<f;++e)d.apply(this,[a[e]])},searchList:function(){for(var a=[],b=[],c=this.getMaster().getRowCol(),d=c.row;1<=d;--d)for(var e=1;e<=c.col;++e){var f=this.mMap.getElement(d,e,CoreDef.ElementTag.object);if(f&&CoreDef.ObjectType.normal==f.getType()&&!(0<=CA.getCoordIndex(b,CA.makeCoord(d,e)))&&CoreDef.BaseType.wail!=f.getSubType()){for(var g=0,f=CA.searchConnectList(d,e,function(a,b,c,d){if(this.getMaster().isCoordValid(a,b)&&this.getMaster().isCoordValid(c,d)&&(a==c-1&&b==d||a==c&&b==d-1||a==c+1&&b==d||a==c&&b==d+1)&&(a=this.mMap.getElement(a,b,CoreDef.ElementTag.object),c=this.mMap.getElement(c,d,CoreDef.ElementTag.object),a&&CoreDef.ObjectType.normal==a.getType()&&c&&CoreDef.ObjectType.normal==c.getType()))return 0==g&&(CoreDef.BaseType.wail!=a.getSubType()?g=a.getSubType():CoreDef.BaseType.wail!=c.getSubType()&&(g=c.getSubType())),a.getSubType()==c.getSubType()?!0:CoreDef.BaseType.wail==a.getSubType()?g==c.getSubType():CoreDef.BaseType.wail==c.getSubType()?g==a.getSubType():!1},this),h=0,k=f.length;h<k;++h)CA.addCoord(b,f[h]);f.length>=G.CLEAR_COUNT&&a.push(f)}}return a},searchClearInfo:function(a,b){for(var c=[],d=[],e=[],f=0,g=a.length;f<g;++f){for(var h=a[f],k=h[0],k=this.mMap.getElement(k.row,k.col,CoreDef.ElementTag.object).getId(),l=0,m=h.length;l<m;++l){var n=h[l],p=this.mMap.getElement(n.row,n.col,CoreDef.ElementTag.object),r=p.getId(),q=CA.getCoordIndex(c,n);0<=q?CoreDef.BaseType.wail==p.getSubType()&&b&&d[q].object_ids.push(k):(CA.addCoord(c,n),CoreDef.BaseType.wail==p.getSubType()?b?d.push({coord:n,object_ids:[k],clear_type:1}):d.push({coord:n,object_ids:[],clear_type:2}):d.push({coord:n,object_ids:[r],clear_type:b?1:2}))}(h=this.checkSkillGenerate(h))&&e.push(h)}f=0;for(g=a.length;f<g;++f)for(l=0,m=a[f].length;l<m;++l)this.checkSkillClear(a[f][l],c,d);return{clear_list:d,skill_list:e}},clearElement:function(a,b,c,d){function e(){0>=--x&&c.apply(d,[])}var f=this.getMaster().getPos(a.coord.row,a.coord.col),g=this.mMap.delElement(a.coord.row,a.coord.col,CoreDef.ElementTag.surface),h=this.mMap.getElement(a.coord.row,a.coord.col,CoreDef.ElementTag.object),k=this.mMap.getElement(a.coord.row,a.coord.col,CoreDef.ElementTag.attach),l=this.mMap.getElement(a.coord.row,a.coord.col,CoreDef.ElementTag.overlay);l||(h=this.mMap.delElement(a.coord.row,a.coord.col,CoreDef.ElementTag.object),k=this.mMap.delElement(a.coord.row,a.coord.col,CoreDef.ElementTag.attach));for(var m=g?g.getId():0,n=a.object_ids,p=0,r=a.clear_type,q=0,v=b.length;q<v;++q){var w=b[q];if(a.coord.row==w.row&&a.coord.col==w.col){p=w.skill_id;b.splice(q,1);break}}var x=3;Action.playSurfaceClear(g,f,function(){e()},this);l?(e(),e()):Action.playClearEffect(h,a.clear_type,function(){Action.playAttachClear(k,a.coord,f,function(){k&&CoreDef.AttachType.cross==k.getType()?this.mShowSkills.push(30100):k&&CoreDef.AttachType.oblique==k.getType()&&this.mShowSkills.push(30200);e()},this);Action.playObjectClear(h,f,r,function(){0<p&&0<n.length&&this.generateSkill(n[0],p,a.coord.row,a.coord.col);e()},this)},this);0<m&&EventCenter.post(EventDef.ED_CORE_CLEAR_SURFACE,m,a.coord.row,a.coord.col);b=0;for(g=n.length;b<g;++b)EventCenter.post(EventDef.ED_CORE_CLEAR_OBJECT,n[b],a.coord.row,a.coord.col)},isExistSurface:function(){for(var a=this.getMaster().getRowCol(),b=1;b<=a.row;++b)for(var c=1;c<=a.col;++c)if(this.mMap.getElement(b,c,CoreDef.ElementTag.surface))return!0;return!1},startClear:function(a,b){var c=this.searchList();this.getSibling("ControllerGain").resetTimesGain();if(0==c.length)a.apply(b,[0]);else{for(var d=this.searchClearInfo(c,!0),e=d.clear_list.length,f=0,g=d.clear_list.length;f<g;++f)this.clearElement(d.clear_list[f],d.skill_list,function(){0>=--e&&a.apply(b,[d.clear_list.length])},this);if(Controller.isShowDisplay()){for(var h=0,f=c.length;h<f;++h)this.createClearBoundary(c[h]),laya.callAfter(.25*h,function(){AudioModel.playSound(4001+h)});laya.callAfter(.6,function(){AudioModel.playSound(3002);this.deleteClearBoundary()},this)}}},startClearEx:function(a,b,c){if(0==a.length)b.apply(c,[]);else{this.getSibling("ControllerGain").resetTimesGain();var d=this.searchClearInfo([a],!1),e=d.clear_list.length;AudioModel.playSound(3002);a=0;for(var f=d.clear_list.length;a<f;++a)this.clearElement(d.clear_list[a],d.skill_list,function(){0>=--e&&b.apply(c,[d.clear_list.length])},this)}},createClearBoundary:function(a){this.createHorBoundary(a);this.createVerBoundary(a);this.createCornerBoundary(a)},showHorBoundary:function(a,b,c){for(var d=b-1,e=!1,f=!1,g=0,h=a.length;g<h;++g){var k=a[g].row,l=a[g].col;k==d&&c==l&&(e=!0);k==b&&l==c&&(f=!0)}return e&&f?!1:e||f?!0:!1},createHorBoundary:function(a){for(var b=1;7>=b;++b)for(var c=1;6>=c;++c)if(this.showHorBoundary(a,b,c)){var d=this.getMaster().getPos(6<b?6:b,c),e=new Laya.Image(ResURL("image_map_boundary_01.png"));e.anchorX=.5;e.width=49;e.anchorY=1;e.pos(d.x,d.y-G.GRID_HEIGHT/2+6);7==b&&e.pos(d.x,d.y+G.GRID_HEIGHT/2+6);e.zOrder=50;Controller.getView().getSceneLayer().addChild(e);this.mClearBoundary.push(e)}},showVerBoundary:function(a,b,c){for(var d=c-1,e=!1,f=!1,g=0,h=a.length;g<h;++g){var k=a[g].row,l=a[g].col;l==d&&k==b&&(e=!0);l==c&&k==b&&(f=!0)}return e&&f?!1:e||f?!0:!1},createVerBoundary:function(a){for(var b=1;6>=b;++b)for(var c=1;7>=c;++c)if(this.showVerBoundary(a,b,c)){var d=this.getMaster().getPos(b,6<c?6:c),e=new Laya.Image(ResURL("image_map_boundary_01.png"));e.anchorX=.5;e.rotation=90;e.anchorY=1;e.width=49;e.pos(d.x-G.GRID_HEIGHT/2-5,d.y);7==c&&e.pos(d.x+G.GRID_HEIGHT/2-5,d.y);e.zOrder=50;Controller.getView().getSceneLayer().addChild(e);this.mClearBoundary.push(e)}},calCornerType:function(a,b,c){for(var d=!1,e=!1,f=!1,g=!1,h=0,k=a.length;h<k;++h){var l=a[h].row,m=a[h].col;b==l&&c==m&&(g=!0);1==b&&1<m&&c-1==m&&1==l&&g&&(f=!0);1==m&&c==m&&1<l&&b-1==l&&g&&(e=!0);1<b&&b-1==l&&c==m&&(e=!0);1<b&&1<c&&b-1==l&&c-1==m&&(d=!0);1<c&&b==l&&c-1==m&&(f=!0)}return g&&!d&&!e&&!f||!g&&d&&e&&f?4:g&&!d&&e&&!f||d&&!e&&f&&!g?6:g&&d&&e&&!f||!g&&!d&&!e&&f?3:g&&!d&&!e&&f||d&&e&&!f&&!g?5:g&&!d&&e&&f||d&&!e&&!f&&!g?1:g&&d&&!e&&f||!d&&e&&!f&&!g?2:g&&d&&e&&f||!d&&!e&&!f?7:d&&!e&&!f&&g?8:!d&&e&&f&&!g?9:7},createCornerBoundary:function(a){for(var b=1;7>=b;++b)for(var c=1;7>=c;++c){var d=0,e=0,f=this.getMaster().getPos(6<b?6:b,6<c?6:c),g=ResURL("image_map_boundary_03.png"),h=0,k=19,l=this.calCornerType(a,b,c);if(7!=l){1==l?(h=180,d=f.x-G.GRID_WIDTH/2-4,e=f.y-G.GRID_HEIGHT/2-4,7==c&&(d=f.x+G.GRID_WIDTH/2-4),7==b&&(e=f.y+G.GRID_HEIGHT/2-4)):2==l?(h=270,d=f.x-G.GRID_WIDTH/2+5,e=f.y-G.GRID_HEIGHT/2-4,7==c&&(d=f.x+G.GRID_WIDTH/2+5),7==b&&(e=f.y+G.GRID_HEIGHT/2-4)):3==l?(h=90,d=f.x-G.GRID_WIDTH/2-4,e=f.y-G.GRID_HEIGHT/2+5,7==c&&(d=f.x+G.GRID_WIDTH/2-4),7==b&&(e=f.y+G.GRID_HEIGHT/2+5)):4==l?(h=0,d=f.x-G.GRID_WIDTH/2+4,e=f.y-G.GRID_HEIGHT/2+5,7==c&&(d=f.x+G.GRID_WIDTH/2+4),7==b&&(e=f.y+G.GRID_HEIGHT/2+5)):5==l?(g=ResURL("image_map_boundary_01.png"),d=f.x-35,k=32,e=f.y-G.GRID_HEIGHT/2,7==c&&(d=f.x+G.GRID_WIDTH/2),7==b&&(e=f.y+G.GRID_HEIGHT/2)):6==l&&(g=ResURL("image_map_boundary_01.png"),h=90,k=32,d=f.x-G.GRID_WIDTH/2,e=f.y-35,7==c&&(d=f.x+G.GRID_WIDTH/2),7==b&&(e=f.y+G.GRID_HEIGHT/2));var m=new Laya.Image(g);m.anchorX=.5;m.rotation=h;m.anchorY=.5;m.width=k;m.pos(d,e);Controller.getView().getSceneLayer().addChild(m);this.mClearBoundary.push(m)}8==l?(l=new Laya.Image(g),h=180,d=f.x-G.GRID_WIDTH/2-4,e=f.y-G.GRID_HEIGHT/2-4,l.anchorX=.5,l.rotation=h,l.anchorY=.5,l.width=k,l.pos(d,e),Controller.getView().getSceneLayer().addChild(l),this.mClearBoundary.push(l),m=new Laya.Image(g),h=0,d=f.x-G.GRID_WIDTH/2+4,e=f.y-G.GRID_HEIGHT/2+5,m.anchorX=.5,m.rotation=h,m.anchorY=.5,m.width=k,m.pos(d,e),Controller.getView().getSceneLayer().addChild(m),this.mClearBoundary.push(m)):9==l&&(m=new Laya.Image(g),h=270,d=f.x-G.GRID_WIDTH/2+5,e=f.y-G.GRID_HEIGHT/2-4,m.anchorX=.5,m.rotation=h,m.anchorY=.5,m.width=k,m.pos(d,e),Controller.getView().getSceneLayer().addChild(m),this.mClearBoundary.push(m),m=new Laya.Image(g),h=90,d=f.x-G.GRID_WIDTH/2-4,e=f.y-G.GRID_HEIGHT/2+5,m.anchorX=.5,m.rotation=h,m.anchorY=.5,m.width=k,m.pos(d,e),Controller.getView().getSceneLayer().addChild(m),this.mClearBoundary.push(m))}},deleteClearBoundary:function(){for(var a=0,b=this.mClearBoundary.length;a<b;++a){var c=this.mClearBoundary[a];c.removeSelf();c.destroy()}this.mClearBoundary=[]}});ControllerDrop=Component.extend({ctor:function(){this._super("ControllerDrop")},init:function(){this.mMap=this.getSibling("ComponentMap");this.mBornCoordList=[];for(var a=this.getMaster().getRowCol(),b=1;b<=a.row;++b)for(var c=1;c<=a.col;++c)CoreDef.GridType.born==this.mMap.getGrid(b,c).getType()&&this.mBornCoordList.push({row:b,col:c})},setDropData:function(a,b){this.mDataMap=a;this.mOrderType=1==b||2==b||3==b||4==b?b:1;this.mDataColIndexList=[];for(var c=0,d=this.getMaster().getRowCol().col;c<d;++c){var e=a[c].length;1==this.mOrderType?this.mDataColIndexList[c]=Math.floor(Math.random()*(e-1)+.5):2==this.mOrderType?this.mDataColIndexList[c]=Math.floor(Math.random()*(e-1)+.5):3==this.mOrderType?this.mDataColIndexList[c]=e-1:4==this.mOrderType&&(this.mDataColIndexList[c]=0)}},getElementId:function(a,b){--a;b=this.mDataColIndexList[a];var c=this.mDataMap[b][a],d=this.mDataMap[b].length;1==this.mOrderType?(--b,b=0>b?d-1:b):2==this.mOrderType?(b+=1,b=b>=d?0:b):3==this.mOrderType?(--b,b=0>b?d-1:b):4==this.mOrderType&&(b+=1,b=b>=d?0:b);this.mDataColIndexList[a]=b;return c},generateElement:function(a){for(var b=0,c=this.mBornCoordList.length;b<c;++b){var d=this.mBornCoordList[b];if(!this.mMap.getElement(d.row,d.col,CoreDef.ElementTag.object)){var e=this.getElementId(d.col,a);if(!isNaN(e)&&0<e){var e=this.mMap.createElement(e),f=this.getMaster().getPos(d.row,d.col);e.getNode()&&(e.getNode().pos(f.x,f.y),e.getNode().visible=!1);e.is_new_flag=!0;this.mMap.addElement(d.row,d.col,e)}}}},isCanDrop:function(a,b){var c=this.mMap.getElement(a,b,CoreDef.ElementTag.object),d=this.mMap.getElement(a,b,CoreDef.ElementTag.attach),e=this.mMap.getElement(a,b,CoreDef.ElementTag.overlay);return c&&c.isCanDrop()&&(!d||d.isCanDrop())&&(!e||e.isCanDrop())},isCanDropTo:function(a,b){return this.mMap.isCanContact(a.row,a.col,b.row,b.col)&&CoreDef.GridType.normal==this.mMap.getGrid(b.row,b.col).getType()&&!this.mMap.getElement(b.row,b.col,CoreDef.ElementTag.object)},dropOne:function(a,b){if(this.getMaster().isCoordValid(a,b)&&this.isCanDrop(a,b)){var c=this.getMaster().getRowCol(),c=CA.searchDropPath(c.row,a,b,!0,function(c,d){return this.isCanDropTo(c,d,a,b)},null,null,null,this);if(0==c.length){var d=this.mMap.getElement(a,b,CoreDef.ElementTag.object),e=this.mMap.getElement(a,b,CoreDef.ElementTag.attach),f=this.mMap.getElement(a,b,CoreDef.ElementTag.overlay);if(CoreDef.GridType.born==this.mMap.getGrid(a,b).getType()&&d.is_new_flag)return delete d.is_new_flag,{elements:[d,e,f],coord_begin:{row:a,col:b},pos_path:[]}}else{var g=c[c.length-1],d=this.mMap.delElement(a,b,CoreDef.ElementTag.object),e=this.mMap.delElement(a,b,CoreDef.ElementTag.attach),f=this.mMap.delElement(a,b,CoreDef.ElementTag.overlay);this.mMap.addElement(g.row,g.col,d);this.mMap.addElement(g.row,g.col,e);this.mMap.addElement(g.row,g.col,f);for(var g=[],h=0,k=c.length;h<k;++h){var l=this.getMaster().getPos(c[h].row,c[h].col);g.push(l)}return{elements:[d,e,f],coord_begin:{row:a,col:b},pos_path:g}}}},startDrop:function(a,b,c){var d=this.getMaster().getRowCol(),e=[];CA.searchDropList(d.row,d.col,function(a,b,c){if(a=this.dropOne(a,b))return a.batch=c,e.push(a),!0},null,this);var f=[];CA.searchDropList(d.row,d.col,function(a,b,c){if(a=this.dropOne(a,b))return a.batch=c,f.push(a),!0},function(a){this.generateElement(a)},this);this.dropNewImplFunc=function(){var d=f.length;if(0==d)b.apply(c,[!0]);else for(var e=0,g=f.length;e<g;++e){var h=f[e],k=h.elements[0],l=h.elements[1];Action.playNewElementDrop(a,h.elements[2],h.coord_begin,h.pos_path,h.batch,null,this);Action.playNewElementDrop(a,l,h.coord_begin,h.pos_path,h.batch,null,this);Action.playNewElementDrop(a,k,h.coord_begin,h.pos_path,h.batch,function(){0>=--d&&b.apply(c,[!0])},this)}};var g=e.length;if(0==g)this.dropNewImplFunc();else for(var d=0,h=e.length;d<h;++d){var k=e[d],l=k.elements[0],m=k.elements[1];Action.playOldElementDrop(a,k.elements[2],k.coord_begin,k.pos_path,k.batch,null,this);Action.playOldElementDrop(a,m,k.coord_begin,k.pos_path,k.batch,null,this);Action.playOldElementDrop(a,l,k.coord_begin,k.pos_path,k.batch,function(){0>=--g&&this.dropNewImplFunc()},this)}}});ControllerGain=Component.extend({ctor:function(){this._super("ControllerGain")},init:function(a){this.mMap=this.getSibling("ComponentMap");this.mShowDisplay=a;this.mGameSection=game_section.normal;this.mNormalScreenTimes=this.mNormalClearCount=0;this.mTimesNormalMap={};this.mTimesBonus1Map={};this.mTimesBonus2Map={};this.mTimesBonus3Map={};this.bind(EventDef.ED_CORE_CLEAR_OBJECT,this.onObjectClear)},onObjectClear:function(a,b,c){game_section.normal==this.mGameSection?(this.mTimesNormalMap[a]=isNaN(this.mTimesNormalMap[a])?1:++this.mTimesNormalMap[a],++this.mNormalClearCount,EventCenter.post(EventDef.ED_PROGRESS_BONUS1,this.mNormalClearCount)):game_section.bonus1==this.mGameSection?this.mTimesBonus1Map[a]=isNaN(this.mTimesBonus1Map[a])?1:++this.mTimesBonus1Map[a]:game_section.bonus2==this.mGameSection?this.mTimesBonus2Map[a]=isNaN(this.mTimesBonus2Map[a])?1:++this.mTimesBonus2Map[a]:game_section.bonus3==this.mGameSection&&(this.mTimesBonus3Map[a]=isNaN(this.mTimesBonus3Map[a])?1:++this.mTimesBonus3Map[a])},getGameSection:function(){return this.mGameSection},resetTimesGain:function(){this.mTimesNormalMap={};this.mTimesBonus1Map={};this.mTimesBonus2Map={};this.mTimesBonus3Map={}},resetGain:function(){this.mGameSection=game_section.normal;this.mNormalScreenTimes=this.mNormalClearCount=0;this.resetTimesGain()},updateGain:function(a){game_section.normal==this.mGameSection?EventCenter.post(EventDef.ED_ADD_TO_LIST,game_section.normal,a,this.mTimesNormalMap):game_section.bonus1==this.mGameSection?EventCenter.post(EventDef.ED_ADD_TO_LIST,game_section.bonus1,a,this.mTimesBonus1Map):game_section.bonus2==this.mGameSection?EventCenter.post(EventDef.ED_ADD_TO_LIST,game_section.bonus2,a,this.mTimesBonus2Map):game_section.bonus3==this.mGameSection&&EventCenter.post(EventDef.ED_ADD_TO_LIST,game_section.bonus3,a,this.mTimesBonus3Map);this.resetTimesGain()},triggerBonus:function(a,b,c,d,e,f){game_section.normal==this.mGameSection?(this.mShowDisplay&&console.log("\u5e38\u89c4\u9636\u6bb5\u7ed3\u675f"),this.mNormalClearCount=a,this.mNormalScreenTimes=b,this.mNormalClearCount>=G.BONUS_1?(AudioModel.playSound(2005),this.mGameSection=game_section.bonus1,Action.playBonus1HintAction(function(){this.onBonus1(c,function(){e.apply(f,[game_section.bonus1,!1])},this)},this)):this.mNormalScreenTimes>=G.BONUS_2?(this.mGameSection=game_section.bonus2,Action.playBonus2HintAction(function(){this.onBonus2(function(){e.apply(f,[game_section.bonus2,!1])},this)},this)):d?(this.mGameSection=game_section.bonus3,Action.playBonus3HintAction(function(){this.onBonus3(d,function(){e.apply(f,[game_section.bonus3,!1])},this)},this)):e.apply(f,[game_section.normal,!0])):game_section.bonus1==this.mGameSection?(this.mShowDisplay&&console.log("bonus1\u9636\u6bb5\u7ed3\u675f"),this.mNormalScreenTimes>=G.BONUS_2?(this.mGameSection=game_section.bonus2,Action.playBonus2HintAction(function(){this.onBonus2(function(){e.apply(f,[game_section.bonus2,!1])},this)},this)):e.apply(f,[game_section.bonus1,!0])):game_section.bonus2==this.mGameSection?(this.mShowDisplay&&console.log("bonus2\u9636\u6bb5\u7ed3\u675f"),e.apply(f,[game_section.bonus2,!0])):game_section.bonus3==this.mGameSection&&(this.mShowDisplay&&console.log("bonus3\u9636\u6bb5\u7ed3\u675f"),e.apply(f,[game_section.bonus3,!0]))},onBonus1:function(a,b,c){this.mShowDisplay&&console.log("\u89e6\u53d1bonus1");EventCenter.post(EventDef.ED_ON_BONUS,game_section.bonus1);bonus_type.random_replace==a.type?this.doRandomReplace(b,c):bonus_type.discolor_ray==a.type?this.doDiscolorRay(b,c):bonus_type.diagonal_discolor==a.type?this.doDiagonalDiscolor(b,c):(console.log("\u7279\u6548\u7c7b\u578b: "+a.type),b.apply(c,[]))},onBonus2:function(a,b){this.mShowDisplay&&console.log("\u89e6\u53d1bonus2");EventCenter.post(EventDef.ED_ON_BONUS,game_section.bonus2);for(var c=[],d=this.getMaster().getRowCol(),e=1;e<=d.row;++e)for(var f=1;f<=d.col;++f){var g=this.mMap.getElement(e,f,CoreDef.ElementTag.overlay);g&&CoreDef.OverlayType.fixed==g.getType()||c.push(CA.makeCoord(e,f))}var h=c.length;if(0==h)a.apply(b,[]);else for(AudioModel.playMusic(1999),d=0,e=c.length;d<e;++d){var f=c[d],g=this.getMaster().getPos(f.row,f.col),k=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.object),l=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.attach);Action.playElementScreenOut(l,f,g,null,this);Action.playElementScreenOut(k,f,g,function(){if(0>=--h){var c=DataTB.get("level_tplt",Controller.getLevelId(),!0);AudioModel.playMusic(c.music);a.apply(b,[])}},this)}},onBonus3:function(a,b,c){this.mShowDisplay&&console.log("\u89e6\u53d1bonus3");EventCenter.post(EventDef.ED_ON_BONUS,game_section.bonus3);bonus_type.random_all_match==a.type?this.doRandomAllMatch(a.value,b,c):bonus_type.fixed_all_match==a.type?this.doFixedAllMatch(a.value,b,c):bonus_type.position_swap==a.type?(AudioModel.playSound(3011),this.doPositionSwap(b,c)):bonus_type.element_fixed==a.type?this.doElementFixed(b,c):bonus_type.random_ramble==a.type?(AudioModel.playSound(3012),this.doRandomRamble(b,c)):bonus_type.rainbow_clear==a.type?this.doRainbowClear(b,c):bonus_type.screen_clear==a.type?this.doScreenClear(a.value,b,c):(console.log("\u7279\u6548\u7c7b\u578b: "+a.type),b.apply(c,[]))},replaceObject:function(a,b,c){var d=this.getMaster().getPos(a,b),e=this.mMap.delElement(a,b,CoreDef.ElementTag.object);c=this.mMap.createElement(c);c.getNode()&&(c.getNode().pos(d.x,d.y),c.getNode().visible=!1);this.mMap.addElement(a,b,c);return{old_object:e,new_object:c,pos:d}},doRandomReplace:function(a,b){this.mShowDisplay&&console.log("\u968f\u673a\u66ff\u6362");for(var c={},d=this.getMaster().getRowCol(),e=d.row;1<=e;--e)for(var f=1;f<=d.col;++f){var g=this.mMap.getElement(e,f,CoreDef.ElementTag.object);if(g){var h=g.getSubType();CoreDef.ObjectType.normal==g.getType()&&CoreDef.BaseType.wail!=h&&(c[h]=c[h]||[],c[h].push({row:e,col:f,object_id:g.getId()}))}}var d=[],k;for(k in c)c.hasOwnProperty(k)&&d.push(k);e=Math.floor(Math.random()*(d.length-1)+.5);k=c[d[e]][0].object_id;d.splice(e,1);var c=c[d[Math.floor(Math.random()*(d.length-1)+.5)]],l=c.length;if(0==l)a.apply(b,[]);else for(d=0,e=c.length;d<e;++d)f=c[d],f=this.replaceObject(f.row,f.col,k),Action.playRandomReplaceAction(f.old_object,f.new_object,f.pos,function(){0>=--l&&a.apply(b,[])},this)},doDiscolorRay:function(a,b){this.mShowDisplay&&console.log("\u53d8\u8272\u5c04\u7ebf");var c=[];this.getMaster().getRowCol();for(var d=2;5>=d;++d)for(var e=2;5>=e;++e){var f=this.mMap.getElement(d,e,CoreDef.ElementTag.object);if(f){var g=f.getSubType();CoreDef.ObjectType.normal==f.getType()&&CoreDef.BaseType.wail!=g&&c.push(CA.makeCoord(d,e))}}for(var h=c[Math.floor(Math.random()*(c.length-1)+.5)],k=[],g=[],f=[],c=[],l=CA.getCrossRange(h.row,h.col,G.MAP_ROW),d=0,e=l.length;d<e;++d){var m=l[d];if(this.getMaster().isCoordValid(m.row,m.col)){var n=this.mMap.getElement(m.row,m.col,CoreDef.ElementTag.object);n&&CoreDef.ObjectType.normal==n.getType()&&(m.row<h.row&&m.col==h.col?k.push(m):m.row>h.row&&m.col==h.col?g.push(m):m.row==h.row&&m.col<h.col?f.push(m):m.row==h.row&&m.col>h.col&&c.push(m))}}var p=k.length+g.length+f.length+c.length;if(0==p)a.apply(b,[]);else{h=this.getMaster().getPos(h.row,h.col);l=[20101,20102,20103,20104,20105,20106,20107];n=l[Math.floor(Math.random()*(l.length-1)+.5)];d=0;for(e=k.length;d<e;++d)m=k[d],m=this.replaceObject(m.row,m.col,n),Action.playDiscolorRayAction1(m.old_object,m.new_object,m.pos,d,function(){0>=--p&&a.apply(b,[])},this);Action.playDiscolorRayAction2(h,"up",k.length,null,null);k=l[Math.floor(Math.random()*(l.length-1)+.5)];d=0;for(e=g.length;d<e;++d)m=g[d],m=this.replaceObject(m.row,m.col,k),Action.playDiscolorRayAction1(m.old_object,m.new_object,m.pos,d,function(){0>=--p&&a.apply(b,[])},this);Action.playDiscolorRayAction2(h,"down",g.length,null,null);g=l[Math.floor(Math.random()*(l.length-1)+.5)];d=0;for(e=f.length;d<e;++d)k=f[d],m=this.replaceObject(k.row,k.col,g),Action.playDiscolorRayAction1(m.old_object,m.new_object,m.pos,d,function(){0>=--p&&a.apply(b,[])},this);Action.playDiscolorRayAction2(h,"left",f.length,null,null);f=l[Math.floor(Math.random()*(l.length-1)+.5)];d=0;for(e=c.length;d<e;++d)g=c[d],m=this.replaceObject(g.row,g.col,f),Action.playDiscolorRayAction1(m.old_object,m.new_object,m.pos,d,function(){0>=--p&&a.apply(b,[])},this);Action.playDiscolorRayAction2(h,"right",c.length,null,null)}},doDiagonalDiscolor:function(a,b){this.mShowDisplay&&console.log("\u5bf9\u89d2\u53d8\u8272");for(var c=[],d=[[1,1],[1,6],[6,1],[6,6]],e=0,f=d.length;e<f;++e){var g=d[e][0],h=d[e][1],k=this.mMap.getElement(g,h,CoreDef.ElementTag.object);if(k){var l=k.getSubType();CoreDef.ObjectType.normal==k.getType()&&CoreDef.BaseType.wail!=l&&c.push({row:g,col:h,object_id:k.getId()})}}e=c[Math.floor(Math.random()*(c.length-1)+.5)];c=e.object_id;f=[];1==e.row&&1==e.col?f=[[2,2],[3,3],[4,4],[5,5],[6,6]]:1==e.row&&6==e.col?f=[[2,5],[3,4],[4,3],[5,2],[6,1]]:6==e.row&&1==e.col?f=[[5,2],[4,3],[3,4],[2,5],[1,6]]:6==e.row&&6==e.col&&(f=[[5,5],[4,4],[3,3],[2,2],[1,1]]);d=[];g=0;for(h=f.length;g<h;++g){var k=f[g][0],l=f[g][1],m=this.mMap.getElement(k,l,CoreDef.ElementTag.object);m&&CoreDef.ObjectType.normal==m.getType()&&d.push({row:k,col:l,object_id:m.getId()})}var n=d.length;if(0==n)a.apply(b,[]);else for(f=this.getMaster().getPos(e.row,e.col),Action.playDiagonalDiscolorAction1(CA.makeCoord(e.row,e.col),f,null,null),e=0,f=d.length;e<f;++e)g=d[e],g=this.replaceObject(g.row,g.col,c),Action.playRandomReplaceAction(g.old_object,g.new_object,g.pos,function(){0>=--n&&a.apply(b,[])},this)},doRandomAllMatch:function(a,b,c){this.mShowDisplay&&console.log("\u968f\u673a\u767e\u642d: "+a);if(0==a)b.apply(c,[]);else{for(var d=[],e=this.getMaster().getRowCol(),f=e.row;1<=f;--f)for(var g=1;g<=e.col;++g){var h=this.mMap.getElement(f,g,CoreDef.ElementTag.object),k=this.mMap.getElement(f,g,CoreDef.ElementTag.attach),l=this.mMap.getElement(f,g,CoreDef.ElementTag.overlay);!h||CoreDef.ObjectType.normal!=h.getType()||CoreDef.BaseType.wail==h.getSubType()||k||l||d.push(CA.makeCoord(f,g))}e=[];for(f=0;f<a&&0!=d.length;++f)g=Math.floor(Math.random()*(d.length-1)+.5),h=d[g],d.splice(g,1),e.push(h);var m=e.length;if(0==m)b.apply(c,[]);else for(a=0,d=e.length;a<d;++a)f=e[a],g=this.getMaster().getPos(f.row,f.col),h=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.object),k=this.mMap.createElement(20108),k.getNode()&&(k.getNode().pos(g.x,g.y),k.getNode().visible=!1),this.mMap.addElement(f.row,f.col,k),Action.playRandomAllMatchAction(h,k,g,function(){0>=--m&&b.apply(c,[])},this)}},doFixedAllMatch:function(a,b,c){this.mShowDisplay&&console.log("\u56fa\u5b9a\u767e\u642d: "+a);if(0==a)b.apply(c,[]);else{for(var d=[],e=this.getMaster().getRowCol(),f=e.row;2<=f;--f)for(var g=1;g<=e.col;++g){var h=this.mMap.getElement(f,g,CoreDef.ElementTag.object),k=this.mMap.getElement(f,g,CoreDef.ElementTag.attach),l=this.mMap.getElement(f,g,CoreDef.ElementTag.overlay);CoreDef.ObjectType.normal!=h.getType()||CoreDef.BaseType.wail==h.getSubType()||k||l||d.push(CA.makeCoord(f,g))}e=[];for(l=0;l<a&&0!=d.length;++l)f=Math.floor(Math.random()*(d.length-1)+.5),g=d[f],d.splice(f,1),e.push(g);var m=e.length;if(0==m)b.apply(c,[]);else for(a=0,d=e.length;a<d;++a)AudioModel.playSound(3004),f=e[a],g=this.getMaster().getPos(f.row,f.col),h=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.object),k=this.mMap.createElement(20108),k.getNode()&&(k.getNode().pos(g.x,g.y),k.getNode().visible=!1),this.mMap.addElement(f.row,f.col,k),l=this.mMap.createElement(40100),l.getNode()&&(l.getNode().pos(g.x,g.y),l.getNode().visible=!1),this.mMap.addElement(f.row,f.col,l),Action.playFixedAllMatchAction(h,k,l,g,function(){0>=--m&&b.apply(c,[])},this)}},doPositionSwap:function(a,b){for(var c=[],d=[],e=[],f=[],g=this.getMaster().getRowCol(),h=1;h<=g.row;++h)for(var k=1;k<=g.col;++k)1<=h&&h<=g.row/2?1<=k&&k<=g.col/2?c.push(CA.makeCoord(h,k)):d.push(CA.makeCoord(h,k)):1<=k&&k<=g.col/2?e.push(CA.makeCoord(h,k)):f.push(CA.makeCoord(h,k));g=[1,2,3,4,5];g=g[Math.floor(Math.random()*(g.length-1)+.5)];this.swapImplFunc1=function(a,b,c,d){for(var e=[],f=a.length,g=0;g<f;++g){var h=a[g],k=this.getMaster().getPos(h.row,h.col),l=b[g],z=this.getMaster().getPos(l.row,l.col),t=c[g],A=this.getMaster().getPos(t.row,t.col),u=d[g],y=this.getMaster().getPos(u.row,u.col),D=this.mMap.delElement(h.row,h.col,CoreDef.ElementTag.object),E=this.mMap.delElement(h.row,h.col,CoreDef.ElementTag.attach),F=this.mMap.delElement(h.row,h.col,CoreDef.ElementTag.overlay),H=this.mMap.delElement(l.row,l.col,CoreDef.ElementTag.object),I=this.mMap.delElement(l.row,l.col,CoreDef.ElementTag.attach),J=this.mMap.delElement(l.row,l.col,CoreDef.ElementTag.overlay),K=this.mMap.delElement(t.row,t.col,CoreDef.ElementTag.object),L=this.mMap.delElement(t.row,t.col,CoreDef.ElementTag.attach),M=this.mMap.delElement(t.row,t.col,CoreDef.ElementTag.overlay),N=this.mMap.delElement(u.row,u.col,CoreDef.ElementTag.object),O=this.mMap.delElement(u.row,u.col,CoreDef.ElementTag.attach),P=this.mMap.delElement(u.row,u.col,CoreDef.ElementTag.overlay);this.mMap.addElement(h.row,h.col,N);this.mMap.addElement(h.row,h.col,O);this.mMap.addElement(h.row,h.col,P);this.mMap.addElement(l.row,l.col,D);this.mMap.addElement(l.row,l.col,E);this.mMap.addElement(l.row,l.col,F);this.mMap.addElement(t.row,t.col,H);this.mMap.addElement(t.row,t.col,I);this.mMap.addElement(t.row,t.col,J);this.mMap.addElement(u.row,u.col,K);this.mMap.addElement(u.row,u.col,L);this.mMap.addElement(u.row,u.col,M);h={elements:[H,I,J],pos:{x:A.x,y:A.y}};y={elements:[K,L,M],pos:{x:y.x,y:y.y}};k={elements:[N,O,P],pos:{x:k.x,y:k.y}};e.push({elements:[D,E,F],pos:{x:z.x,y:z.y}});e.push(h);e.push(y);e.push(k)}return e};this.swapImplFunc2=function(a,b){for(var c=[],d=a.length,e=0;e<d;++e){var f=a[e],g=this.getMaster().getPos(f.row,f.col),h=b[e],k=this.getMaster().getPos(h.row,h.col),l=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.object),z=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.attach),t=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.overlay),A=this.mMap.delElement(h.row,h.col,CoreDef.ElementTag.object),u=this.mMap.delElement(h.row,h.col,CoreDef.ElementTag.attach),y=this.mMap.delElement(h.row,h.col,CoreDef.ElementTag.overlay);this.mMap.addElement(f.row,f.col,A);this.mMap.addElement(f.row,f.col,u);this.mMap.addElement(f.row,f.col,y);this.mMap.addElement(h.row,h.col,l);this.mMap.addElement(h.row,h.col,z);this.mMap.addElement(h.row,h.col,t);f={elements:[A,u,y],pos:{x:g.x,y:g.y}};c.push({elements:[l,z,t],pos:{x:k.x,y:k.y}});c.push(f)}return c};if(1==g){this.mShowDisplay&&console.log("\u4f4d\u7f6e\u4e92\u6362,\u987a\u65f6\u9488");for(var d=this.swapImplFunc1(c,d,f,e),l=d.length,e=0,f=d.length;e<f;++e)Action.playPositionSwapAction1(d[e].elements,d[e].pos,function(){0>=--l&&a.apply(b,[])},this)}else if(2==g)for(this.mShowDisplay&&console.log("\u4f4d\u7f6e\u4e92\u6362,\u9006\u65f6\u9488"),d=this.swapImplFunc1(c,e,f,d),l=d.length,e=0,f=d.length;e<f;++e)Action.playPositionSwapAction1(d[e].elements,d[e].pos,function(){0>=--l&&a.apply(b,[])},this);else if(3==g)for(this.mShowDisplay&&console.log("\u4f4d\u7f6e\u4e92\u6362,\u4ea4\u53c9"),c=this.swapImplFunc2(c,f),d=this.swapImplFunc2(d,e),d=c.concat(d),l=d.length,e=0,f=d.length;e<f;++e)Action.playPositionSwapAction1(d[e].elements,d[e].pos,function(){0>=--l&&a.apply(b,[])},this);else if(4==g)for(this.mShowDisplay&&console.log("\u4f4d\u7f6e\u4e92\u6362,\u6a2a\u5411"),c=this.swapImplFunc2(c,d),d=this.swapImplFunc2(e,f),d=c.concat(d),l=d.length,e=0,f=d.length;e<f;++e)Action.playPositionSwapAction1(d[e].elements,d[e].pos,function(){0>=--l&&a.apply(b,[])},this);else if(5==g)for(this.mShowDisplay&&console.log("\u4f4d\u7f6e\u4e92\u6362,\u7ad6\u5411"),c=this.swapImplFunc2(c,e),d=this.swapImplFunc2(d,f),d=c.concat(d),l=d.length,e=0,f=d.length;e<f;++e)Action.playPositionSwapAction1(d[e].elements,d[e].pos,function(){0>=--l&&a.apply(b,[])},this);else this.mShowDisplay&&console.log("\u4f4d\u7f6e\u4e92\u6362,\u672a\u77e5\u7c7b\u578b: "+g),a.apply(b,[])},doElementFixed:function(a,b){function c(){for(var c=[],d=this.getMaster().getRowCol(),e=d.row;1<=e;--e)for(var f=1;f<=d.col;++f){var g=this.mMap.getElement(e,f,CoreDef.ElementTag.object),h=this.mMap.getElement(e,f,CoreDef.ElementTag.overlay);g&&CoreDef.ObjectType.normal==g.getType()&&!h&&c.push(CA.makeCoord(e,f))}var k=c.length;if(0==k)a.apply(b,[]);else for(d=0,e=c.length;d<e;++d){var f=c[d],h=this.getMaster().getPos(f.row,f.col),g=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.object),l=this.mMap.delElement(f.row,f.col,CoreDef.ElementTag.attach);Action.playElementScreenOut(l,f,h,null,this);Action.playElementScreenOut(g,f,h,function(){if(0>=--k)Controller.onDrop(0,0,null,a,b)},this)}}this.mShowDisplay&&console.log("\u5143\u7d20\u56fa\u5b9a");for(var d={},e=this.getMaster().getRowCol(),f=e.row;2<=f;--f)for(var g=1;g<=e.col;++g){var h=this.mMap.getElement(f,g,CoreDef.ElementTag.object),k=this.mMap.getElement(f,g,CoreDef.ElementTag.attach),l=this.mMap.getElement(f,g,CoreDef.ElementTag.overlay);if(h){var m=h.getSubType();CoreDef.ObjectType.normal!=h.getType()||CoreDef.BaseType.wail==m||k||l||(d[m]=d[m]||[],d[m].push(CA.makeCoord(f,g)))}}var l=[],n;for(n in d)d.hasOwnProperty(n)&&l.push(n);var d=d[l[Math.floor(Math.random()*(l.length-1)+.5)]],p=d.length;if(0==p)a.apply(b,[]);else for(n=0,e=d.length;n<e;++n)f=d[n],g=this.getMaster().getPos(f.row,f.col),l=this.mMap.createElement(40100),l.getNode()&&(l.getNode().pos(g.x,g.y),l.getNode().visible=!1),this.mMap.addElement(f.row,f.col,l),Action.playElementFixedAction(l,g,function(){0>=--p&&c.apply(this,[])},this)},doRandomRamble:function(a,b){this.mShowDisplay&&console.log("\u968f\u673a\u6f2b\u6b65");for(var c=[],d=this.getMaster().getRowCol(),e=2;5>=e;++e)for(var f=2;5>=f;++f){var g=this.mMap.getElement(e,f,CoreDef.ElementTag.object);if(g){var h=this.mMap.getElement(e,f,CoreDef.ElementTag.overlay);g.getSubType();CoreDef.ObjectType.normal!=g.getType()||h||c.push(CA.makeCoord(e,f))}}var c=c[Math.floor(Math.random()*(c.length-1)+.5)],k=!0,l=!0,m=!0,n=!0;this.getRandomCrossCoord=function(a,b){a&&(a.row>b.row?l=!1:a.row<b.row?k=!1:a.col>b.col?n=!1:a.col<b.col&&(m=!1));if(1!=b.row&&d.row!=b.row&&1!=b.col&&d.col!=b.col){for(var c=[],e=CA.getCrossRange(b.row,b.col,1),f=0,g=e.length;f<g;++f){var h=e[f];this.getMaster().isCoordValid(h.row,h.col)&&(h.row<b.row&&h.col==b.col?k&&c.push(h):h.row>b.row&&h.col==b.col?l&&c.push(h):h.row==b.col&&h.col<b.col?m&&c.push(h):h.row==b.col&&h.col>=b.col&&n&&c.push(h))}return c[Math.floor(Math.random()*(c.length-1)+.5)]}};this.rambleImplFunc=function(c,d){var e=this.getRandomCrossCoord(c,d),f=this.mMap.getElement(d.row,d.col,CoreDef.ElementTag.object),g=this.getMaster().getPos(d.row,d.col);if(f)Action.playRandomRambleAction1(g,function(){Action.playRandomRambleAction2(g,d,e,null,this);this.getSibling("ControllerClear").startClearEx([d],function(){this.updateGain(1);if(e)this.rambleImplFunc(d,e);else Controller.onDrop(0,1,null,a,b)},this)},this);else if(e)this.rambleImplFunc(d,e);else Controller.onDrop(0,0,null,a,b)};this.rambleImplFunc(null,c)},doRainbowClear:function(a,b){this.mShowDisplay&&console.log("\u5f69\u8679\u6d88");for(var c=[[[2,1],[1,2],[1,3],[1,4],[1,5],[2,6]],[[3,1],[2,2],[2,3],[2,4],[2,5],[3,6]],[[4,1],[3,2],[3,3],[3,4],[3,5],[4,6]],[[5,1],[4,2],[4,3],[4,4],[4,5],[5,6]],[[6,1],[5,2],[5,3],[5,4],[5,5],[6,6]]],c=c[Math.floor(Math.random()*(c.length-1)+.5)],d=[],e=0,f=c.length;e<f;++e){var g=c[e][0],h=c[e][1],k=this.mMap.getElement(g,h,CoreDef.ElementTag.object),l=this.mMap.getElement(g,h,CoreDef.ElementTag.overlay);k&&CoreDef.ObjectType.normal==k.getType()&&!l&&d.push(CA.makeCoord(g,h))}c=this.mMap.getRowPos(c[0][0]);Action.playRainbowClearAction(c,function(){this.getSibling("ControllerClear").startClearEx(d,function(){this.updateGain(1);Controller.onDrop(0,1,null,a,b)},this)},this)},doScreenClear:function(a,b,c){this.mShowDisplay&&console.log("\u5168\u5c4f\u968f\u673a\u6d88\u9664: "+a);for(var d=[],e=this.getMaster().getRowCol(),f=e.row;1<=f;--f)for(var g=1;g<=e.col;++g){var h=this.mMap.getElement(f,g,CoreDef.ElementTag.object),k=this.mMap.getElement(f,g,CoreDef.ElementTag.overlay);h&&CoreDef.ObjectType.normal==h.getType()&&!k&&d.push(CA.makeCoord(f,g))}for(var l=[],e=0;e<a&&0!=d.length;++e)f=Math.floor(Math.random()*(d.length-1)+.5),g=d[f],d.splice(f,1),l.push(g);a=0;for(d=l.length;a<d;++a){var m=this.getMaster().getPos(l[a].row,l[a].col);Action.playScreenClearFlyAction(m,l[a],function(){var a=laya.createArmature(ResURL("yuansuxiaochu.png"),ResURL("yuansuxiaochu.sk"),!1,null,null,function(){a.removeSelf();a.destroy()},this);a.play("ue_clear_2");a.pos(m.x,m.y);Controller.getView().getSceneLayer().addChild(a)},this)}Action.playScreenClearCastAction(null,function(){this.getSibling("ControllerClear").startClearEx(l,function(){this.updateGain(1);Controller.onDrop(0,1,null,b,c)},this)},this)}});ControllerMinimap=Component.extend({ctor:function(){this._super("ControllerMinimap")},init:function(){this.mMinimapNode=new laya.ui.View;this.mMinimapNode.cacheAs="bitmap";this.mMinimapDisplayMap={};for(var a=this.getMaster().getRowCol(),b=this.getMaster().createPosMap(a.row,a.col,17,17,0,0,0),c=1;c<=a.row;++c){this.mMinimapDisplayMap[c]={};for(var d=1;d<=a.col;++d){var e=new laya.ui.Image;e.anchorX=.5;e.anchorY=.5;e.skin=ResURL("image_small_map_gird.png");e.pos(b[c][d].x,b[c][d].y);this.mMinimapNode.addChild(e);this.mMinimapDisplayMap[c][d]=e}}this.bind(EventDef.ED_CORE_CLEAR_SURFACE,this.onSurfaceClear)},show:function(a,b,c,d){this.mMinimapNode.parent&&a!=this.mMinimapNode.parent&&this.mMinimapNode.removeSelf();a?a.addChild(this.mMinimapNode):Laya.stage.addChild(this.mMinimapNode);this.mMinimapNode.pos(b,c);this.mMinimapNode.visible=d?!0:!1},resetByMapData:function(a){for(var b=this.getMaster().getRowCol(),c=1;c<=b.row;++c)for(var d=1;d<=b.col;++d)this.mMinimapDisplayMap[c][d].skin=0==a[c-1][d-1]?ResURL("image_small_map_gird.png"):ResURL("image_small_map_gird_01.png")},onSurfaceClear:function(a,b,c){this.mMinimapDisplayMap[b][c].skin=ResURL("image_small_map_gird_02.png")}});CA={searchDropPath:function(a,b,c,d,e,f,g,h,k){"function"!=typeof e&&(e=function(){return!1});"function"!=typeof f&&(f=function(){return!1});"function"!=typeof g&&(g=function(){return!1});"function"!=typeof h&&(h=function(){return!1});var l=[];if(h.apply(k,[{row:b,col:c}]))return l;for(;b<=a&&!h.apply(k,[{row:b,col:c}])&&b!=a;++b){var m={row:b,col:c},n={row:b+1,col:c},p={row:b+1,col:c-1},r={row:b+1,col:c+1};if(e.apply(k,[m,n]))l.push(n);else if(f.apply(k,[m,p]))c=p.col,l.push(p);else if(g.apply(k,[m,r]))c=r.col,l.push(r);else if(!d)break}return l},searchDropList:function(a,b,c,d,e){function f(){d.apply(e,[g]);for(var h=!1,k=a;1<=k;--k)for(var l=1;l<=b;++l)c.apply(e,[k,l,g])&&(h=!0);g+=1;h&&f()}if("function"!=typeof c)throw Error("not support for checkCB type "+typeof c);"function"!=typeof d&&(d=function(){});var g=0;f()},searchConnectList:function(a,b,c,d){function e(a,b){var l={up:{row:a-1,col:b},rightUp:{row:a-1,col:b+1},right:{row:a,col:b+1},rightDown:{row:a+1,col:b+1},down:{row:a+1,col:b},leftDown:{row:a+1,col:b-1},left:{row:a,col:b-1},leftUp:{row:a-1,col:b-1}},m;for(m in l)if(l.hasOwnProperty(m)){for(var n=l[m],p=!1,r=0,q=f.length;r<q;++r)if(n.row==f[r].row&&n.col==f[r].col){p=!0;break}!p&&c.apply(d,[a,b,n.row,n.col])&&(f.push({row:n.row,col:n.col}),g.push({row:n.row,col:n.col}),e(n.row,n.col))}}if("function"!=typeof c)throw Error("not support for checkCB type "+typeof c);var f=[],g=[];f.push({row:a,col:b});g.push({row:a,col:b});e(a,b);return g},getHorRange:function(a,b,c){for(var d=[],e=1;e<=c;++e)d.push({row:a,col:b-e}),d.push({row:a,col:b+e});return d},getVerRange:function(a,b,c){for(var d=[],e=1;e<=c;++e)d.push({row:a-e,col:b}),d.push({row:a+e,col:b});return d},getCrossRange:function(a,b,c){for(var d=[],e=1;e<=c;++e)d.push({row:a-e,col:b}),d.push({row:a+e,col:b}),d.push({row:a,col:b-e}),d.push({row:a,col:b+e});return d},getLeftUpToRightDownRange:function(a,b,c){for(var d=[],e=1;e<=c;++e)d.push({row:a-e,col:b-e}),d.push({row:a+e,col:b+e});return d},getRightUpToLeftDownRange:function(a,b,c){for(var d=[],e=1;e<=c;++e)d.push({row:a-e,col:b+e}),d.push({row:a+e,col:b-e});return d},getObliqueRange:function(a,b,c){for(var d=[],e=1;e<=c;++e)d.push({row:a-e,col:b-e}),d.push({row:a-e,col:b+e}),d.push({row:a+e,col:b+e}),d.push({row:a+e,col:b-e});return d},getRoundRange:function(a,b,c){var d=[];if(0<c){d.push({row:a-c,col:b});d.push({row:a+c,col:b});d.push({row:a,col:b-c});d.push({row:a,col:b+c});d.push({row:a-c,col:b-c});d.push({row:a-c,col:b+c});d.push({row:a+c,col:b-c});d.push({row:a+c,col:b+c});for(var e=1;e<c;++e)d.push({row:a-c,col:b-e}),d.push({row:a-c,col:b+e}),d.push({row:a+c,col:b-e}),d.push({row:a+c,col:b+e}),d.push({row:a-e,col:b-c}),d.push({row:a+e,col:b-c}),d.push({row:a-e,col:b+c}),d.push({row:a+e,col:b+c})}return d},makeCoord:function(a,b){return{row:a,col:b}},equalCoord:function(a,b){return a&&b&&a.row==b.row&&a.col==b.col},addCoord:function(a,b){if(b){for(var c=0,d=a.length;c<d;++c)if(b.row==a[c].row&&b.col==a[c].col)return!1;a.push(b);return!0}return!1},removeCoord:function(a,b){if(b)for(var c=0,d=a.length;c<d;++c)if(b.row==a[c].row&&b.col==a[c].col)return a.splice(c,1),!0;return!1},getCoordIndex:function(a,b){if(b)for(var c=0,d=a.length;c<d;++c)if(b.row==a[c].row&&b.col==a[c].col)return c;return-1}};CoreDef={GridType:{none:0,normal:1,born:2,door_in:3,door_out:4,recycle:5},DirectType:{hor:1,ver:2},EffectType:{image:1,skeleton:2,frame:3,particle:4},ElementTag:{surface:1,object:2,attach:3,overlay:4},BaseType:{red:1,yellow:2,green:3,blue:4,purple:5,pink:6,plum:7,wail:8},SurfaceType:{glass:1},ObjectType:{normal:1},AttachType:{cross:1,oblique:2},OverlayType:{fixed:1}};Element=Class.extend({ctor:function(a){this.mSubType=this.mType=this.mTag=this.mId=0;this.mCanDrop=!1;a&&(this.mNode=new laya.ui.Image,this.mNode.anchorX=.5,this.mNode.anchorY=.5)},dtor:function(){this.mNode&&!this.mNode.destroyed&&(this.mNode.removeSelf(),this.mNode.destroy(),delete this.mNode)},getId:function(){return this.mId},setId:function(a){this.mId=a},getTag:function(){return this.mTag},setTag:function(a){this.mTag=a},getType:function(){return this.mType},setType:function(a){this.mType=a},getSubType:function(){return this.mSubType},setSubType:function(a){this.mSubType=a},isCanDrop:function(){return this.mCanDrop},setCanDrop:function(a){this.mCanDrop=a?!0:!1},getNode:function(){return this.mNode&&!this.mNode.destroyed?this.mNode:null},setNode:function(a){var b=0,c=0,d=0,e=null;this.mNode&&!this.mNode.destroyed&&(b=this.mNode.x,c=this.mNode.y,d=this.mNode.zOrder,e=this.mNode.parent,this.mNode.removeSelf(),this.mNode.destroy());(this.mNode=a)&&!this.mNode.destroyed&&(this.mNode.anchorX=.5,this.mNode.anchorY=.5,this.mNode.x=b,this.mNode.y=c,this.mNode.zOrder=d,e&&!e.destroyed&&e.addChild(this.mNode))}});Grid=Class.extend({ctor:function(a){this.mId=this.mCol=this.mRow=0;this.mName="";this.mColTo=this.mRowTo=this.mType=0;a&&(this.mNode=new laya.ui.Image,this.mNode.cacheAs="bitmap",this.mNode.graphics.drawRect(-G.GRID_WIDTH/2,-G.GRID_HEIGHT/2,G.GRID_WIDTH,G.GRID_HEIGHT,"#00ff00"),this.mNode.anchorX=.5,this.mNode.anchorY=.5,this.mNode.alpha=0)},dtor:function(){this.mNode&&(this.mNode.removeSelf(),this.mNode.destroy(),delete this.mNode)},showBackground:function(a){this.mNode.alpha=a?200/255:0},showNumber:function(a){this.mNode&&(a?(this.mNumText||(this.mNumText=new laya.ui.Label,this.mNumText.anchorX=.5,this.mNumText.anchorY=.5,this.mNumText.size(G.GRID_WIDTH,G.GRID_HEIGHT),this.mNumText.wordWrap=!0,this.mNumText.align="center",this.mNumText.valign="middle",this.mNumText.pos(0,0),this.mNumText.color="#0000ff",this.mNumText.fontSize=24,this.mNumText.zOrder=1,this.mNode.addChild(this.mNumText)),this.mNumText.text="("+this.mRow+", "+this.mCol+")"):this.mNumText&&(this.mNumText.removeSelf(),this.mNumText.destroy(),delete this.mNumText))},showName:function(a){this.mNode&&(a?(this.mNameText||(this.mNameText=new laya.ui.Label,this.mNameText.anchorX=.5,this.mNameText.anchorY=.5,this.mNameText.size(G.GRID_WIDTH,G.GRID_HEIGHT),this.mNameText.wordWrap=!0,this.mNameText.align="center",this.mNameText.valign="middle",this.mNumText.pos(0,0),this.mNameText.color="#ff0000",this.mNameText.fontSize=20,this.mNameText.bold=!0,this.mNameText.zOrder=2,this.mNode.addChild(this.mNameText)),this.mNameText.text=this.mName):this.mNameText&&(this.mNameText.removeFromParent(),delete this.mNameText))},getCoord:function(){return{row:this.mRow,col:this.mCol}},setCoord:function(a,b){this.mRow=a;this.mCol=b},getId:function(){return this.mId},setId:function(a){this.mId=a},getName:function(){return this.mName},setName:function(a){this.mName=a},getType:function(){return this.mType},setType:function(a){this.mType=a},getCoordTo:function(){return{row:this.mRowTo,col:this.mColTo}},setCoordTo:function(a,b){this.mRowTo=a;this.mColTo=b},getNode:function(){return this.mNode}});function ItemClear(){ItemClear.__super.call(this);this.size(141,50);this.mBgImg=new laya.ui.Image;this.addChild(this.mBgImg);this.setBg=function(a){this.mBgImg.skin=a};this.mNumLabel=new laya.ui.Label("");this.mNumLabel.align="center";this.mNumLabel.valign="middle";this.mNumLabel.color="#fec840";this.mNumLabel.stroke=1;this.mNumLabel.strokeColor="#4d1d27";this.mNumLabel.fontSize=20;this.mNumLabel.bold=!0;this.mNumLabel.italic=!0;this.mBgImg.addChild(this.mNumLabel);this.setNum=function(a){this.mNumLabel.text=a+"X";this.mNumLabel.anchorX=1;this.mNumLabel.anchorY=.5;this.mNumLabel.pos(40,25)};this.mImg=new laya.ui.Image;this.mImg.scaleX=.6;this.mImg.scaleY=.6;this.mImg.anchorX=.5;this.mImg.anchorY=.5;this.mImg.pos(65,25);this.mBgImg.addChild(this.mImg);this.setImg=function(a){this.mImg.skin=a};this.mScoreLabel=new laya.ui.Label;this.mScoreLabel.align="center";this.mScoreLabel.valign="middle";this.mScoreLabel.color="#fff7c5";this.mScoreLabel.stroke=1;this.mScoreLabel.strokeColor="#4b1b27";this.mScoreLabel.fontSize=20;this.mScoreLabel.bold=!0;this.mScoreLabel.italic=!0;this.mBgImg.addChild(this.mScoreLabel);this.setScore=function(a){a=parseFloat((a+"").replace(/[^\d\.-]/g,"")).toFixed(2)+"";this.mScoreLabel.text=a;this.mScoreLabel.anchorX=0;this.mScoreLabel.anchorY=.5;this.mScoreLabel.pos(90,25)}}Laya["class"](ItemClear,"ItemClear",laya.ui.Box);UIAuto=UIDEFINE("UIAuto",AutoUI);UIAuto.onStart=function(a){this.onClick(this.getChild("btn_stake_left"),this.onClickBtnStakeLeft,this,!0,!0);this.onClick(this.getChild("btn_stake_right"),this.onClickBtnStakeRight,this,!0,!0);this.onClick(this.getChild("btn_stake1"),this.onClickBtnStake,this,!0,!0);this.onClick(this.getChild("btn_stake2"),this.onClickBtnStake,this,!0,!0);this.onClick(this.getChild("btn_stake3"),this.onClickBtnStake,this,!0,!0);this.onClick(this.getChild("btn_times_left"),this.onClickBtnTimesLeft,this,!0,!0);this.onClick(this.getChild("btn_times_right"),this.onClickBtnTimesRight,this,!0,!0);this.onClick(this.getChild("btn_times1"),this.onClickBtnTimes,this,!0,!0);this.onClick(this.getChild("btn_times2"),this.onClickBtnTimes,this,!0,!0);this.onClick(this.getChild("btn_times3"),this.onClickBtnTimes,this,!0,!0);this.onClick(this.getChild("btn_times4"),this.onClickBtnTimes,this,!0,!0);this.onClick(this.getChild("btn_cancel"),this.onClickBtnCancel,this,!0,!0);this.onClick(this.getChild("btn_start"),this.onClickBtnStart,this,!0,!0);this.mCoin=a;this.mTimesIdx=this.mStakeIdx=1;this.initStake();this.initTimes()};UIAuto.onClickBtnStakeLeft=function(a){this.mStakePage.isCanMovePrev()&&(this.mStakeList=this.mStakePage.moveOnePrev(),this.refreshStakeBtnStatus());UIGame.onClickBtnLeft()};UIAuto.onClickBtnStakeRight=function(a){this.mStakePage.isCanMoveNext()&&(this.mStakeList=this.mStakePage.moveOneNext(),this.refreshStakeBtnStatus());UIGame.onClickBtnRight()};UIAuto.onClickBtnStake=function(a){var b=this.mStakePage.getBeginIndex()+a.tag;b!=this.mStakeIdx&&(this.mStakeIdx=b,this.refreshStakeBtnStatus());UIGame.onClickBtnStake(a)};UIAuto.onClickBtnTimesLeft=function(a){this.mTimesPage.isCanMovePrev()&&(this.mTimesList=this.mTimesPage.moveOnePrev(),this.refreshTimesBtnStatus())};UIAuto.onClickBtnTimesRight=function(a){this.mTimesPage.isCanMoveNext()&&(this.mTimesList=this.mTimesPage.moveOneNext(),this.refreshTimesBtnStatus())};UIAuto.onClickBtnTimes=function(a){a=this.mTimesPage.getBeginIndex()+a.tag;a!=this.mTimesIdx&&(this.mTimesIdx=a,this.refreshTimesBtnStatus())};UIAuto.onClickBtnCancel=function(a){this.close()};UIAuto.onClickBtnStart=function(a){a=G.TIMES_LIST[this.mTimesIdx-1];console.log("\u4e0b\u6ce8: "+G.STAKE_LIST[this.mStakeIdx-1]+", \u6b21\u6570: "+a);UIGame.onClickBtnStart(null,a,function(a){a&&this.close()},this)};UIAuto.initStake=function(){this.mStakePage=Page.create(G.STAKE_LIST,3,0);this.mStakeList=this.mStakePage.moveToIndex(this.mStakeIdx-1);this.refreshStakeBtnStatus()};UIAuto.refreshStakeBtnStatus=function(){var a=this.getChild("btn_stake_left");this.mStakePage.isCanMovePrev()?(a.mouseEnabled=!0,a.gray=!1):(a.mouseEnabled=!1,a.gray=!0);a=this.getChild("btn_stake_right");this.mStakePage.isCanMoveNext()?(a.mouseEnabled=!0,a.gray=!1):(a.mouseEnabled=!1,a.gray=!0);for(var b=this.mStakePage.getBeginIndex(),a=1;a<=this.mStakePage.getNumPerPage();++a){var c=this.getChild("btn_stake"+a);c.tag=a;c.timer.callLater(this,function(a,c){var f=this.mStakeList[a-1];isNaN(f)?c.visible=!1:(c.visible=!0,c.label=f,f<=this.mCoin?(c.mouseEnabled=!0,c.gray=!1,b+a==this.mStakeIdx?(c.skin="ui/button_bet_01.png",c.labelColors="#633b29"):(c.skin="ui/button_bet_02.png",c.labelColors="#F0B137")):(c.mouseEnabled=!1,c.gray=!0,c.skin="ui/button_bet_02.png",c.labelColors="#F0B137"))},[a,c])}};UIAuto.initTimes=function(){this.mTimesPage=Page.create(G.TIMES_LIST,4,0);this.mTimesList=this.mTimesPage.moveToIndex(this.mTimesIdx-1);this.refreshTimesBtnStatus()};UIAuto.refreshTimesBtnStatus=function(){var a=this.getChild("btn_times_left");this.mTimesPage.isCanMovePrev()?(a.mouseEnabled=!0,a.gray=!1):(a.mouseEnabled=!1,a.gray=!0);a=this.getChild("btn_times_right");this.mTimesPage.isCanMoveNext()?(a.mouseEnabled=!0,a.gray=!1):(a.mouseEnabled=!1,a.gray=!0);for(var b=this.mTimesPage.getBeginIndex(),a=1;a<=this.mTimesPage.getNumPerPage();++a){var c=this.getChild("btn_times"+a);c.tag=a;c.timer.callLater(this,function(a,c){var f=this.mTimesList[a-1];isNaN(f)?c.visible=!1:(c.visible=!0,c.label=f,c.mouseEnabled=!0,c.gray=!1,b+a==this.mTimesIdx?(c.skin="ui/button_times_01.png",c.labelColors="#633b29"):(c.skin="ui/button_times_02.png",c.labelColors="#fff7c5"))},[a,c])}};UIGame=UIDEFINE("UIGame",GameUI);UIGame.onStart=function(){this.ladyBirdAction();this.onClick(this.getChild("btn_set"),this.onClickBtnSet,this,!0,!0);this.onClick(this.getChild("btn_start"),this.onClickBtnStart,this,!0,!0);this.onClick(this.getChild("btn_auto"),this.onClickBtnAuto,this,!0,!0);this.onClick(this.getChild("btn_left"),this.onClickBtnLeft,this,!0,!0);this.onClick(this.getChild("btn_right"),this.onClickBtnRight,this,!0,!0);this.onClick(this.getChild("btn_stake1"),this.onClickBtnStake,this,!0,!0);this.onClick(this.getChild("btn_stake2"),this.onClickBtnStake,this,!0,!0);this.onClick(this.getChild("btn_stake3"),this.onClickBtnStake,this,!0,!0);this.onClick(this.getChild("btn_charge"),this.onClickBtnCharge,this,!0,!0);if(G.SHOW_FPS)this.onClick(this.getChild("image_small_map"),this.onClickImageSmallMap,this,!0,!0);this.bind(EventDef.ED_PROGRESS_BONUS1,this.updateProgress);this.bind(EventDef.ED_PROGRESS_BONUS2,this.bonus2Up);this.bind(EventDef.ED_ADD_TO_LIST,this.onAddToList);this.bind(EventDef.ED_ON_BONUS,this.onBonus);this.bind(EventDef.ED_LEVEL_INFO,this.updateLevelInfo);this.bind(EventDef.ED_LEVEL_CLEAR,this.levelReset);this.bind(EventDef.ED_LEVEL_COIN,this.updateTimesCoin);this.bind(EventDef.ED_LEVEL_AUTO_TIMES,this.updateLeftTimes);this.mCoin=1E3;this.mAward=0;this.mStake=this.mStakeIdx=1;this.changeMainAreaZOrder();this.initStake();this.initList();this.updateCoin(0);this.updateAward(0);this.resetProgress();this.drawBonus2Box();Controller.getComp("ControllerMinimap").show(this.getChild("image_small_map"),29,40,!0);Controller.onLevel(!0,!0);this.setStartBtnState(!1);Controller.onInitDrop(function(){this.setStartBtnState(!0);UINewGuide.openFront(!0,!0,!1)},this)};UIGame.onClickBtnCharge=function(){console.log("\u70b9\u51fb\u5145\u503c\u4e86++++++++++++++++++++")};UIGame.changeMainAreaZOrder=function(){var a=this.getChild("image_main_area");if(a){var b=Controller.getView().getMapLayer();if(b){var c=laya.getWorldPosition(a),c=laya.getLocalPosition(b,c);a.pos(c.x,c.y);laya.changeParent(a,b)}}};UIGame.setLevelName=function(a){this.getChild("label_level").text=a};UIGame.getLevelStarInfo=function(a,b){var c=[],d=DataTB.get("level_tplt",a,!0),e=b;3<=e&&(e=1);var f=DataTB.get("level_tplt",a,!0);c[0]=d.name+"-"+(b-1);c[1]=f.name+"-"+e;return c};UIGame.starAction=function(a){var b=laya.createArmature(ResURL("ditushengji.png"),ResURL("ditushengji.sk"),!1,null,null,function(){b.removeSelf();b.destroy();a.skin="ui/image_star.png"},this);b.anchorX=0;b.anchorY=0;b.play("ue_level_star",!1);b.pos(16,17);a.addChild(b)};UIGame.levelUpAction=function(a){var b=laya.createArmature(ResURL("ditushengji.png"),ResURL("ditushengji.sk"),!1,null,null,function(){b.removeSelf();b.destroy();a.apply(this,[])},this);b.anchorX=0;b.anchorY=0;b.play("ui_levelup",!1);b.pos(850,320);this.node.addChild(b)};UIGame.levelPassAction=function(a){var b=laya.createArmature(ResURL("guanqiaguoguan.png"),ResURL("guanqiaguoguan.sk"),!1,null,null,function(){b.removeSelf();b.destroy();a.apply(this,[])},this);b.anchorX=0;b.anchorY=0;b.play("ui_mission_clear",!1);b.pos(490,250);this.node.addChild(b)};UIGame.setLevelStar=function(a,b){for(var c=1;c<=G.MAX_STAR;++c){var d=this.getChild("image_star"+c);c>a?d.skin="ui/image_star_gray.png":c>(this.mLastStar||1)?(this.starAction(d,c),d=this.getLevelStarInfo(b,a),UILevelUp.openFront(!0,!0,!0,d)):d.skin="ui/image_star.png"}this.mLastStar=a};UIGame.formatMoney=function(a,b){b=isNaN(b)||0>b||20<b?0:b;a=parseFloat((a+"").replace(/[^\d\.-]/g,"")).toFixed(b)+"";for(var c=a.split(".")[0].split("").reverse(),d=a.split(".")[1],e="",f=0;f<c.length;++f)e+=c[f]+(0==(f+1)%3&&f+1!=c.length?",":"");return e.split("").reverse().join("")+(d?"."+d:"")};UIGame.updateCoin=function(a){a=isNaN(a)?0:a;if(a>this.mCoin)return!1;this.mCoin-=a;this.getChild("label_coin").text=this.formatMoney(this.mCoin,2);return!0};UIGame.updateTimesCoin=function(a){1==a?this.updateCoin(-this.mAward):2==a&&this.updateCoin(this.mStake)};UIGame.getAwardActionIndex=function(a){a/=this.mStake;if(0==a)return 0;if(a>=G.AWARD_TIMES[G.AWARD_TIMES.length-1])return G.AWARD_TIMES.length;for(var b in G.AWARD_TIMES)if(G.AWARD_TIMES[b]>=a)return parseInt(b)+1;return 0};UIGame.updateAward=function(a){a=isNaN(a)?0:a;this.mAward+=a;this.getChild("label_award").text=this.formatMoney(this.mAward,2);if(!(0>=a)&&(a=this.getAwardActionIndex(a),0<a)){AudioModel.playSound(2002);var b=laya.createArmature(ResURL("chaoeshouyi.png"),ResURL("chaoeshouyi.sk"),!1,null,null,function(){b.removeSelf();b.destroy()},this);b.anchorX=0;b.anchorY=0;b.play("ui_big_money_"+a,!1);b.pos(130,430);this.node.addChild(b)}};UIGame.updateLevelInfo=function(a,b,c){this.setLevelName(a);this.setLevelStar(b,c)};UIGame.onClickBtnSet=function(a){UISetUp.openFront(!0,!0,!0)};UIGame.updateLeftTimes=function(a){if(1<this.autoStartCount){var b=this.getChild("btn_start");b.skin="ui/button_novalue_01.png";b.label=a}};UIGame.onClickBtnStart=function(a,b,c,d){this.mFisrtEnter=!1;this.autoStartCount=b;b=isNaN(b)?1:b;c="function"==typeof c?c:function(){};this.mStake=G.STAKE_LIST[this.mStakeIdx-1];if(this.mStake>this.mCoin)UIPrompt.show("\u8d44\u91d1\u4e0d\u8db3"),c.apply(d,[!1]);else{this.mSingleStartTimes+=1;this.setStakeBtnsGray(!0);c.apply(d,[!0]);this.clearList();this.resetProgress();var e=this.getChild("btn_start"),f=this.getChild("btn_auto"),g=this.getChild("image_small_map");e.mouseEnabled=!1;e.gray=!0;f.mouseEnabled=!1;f.gray=!0;g.mouseEnabled=!1;e.label="";e.skin="ui/button_start.png";f.skin="ui/button_auto.png";1<b&&(e.label=b-1,e.skin="ui/button_novalue_01.png",f.skin="ui/button_cancel.png",f.gray=!1,f.mouseEnabled=!0);laya.callAfter(.1,function(){Controller.onStart(b,this.levelUpAction,this.levelPassAction,function(){this.resetProgress();this.bonus2Down()},function(){e.mouseEnabled=!0;e.gray=!1;f.mouseEnabled=!0;f.gray=!1;g.mouseEnabled=!0;e.label="";e.skin="ui/button_start.png";f.label="";f.skin="ui/button_auto.png";this.autoStartCount=1;this.setStakeBtnsGray(!1)},this)},this)}};UIGame.restartGame=function(a){var b=this.getChild("btn_start"),c=this.getChild("btn_auto"),d=this.getChild("image_small_map");Controller.onStart(a,this.levelUpAction,this.levelPassAction,function(){this.resetProgress();this.bonus2Down()},function(){b.mouseEnabled=!0;b.gray=!1;c.mouseEnabled=!0;c.gray=!1;d.mouseEnabled=!0;b.label="";b.skin="ui/button_start.png";c.label="";c.skin="ui/button_auto.png";this.autoStartCount=1;this.setStakeBtnsGray(!1)},this)};UIGame.onClickBtnAuto=function(a){if(this.autoStartCount&&1<this.autoStartCount){Controller.onStop();a=this.getChild("btn_start");var b=this.getChild("btn_auto");a.label="";a.skin="ui/button_start.png";b.gray=!0;b.mouseEnabled=!1;b.label="";b.skin="ui/button_auto.png"}else UIAuto.openFront(!0,!0,!0,this.mCoin)};UIGame.onClickBtnLeft=function(a){this.mStakePage.isCanMovePrev()&&(this.mStakeList=this.mStakePage.moveOnePrev(),this.refreshStakeBtnStatus())};UIGame.onClickBtnRight=function(a){this.mStakePage.isCanMoveNext()&&(this.mStakeList=this.mStakePage.moveOneNext(),this.refreshStakeBtnStatus())};UIGame.onClickBtnStake=function(a){a=this.mStakePage.getBeginIndex()+a.tag;a!=this.mStakeIdx&&(this.mStakeIdx=a,this.refreshStakeBtnStatus())};UIGame.setStakeBtnsGray=function(a){var b=this.mStakePage.getBeginIndex();if(this.mStakeIdx<b+1||this.mStakeIdx>b+3)this.mStakeList=this.mStakePage.moveToIndex(this.mStakeIdx-1),b=this.mStakePage.getBeginIndex();var c=this.getChild("btn_left"),d=this.getChild("btn_right");c.mouseEnabled=!a;c.gray=a;d.mouseEnabled=!a;if(d.gray=a)for(a=1;a<=this.mStakePage.getNumPerPage();++a)c=this.getChild("btn_stake"+a),c.label=this.mStakeList[a-1],b+a==this.mStakeIdx?(c.mouseEnabled=!1,c.gray=!1):(c.mouseEnabled=!1,c.gray=!0);else this.refreshStakeBtnStatus()};UIGame.onClickImageSmallMap=function(a){UIGM.openFront(!0,!0,!0)};UIGame.initStake=function(){this.mStakePage=Page.create(G.STAKE_LIST,3,0);this.mStakeList=this.mStakePage.moveToIndex(this.mStakeIdx-1);this.refreshStakeBtnStatus()};UIGame.refreshStakeBtnStatus=function(){var a=this.getChild("btn_left");this.mStakePage.isCanMovePrev()?(a.mouseEnabled=!0,a.gray=!1):(a.mouseEnabled=!1,a.gray=!0);a=this.getChild("btn_right");this.mStakePage.isCanMoveNext()?(a.mouseEnabled=!0,a.gray=!1):(a.mouseEnabled=!1,a.gray=!0);for(var b=this.mStakePage.getBeginIndex(),a=1;a<=this.mStakePage.getNumPerPage();++a){var c=this.getChild("btn_stake"+a);c.tag=a;c.timer.callLater(this,function(a,c){var f=this.mStakeList[a-1];isNaN(f)?c.visible=!1:(c.visible=!0,c.label=f,f<=this.mCoin?(c.mouseEnabled=!0,c.gray=!1,b+a==this.mStakeIdx?(c.skin="ui/button_bet_01.png",c.labelColors="#633b29"):(c.skin="ui/button_bet_02.png",c.labelColors="#F0B137")):(c.mouseEnabled=!1,c.gray=!0,c.skin="ui/button_bet_02.png",c.labelColors="#F0B137"))},[a,c])}};UIGame.initList=function(){this.mList=new laya.ui.List;this.mList.itemRender=ItemClear;this.mList.vScrollBarSkin="";this.mList.array=[];this.mList.renderHandler=new laya.utils.Handler(this,this.onUpdateClearItem);this.mList.width=150;this.mList.height=240;this.mList.spaceY=1;this.mList.anchorX=.5;this.mList.anchorY=.5;this.mList.pos(119,213);this.mList.optimizeScrollRect=!0;this.mList.scrollBar.elasticDistance=30;this.getChild("box_left").addChild(this.mList)};UIGame.clearList=function(){this.mList.array=[];this.mAward=0;this.updateAward(0)};UIGame.levelReset=function(){this.clearList();this.resetProgress()};UIGame.addListItem=function(a,b,c,d,e){a=DataModel.calcAwardData(a,b,c,d,e);this.mList.addItem(a);this.mList.scrollTo(this.mList.length);return a.value};UIGame.onUpdateClearItem=function(a,b){var c=a.dataSource;c&&(0==b%2?a.setBg(ResURL("ui/image_score_back_01.png")):a.setBg(ResURL("ui/image_score_back_02.png")),a.setNum(c.count),a.setImg(ResURL(c.image)),a.setScore(c.value))};UIGame.onAddToList=function(a,b,c){var d=0,e=Controller.getLevelId(),f;for(f in c)c.hasOwnProperty(f)&&(d+=this.addListItem(e,a,b,f,c[f]));d*=this.mStake;this.updateAward(d)};UIGame.updateProgress=function(a){a=isNaN(a)||0>a?0:a;a/=G.BONUS_1;this.mProgress.setValue(1<a?1:a,!0)};UIGame.resetProgress=function(){if(!this.mProgress||this.mProgress.destroyed)this.mProgress=laya.createProgress(ResURL("image_progress_bg.png"),ResURL("image_progress_bar.png"),ResURL("image_progress_mask.png"),1.5),this.mProgress.rotation=270,this.mProgress.pos(230,380),this.node.addChild(this.mProgress);this.mProgress.setValue(0)};UIGame.onBonus=function(a){game_section.bonus1==a?this.resetProgress():game_section.bonus1==a&&this.bonus2Down()};UIGame.drawBonus2Box=function(){this.mBonus2Box=laya.createArmature(ResURL("b2zhuangtaidonghua.png"),ResURL("b2zhuangtaidonghua.sk"),!1,null,null,null,this);this.mBonus2Box.pos(850,235);this.node.addChild(this.mBonus2Box);this.mBonus2Box.play("ui_bonus02_1",!0)};UIGame.bonus2Up=function(a){console.log("bonus2\u5237\u5c4f, times: "+a);this.mBonus2Box.play("ui_bonus02_"+(a+1)+"_sheng",!1);4<=a&&this.mBonus2Box.play("ui_bonus02_5_xunhuan",!0);this.mBonusTimes=a};UIGame.bonus2Down=function(){4<=this.mBonusTimes&&this.mBonus2Box.stop("ui_bonus02_5_xunhuan",!1);0<this.mBonusTimes&&(this.mBonus2Box.play("ui_bonus02_"+(this.mBonusTimes+1)+"_jiang",!1),this.mBonusTimes=0)};UIGame.setStartBtnState=function(a){var b=this.getChild("btn_start"),c=this.getChild("btn_auto");b.gray=!a;b.mouseEnabled=a;c.gray=!a;c.mouseEnabled=a};UIGame.loopAction=function(a){laya.scaleFromTo(a,1,1,.8,.5,function(){laya.scaleFromTo(a,1,.8,1,.6,null,null)},null);laya.moveBy(a,{x:0,y:-20},.5,null,function(){laya.moveBy(a,{x:0,y:20},.5,null,function(){this.loopAction(a)},this)},this)};UIGame.ladyBirdAction=function(){var a=laya.createArmature(ResURL("piaochong.png"),ResURL("piaochong.sk"),!1,null,null,function(){a.removeSelf();a.destroy();laya.callAfter(G.LADY_BIRD_DELAY,this.ladyBirdAction,this)},this);a.play("ladybird",!1);a.zOrder=500;this.node.addChild(a);a.pos(480,60)};UIGM=UIDEFINE("UIGM",GMUI);UIGM.onStart=function(a){this.onClick(this.getChild("btn_close"),this.onClickBtnClose,this,!0,!0);this.onClick(this.getChild("btn_start"),this.onClickBtnStart,this,!0,!0);this.bind(EventDef.ED_ADD_TO_LIST,this.onAddToList);UIGame.close();Controller.create(!1);Controller.onLevel(!0,!0);this.mIsMusicOn=AudioModel.isMusicEnabled();this.mIsSoundOn=AudioModel.isSoundEnabled();AudioModel.setMusicEnabled(!1);AudioModel.setSoundEnabled(!1)};UIGM.onClickBtnClose=function(a){AudioModel.setMusicEnabled(this.mIsMusicOn);AudioModel.setSoundEnabled(this.mIsSoundOn);this.close();Controller.create(!0);UIGame.openMiddle()};UIGM.onClickBtnStart=function(a){this.mAward=0;var b=this.getChild("textinput_stake");this.mStake=parseInt(b.text);this.mStake=isNaN(this.mStake)?1:Math.abs(this.mStake);b.text=this.mStake;b.mouseEnabled=!1;var c=this.getChild("textinput_count");this.mCount=parseInt(c.text);this.mCount=isNaN(this.mCount)?1:Math.abs(this.mCount);c.text=this.mCount;c.mouseEnabled=!1;var d=this.getChild("label_award_total");d.text=0;var e=this.getChild("label_award_per");e.text=0;var f=this.getChild("label_cost_time");f.text="\u6a21\u62df\u4e2d, \u8bf7\u7a0d\u7b49 ......";var g=this.getChild("btn_close");g.mouseEnabled=!1;g.gray=!0;var h=this.getChild("btn_start");h.mouseEnabled=!1;h.gray=!0;Controller.create(!1);Controller.onLevel(!0,!0);laya.callAfter(.1,function(){var a=laya.utils.Browser.now();Controller.onStart(this.mCount,null,null,null,function(){b.mouseEnabled=!0;c.mouseEnabled=!0;g.mouseEnabled=!0;g.gray=!1;h.mouseEnabled=!0;h.gray=!1;d.text=this.mAward;e.text=this.mAward/this.mCount;f.text=this.calcTime(a)},this)},this)};UIGM.calcTime=function(a){a=(laya.utils.Browser.now()-a)/1E3;var b=Math.floor(a/3600);0<b&&(a%=3600);var c=Math.floor(a/60);0<c&&(a/=60);return b+"\u65f6"+c+"\u5206"+a+"\u79d2"};UIGM.onAddToList=function(a,b,c){var d=0,e=Controller.getLevelId(),f;for(f in c)if(c.hasOwnProperty(f))var g=DataModel.calcAwardData(e,a,b,f,c[f]),d=d+g.value;d*=this.mStake;this.mAward+=d};UIPrompt=UIDEFINE("UIPrompt");UIPrompt.show=function(a){this.openTop();if("string"==typeof a&&0!=a.length){a=new laya.ui.Label(a);a.align="center";a.valign="middle";a.color="#fd7878";a.fontSize=26;a.anchorX=.5;a.anchorY=.5;var b=a.width+20,c=a.height+20;a.pos((b+120)/2,c/2);var d=new laya.ui.Image(ResURL("image_bg_prompt.png"));d.anchorX=.5;d.anchorY=.5;d.width=b+120;d.height=c+3;d.sizeGrid="5,15,5,15,0";d.pos(Laya.stage.width/2,Laya.stage.height/2);d.addChild(a);this.node.addChild(d);b=d.y-150;laya.runAction(a,[{props:{},duration:1.2},{props:{alpha:0},duration:1.5}]);laya.runAction(d,[{props:{y:b},duration:.6},{props:{},duration:.6},{props:{alpha:0},duration:1.5}],function(){d&&!d.destroyed&&(d.removeSelf(),d.destroy())},this)}};UIResLoading=UIDEFINE("UIResLoading");UIResLoading.onStart=function(a,b){ResourceLoad([{url:ResURL("image_progress_bar.png"),type:laya.net.Loader.IMAGE},{url:ResURL("image_progress_bg.png"),type:laya.net.Loader.IMAGE},{url:ResURL("image_progress_mask.png"),type:laya.net.Loader.IMAGE},{url:ResURL("image_res_loading_bg.png"),type:laya.net.Loader.IMAGE}],null,function(){this.initUI();a.apply(b,[])},null,this);this.bind(EventDef.ED_RES_LOADING,this.updateProgress)};UIResLoading.initUI=function(){var a=this.node.x,b=this.node.y,c=new laya.ui.Image(ResURL("image_res_loading_bg.png"));c.anchorX=.5;c.anchorY=.5;c.pos(a,b+c.height/2);this.node.addChild(c);this.mProgress=laya.createProgress(ResURL("image_progress_bg.png"),ResURL("image_progress_bar.png"),ResURL("image_progress_mask.png"),0);this.mProgress.pos(a-this.mProgress.width/2,c.y+10);this.node.addChild(this.mProgress);this.mLabel=new laya.ui.Label("");this.mLabel.anchorX=.5;this.mLabel.anchorY=.5;this.mLabel.pos(a,this.mProgress.y-30);this.mLabel.fontSize=28;this.mLabel.color="#ffffff";this.node.addChild(this.mLabel)};UIResLoading.updateProgress=function(a){var b=Math.floor(100*a).toString();this.mProgress.setValue(a,!1);this.mLabel.anchorX=.5;this.mLabel.anchorY=.5;this.mLabel.text=b+"%"};UISetUp=UIDEFINE("UISetUp",SetUpUI);UISetUp.onStart=function(){this.onClick(this.getChild("btn_close"),function(){this.close()},this,!0,!0);var a=AudioModel.isMusicEnabled(),b=this.getChild("btn_music");this.loadSkinByState(b,a);this.onClick(this.getChild("btn_music"),function(){a=!a;AudioModel.setMusicEnabled(a);a&&AudioModel.playMusic(1001);UISetUp.loadSkinByState(b,a)},this["true"],!0);var c=AudioModel.isSoundEnabled(),d=this.getChild("btn_effect");this.loadSkinByState(d,c);this.onClick(this.getChild("btn_effect"),function(){c=!c;AudioModel.setSoundEnabled(c);UISetUp.loadSkinByState(d,c)},this,!0,!0);var e=this.getChild("btn_des");this.onClick(e,function(){UIGamePlayDes.openFront(!0,!0,!0)},this,!0,!0)};UISetUp.loadSkinByState=function(a,b){"btn_effect"==a.name?(a.pos(557,200),a.skin="ui/button_switch_02.png",b&&(a.pos(607,200),a.skin="ui/button_switch_01.png")):"btn_music"==a.name&&(a.pos(346,200),a.skin="ui/button_switch_02.png",b&&(a.pos(392,200),a.skin="ui/button_switch_01.png"))};var DEFAULT_DIR="res/atlas/",AUDIO_DIR="res/Audio/",EFFECT_DIR="res/Effect/",FONT_DIR="res/Font/",PICTURE_DIR="res/Picture/",ROLE_DIR="res/Role/",ResourceConfig={atlas:[{url:DEFAULT_DIR+"comp.json",type:laya.net.Loader.ATLAS},{url:DEFAULT_DIR+"ui.json",type:laya.net.Loader.ATLAS}],audio:[{url:AUDIO_DIR+"background.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"button_click.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"Connect_1.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"Connect_2.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"Connect_3.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"Connect_4.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"Connect_5.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"Connect_6.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_element_change.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_element_clear.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_element_drop.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_element_fix.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_element_match.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_skill_cast.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_skill_rainbow.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_skill_ray.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_skill_swop.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_skill_walk.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_bonus_1.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_bonus_2_1.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_bonus_2_2.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_bonus_2_3.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_bonus_2_4.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_click.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_coin.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_level_clear.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_ui_level_up.mp3",type:laya.net.Loader.SOUND},{url:AUDIO_DIR+"se_wild.mp3",type:laya.net.Loader.SOUND}],effect:[{url:EFFECT_DIR+"b2zhuangtaidonghua.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"b2zhuangtaidonghua.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"baida.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"baida.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"bounstishi.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"bounstishi.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"caihongxiao.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"caihongxiao.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"chaoeshouyi.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"chaoeshouyi.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"ditushengji.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"ditushengji.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"duijiaobianse.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"duijiaobianse.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"guanqiaguoguan.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"guanqiaguoguan.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"piaochong.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"piaochong.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"quanpingsuijixiaochu.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"quanpingsuijixiaochu.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"shizixiaozhuangtai.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"shizixiaozhuangtai.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"suijimanbu.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"suijimanbu.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"suijitihuan.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"suijitihuan.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"xzixiao.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"xzixiao.sk",type:laya.net.Loader.BUFFER},{url:EFFECT_DIR+"yuansuxiaochu.png",type:laya.net.Loader.IMAGE},{url:EFFECT_DIR+"yuansuxiaochu.sk",type:laya.net.Loader.BUFFER}],font:[],picture:[{url:PICTURE_DIR+"image_bg_gray.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_bg_prompt.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_desc_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_desc_03.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_desc_04.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_desc_05.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_desc_06.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_desc_07.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_desc_08.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_titile_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_titile_03.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_titile_04.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_titile_05.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_titile_06.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_titile_07.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lelve_titile_08.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_lockUp.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_attach_corss.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_attach_oblique.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_bg_001.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_bg_002.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_bg_003.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_bg_004.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_bg_005.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_bg_006.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_bg_007.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_blue_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_blue_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_green_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_green_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_pink_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_pink_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_boundary_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_boundary_03.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_plum_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_plum_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_purple_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_purple_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_red_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_red_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_wail_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_wail_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_yellow_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_object_normal_yellow_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_overlay_fixed.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_surface_glass_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_map_surface_glass_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_progress_bar.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_progress_bar_top.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_progress_bg.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_progress_mask.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_res_loading_bg.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_shizixiaolashen.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_small_map_gird.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_small_map_gird_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_small_map_gird_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_01.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_03.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_04.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_05.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_06.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_07.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_08.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_t_descrip_09.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_utorial_02.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_utorial_03.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_utorial_04.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_utorial_05.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_utorial_06.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_utorial_07.png",type:laya.net.Loader.IMAGE},{url:PICTURE_DIR+"image_utorial_08.png",type:laya.net.Loader.IMAGE}],role:[]},mResourceConfig=ResourceConfigParse(ResourceConfig);function ResourceConfigParse(a){try{var b={},c={},d;for(d in a)if(a.hasOwnProperty(d)){c[d]={};for(var e=0,f=a[d].length;e<f;++e){var g;var h=a[d][e].url,k=h.lastIndexOf("/");g=-1==k?h:h.substring(k+1,h.length);if(b[g])throw Error("exist same resource '"+g+"'in config");b[g]=!0;c[d][g]=a[d][e]}}return c}catch(l){alert(l.stack)}}function ResURL(a){for(var b in mResourceConfig)if(mResourceConfig.hasOwnProperty(b)&&mResourceConfig[b][a])return mResourceConfig[b][a].url;return a}function ResourceLoad(a,b,c,d,e){a instanceof Array||(a=[a]);0==a.length?"function"==typeof c&&c.apply(e,[]):(Laya.loader.retryNum=3,Laya.loader.load(a,laya.utils.Handler.create(this,function(){"function"==typeof c&&c.apply(e,[])}),laya.utils.Handler.create(this,function(a){"function"==typeof b&&b.apply(e,[a])},null,!1)),Laya.loader.on(laya.events.Event.ERROR,this,function(a){"function"==typeof d&&d.apply(e,[a])}))}function ResourceConfigLoad(a,b,c,d,e){a instanceof Array||(a=[a]);for(var f=[],g=0,h=a.length;g<h;++g){var k=a[g],l;for(l in mResourceConfig[k])mResourceConfig[k].hasOwnProperty(l)&&f.push(mResourceConfig[k][l])}ResourceLoad(f,b,c,d,e)}function loadResource(a,b){UIResLoading.openFront(!0,!1,!1,function(){console.log("\u5f00\u59cb\u52a0\u8f7d");ResourceConfigLoad("atlas audio effect font picture role".split(" "),function(a){console.log("\u52a0\u8f7d\u8fdb\u5ea6: "+a);EventCenter.post(EventDef.ED_RES_LOADING,a)},function(){console.log("\u52a0\u8f7d\u7ed3\u675f");EventCenter.post(EventDef.ED_RES_LOADING,1);Laya.timer.once(200,this,function(){UIResLoading.close();a.apply(b,[])})},function(a){alert(a)},this)},this)}G={SHOW_FPS:!1,DESIGN_WIDTH:960,DESIGN_HEIGHT:720,MAP_ROW:6,MAP_COL:6,GRID_WIDTH:66,GRID_HEIGHT:66,GRID_GAP:0,GRID_TOUCH_GAP:0,VIEW_OFFSET_X:12,VIEW_OFFSET_Y:-195,DROP_FIRST_GAP:.05,DROP_FIRST_TIME:.15,DROP_TIME:.2,DROP_LAST_TIME:.15,DROP_LAST_GAP:.1,CLEAR_COUNT:5,MAX_TIMES:30,FIRST_LEVEL_ID:1001,MAX_STAR:3,STAKE_LIST:[1,2,5,10,20,50,100,200,500],TIMES_LIST:[5,10,15,20,25,30,35,40],BONUS_1:20,BONUS_2:4,ELEMENT_PRICE:{20101:12,20102:10,20103:8,20104:6,20105:5,20106:3,20107:2,20108:0},SKILL_OBLIQUE_COUNT:6,SKILL_CROSS_COUNT:7,AWARD_TIMES:[1,2,4],LADY_BIRD_DELAY:5,LEVEL_UP_STAY:1.5,LEVEL_UP_FADE:1};Game={createBaseNodes:function(){function a(a,b,e){a.size(Laya.stage.width,Laya.stage.height);a.anchorX=.5;a.anchorY=.5;a.pos(Laya.stage.width/2,Laya.stage.height/2);"number"==typeof b&&(a.zOrder=b);a.mouseEnabled=!0;a.mouseThrough=!0;e&&e.addChild(a)}var b={root:new laya.ui.Component,back:new laya.ui.Component,scene:new laya.ui.Component,middle:new laya.ui.Component,front:new laya.ui.Component,top:new laya.ui.Component};a(b.root);a(b.back,1,b.root);a(b.scene,2,b.root);a(b.middle,3,b.root);a(b.front,4,b.root);a(b.top,5,b.root);return b},init:function(){try{var a=this.createBaseNodes();this.NODE_UI_BACK=a.back;this.NODE_SCENE=a.scene;this.NODE_UI_MIDDLE=a.middle;this.NODE_UI_FRONT=a.front;this.NODE_UI_TOP=a.top;Laya.stage.addChild(a.root);G.SHOW_FPS&&laya.utils.Stat.show();loadResource(this.run,this)}catch(b){alert(b.stack)}},run:function(){try{DataTB.init(core_data_tplt_list),DataTB.reload("audio_tplt",audio_tplt),DataTB.reload("effect_tplt",effect_tplt),DataTB.reload("level_tplt",level_tplt),DataTB.reload("map_tplt",map_tplt),AudioModel.init(),Controller.create(!0),UIGameDes.openFront(!0,!0,!0)}catch(a){alert(a.stack)}}};var Loader=laya.net.Loader,Handler=laya.utils.Handler;Laya.init(G.DESIGN_WIDTH,G.DESIGN_HEIGHT,Laya.WebGL);Laya.stage.scaleMode="fixedwidth";Laya.stage.screenMode="horizontal";Laya.stage.alignH="center";Laya.stage.alignV="middle";Game.init();UIGameDes=UIDEFINE("UIGameDes",GameDesUI);UIGameDes.onStart=function(){this.getChild("img_background").skin=ResURL("image_map_bg_004.png");this.onClick(this.getChild("btn_sure"),this.onClickBtnSure,this,!0,!0);for(var a=[2,3,4,5,6],b=2;3>=b;b++){var c=this.getChild("img_des_"+b),d=Math.floor(Math.random()*(a.length-1)+.5);c.skin=ResURL("image_utorial_0"+a[d]+".png");a.splice(d,1)}this.loopAction(this.getChild("btn_sure"))};UIGameDes.onClickBtnSure=function(){this.close();UIGame.openMiddle()};UIGameDes.loopAction=function(a){var b=[1.1,.9];laya.scaleFromTo(a,0,1,b[0],.3,function(){laya.scaleFromTo(a,0,b[0],1,.3,function(){laya.scaleFromTo(a,0,1,b[1],.3,function(){laya.scaleFromTo(a,0,b[1],1,.3,function(){UIGameDes.loopAction(UIGameDes.getChild("btn_sure"))},null)},null)},null)},null)};UILevelDes=UIDEFINE("UILevelDes",LevelDesUI);UILevelDes.onStart=function(a){this.paramArr=a;this.onClick(this.getChild("btn_close"),this.onClickBtnClose,this,!0,!0);this.getChild("img_title").skin=ResURL("image_lelve_titile_0"+a[0]+".png");this.getChild("img_content").skin=ResURL("image_lelve_desc_0"+a[0]+".png")};UILevelDes.onClickBtnClose=function(){UIGame.restartGame(this.paramArr[1]);this.close()};UIOriTip=UIDEFINE("UIOriTip");UIOriTip.onStart=function(){var a=new laya.ui.Image;a.skin=ResURL("image_lockUp.png");a.pos(0,-100);a.size(960,840);a.anchorX=0;a.anchorY=0;a.sizeGrid="0,0,0,0,0";this.mTopImg=a;this.node.addChild(a);this.root.zOrder=100};UILevelUp=UIDEFINE("UILevelUp",LevelUpUI);UILevelUp.onStart=function(a){this.getChild("label_level_now").text="\u606d\u559c\u60a8\u901a\u8fc7"+a[0]+"!";this.getChild("label_level_next").text="\u63a5\u4e0b\u6765\u60a8\u5c06\u6311\u6218"+a[1]+"!";this.onClick(this.root,function(){this.close()},this,!1,!0);laya.callAfter(G.LEVEL_UP_STAY,function(){this.root&&laya.fadeOut(this.root,G.LEVEL_UP_FADE,function(){this.close()},this)},this)};UINewGuide=UIDEFINE("UINewGuide",NewGuideUI);UINewGuide.onStart=function(a){this.getChild("game_bg").skin=ResURL("image_map_bg_001.png");this.uiNode=this.getChild("box_middle");this.steps=a||1;this.setImageWord();1==this.steps?this.createStakeGuide():2==this.steps?this.createStartGuide():3==this.steps?this.createAutoGuide():4==this.steps?this.createAwardGuide():5==this.steps?this.createProgressGuide():6==this.steps&&this.createBottleGuide();this.onClick(this.getChild("game_touch"),function(){var a=this.steps+1;this.close();7>a&&UINewGuide.openFront(!0,!0,!1,a)},this,!1,!0);Laya.stage.on("mousemove",this,function(){})};UINewGuide.setImageWord=function(){for(var a=1;6>=a;++a)this.getChild("img_word_"+a).visible=this.steps==a};UINewGuide.createStakeGuide=function(){this.getChild("btn_left").gray=!0;var a=new laya.ui.Image("ui/image_score_back_01.png");a.sizeGrid="14,56,22,42";a.width=580;a.height=84;this.uiNode.mask=a;a.pos(-270,190)};UINewGuide.createStartGuide=function(){var a=new Laya.Sprite;a.loadImage("ui/button_start.png");a.pivot(0,0);this.uiNode.mask=a;a.pos(297,128)};UINewGuide.createAutoGuide=function(){var a=new Laya.Sprite;a.loadImage("ui/button_auto.png");a.pivot(0,0);this.uiNode.mask=a;a.pos(309,205)};UINewGuide.createAwardGuide=function(){var a=new laya.ui.Image("ui/image_score_back_01.png");a.sizeGrid="14,56,22,42";a.width=205;a.height=76;this.uiNode.mask=a;a.pos(-460,116)};UINewGuide.createProgressGuide=function(){this.mProgress=laya.createProgress(ResURL("image_progress_bg.png"),ResURL("image_progress_bar.png"),ResURL("image_progress_mask.png"),1.5);this.mProgress.rotation=270;this.mProgress.pos(230,380);this.uiNode.addChild(this.mProgress);this.mProgress.setValue(100);var a=new laya.ui.Image(ResURL("image_progress_bar.png"));a.rotation=270;this.uiNode.mask=a;a.pos(-250,110)};UINewGuide.createBottleGuide=function(){this.mBonus2Box=laya.createArmature(ResURL("b2zhuangtaidonghua.png"),ResURL("b2zhuangtaidonghua.sk"),!1,null,null,null,this);this.mBonus2Box.pos(850,235);this.uiNode.addChild(this.mBonus2Box);this.mBonus2Box.play("ui_bonus02_1",!0);var a=new laya.ui.Image("ui/image_ui_level_01.png");a.width=132;a.height=180;this.uiNode.mask=a;a.pos(300,-205)};UIGamePlayDes=UIDEFINE("UIGamePlayDes",GamePlayDesUI);UIGamePlayDes.onStart=function(){this.onClick(this.getChild("btn_close"),function(){this.close()},this,!0,!0);this.pageNum=1;this.leftBtn=this.getChild("btn_left");this.rightBtn=this.getChild("btn_right");this.initBtns();this.onClick(this.leftBtn,function(){--this.pageNum;this.initBtns()},this,!0,!0);this.onClick(this.rightBtn,function(){this.pageNum+=1;this.initBtns()},this,!0,!0)};UIGamePlayDes.initBtns=function(){0>=this.pageNum&&(this.pageNum=1);this.getChild("image_content").skin=ResURL("image_t_descrip_0"+this.pageNum+".png");this.getChild("label_page").text=this.pageNum+"-9";1==this.pageNum?(this.leftBtn.gray=!0,this.leftBtn.mouseEnabled=!1,this.rightBtn.gray=!1,this.rightBtn.mouseEnabled=!0):9==this.pageNum?(this.leftBtn.gray=!1,this.leftBtn.mouseEnabled=!0,this.rightBtn.gray=!0,this.rightBtn.mouseEnabled=!1,this.getChild("label_page").text=this.pageNum):(this.leftBtn.gray=!1,this.leftBtn.mouseEnabled=!0,this.rightBtn.gray=!1,this.rightBtn.mouseEnabled=!0)};